text|source|chunk_id
"malware

notes/README.md at master

albertzsigovits/malware

notes

GitHub

github.com/albertzsigovits/malware

notes/blob/master/Ransomware

Windows

DarkBit/README.md

albertzsigovits

master

Name already in use A tag already exists with the provided branch name. Many Git commands accept both tag and branch names, so creating this branch may cause unexpected behavior. Are you sure you want to create this branch?

malware-notes/Ransomware-Windows-DarkBit/README.md Cannot retrieve contributors at this time

DarkBit Ransomware

1/11

YARA rules:

2/11"|data_input/DarkBit_reports/entry_848376ae-e217-45fc-b788-d4e45d616c57.text|967cb2d39ec94d89a2182a5a9e7328b7
"malware-notes/Ransomware-Windows-DarkBit/README.md Cannot retrieve contributors at this time

DarkBit Ransomware

1/11

YARA rules:

2/11

rule ransomware_darkbit_ransomnote : windows ransomware darkbit { meta: author = ""albertzsigovits"" reference = ""https://twitter.com/vxunderground/status/1624814604936249345"" date = ""2023-02-13"" strings: $note1 = ""But, you can contact us via TOX messenger if you want to recover your files personally."" ascii wide $note2 = ""All your files are encrypted using AES-256 military grade algorithm."" ascii wide $note3 = ""They should pay for firing high-skilled experts."" ascii wide $tor = ""iw6v2p3cruy7tqfup3yl4dgt4pfibfa3ai4zgnu5df2q3hus3lm7c7ad.onion"" ascii wide condition: 2 of ($note*) or $tor } rule ransomware_darkbit_windows_Strings : windows ransomware darkbit { meta: author = ""albertzsigovits"" date = ""2023-02-16"" filetype = ""pe"" threat = ""Ransomware.DarkBit.Windows"" sha256 = ""9107be160f7b639d68fe3670de58ed254d81de6aec9a41ad58d91aa814a247ff"" strings: $goinf = "" Go buildinf:"" $mingw = ""Mingw-w64 runtime failure:"" $cgo = ""_cgo_dummy_export"" $rstr1 = ""Rstrtmgr.dll"" $rstr2 = ""RmStartSession"" $rstr3 = ""RmRegisterResources"" $rstr4 = ""RmGetList"" $rstr5 = ""RmShutdown"" $rstr6 = ""RmEndSession"" $cfg1 = ""\""names\"":"" $cfg2 = ""\""limits\"":"" $cfg3 = ""\""extensions\"":"" $cfg4 = ""\""processes\"":"" $cfg5 = ""\""hostnames\"":"" $db1 = ""\""darkbit.jpg\"":"" $db2 = ""\""recovery_darkbit.txt\"":"" $db3 = ""\""Darkbit\"":"" condition: uint16(0) == 0x5A4D

3/11"|data_input/DarkBit_reports/entry_848376ae-e217-45fc-b788-d4e45d616c57.text|c45103a1883548a3ab4db50364f6c439
"3/11

and uint32(uint32(0x3C)) == 0x00004550 and ( ( $goinf and $mingw and $cgo and 2 of ($rstr*) and 3 of ($cfg*) ) or ( 2 of ($cfg*) and 1 of ($db*) ) ) } rule ransomware_darkbit_windows_asm : windows ransomware darkbit { meta: author = ""albertzsigovits"" date = ""2023-02-16"" filetype = ""pe"" threat = ""Ransomware.DarkBit.Windows"" sha256 = ""9107be160f7b639d68fe3670de58ed254d81de6aec9a41ad58d91aa814a247ff"" strings: $gob1 = { 45 88 47 ? ? // mov byte [r15 + 1], r8b 90 // nop 4C 8B 84 24 ? ? ? ? 00 00 // mov r8, qword [rsp + 0x88] 49 C1 E8 ? ? // shr r8, 4 49 83 C7 ? ? // add r15, 2 48 8B 44 24 ? ? // mov rax, qword [rsp + 0x78] 4C 8B 8C 24 ? ? ? ? 00 00 // mov r9, qword [rsp + 0xb0] 48 89 D0 // mov rax, rdx 48 8B 94 24 ? ? ? ? 00 00 // mov rdx, qword [rsp + 0xc0] 4C 89 84 24 ? ? ? ? 00 00 // mov qword [rsp + 0x88], r8 41 ? ? ? ? ? ? // and r8d, 0xf 49 } $gob2 = { 48 89 84 24 ? ? ? ? 00 00

// mov qword ptr ss:

48 89 5C 24 ? ?

// mov qword ptr ss:

31 C0 48 8D 5C 24 ? ?

// xor eax,eax

// lea rbx,qword ptr

B9 ? ? 00 00 00

// mov ecx,6

[rsp+D0],rax

[rsp+60],rbx

ss:[rsp+44] } $wyhash = { 4D 8B 88 ? ? ? ? 00 00

// mov r9, qword

4/11

[r8 + 0xf0] 49 BA 2F 64 BD 78 64 1D 76 A0

// movabs r10,

4D 01 D1 49 BB DB 28 B4 A0 D1 7E 03 E7

// add r9, r10

// movabs r11,

4D 31 CB

// xor r11, r9

0xa0761d6478bd642f"|data_input/DarkBit_reports/entry_848376ae-e217-45fc-b788-d4e45d616c57.text|49354ff71e4543348bb2afc450f3f70c
"// movabs r10,

4D 01 D1 49 BB DB 28 B4 A0 D1 7E 03 E7

// add r9, r10

// movabs r11,

4D 31 CB

// xor r11, r9

0xa0761d6478bd642f

0xe7037ed1a0b428db } $vss1 = { 48 8B 94 24 ? ? ? ? 00 00 ptr ss:[rsp+C8] [rsp+C8]:""delete"" 48 89 94 24 ? ? ? ? 00 00 ss:[rsp+138],rdx [rsp+138]:""delete"" 48 8B 54 24 ? ? ptr ss:[rsp+58] 48 89 94 24 ? ? ? ? 00 00 ss:[rsp+140],rdx 48 8B 94 24 ? ? ? ? 00 00 ptr ss:[rsp+F0] [rsp+F0]:""shadows"" 48 89 94 24 ? ? ? ? 00 00 ss:[rsp+148],rdx [rsp+148]:""shadows"" 48 8B 94 24 ? ? ? ? 00 00 ptr ss:[rsp+80] 48 89 94 24 ? ? ? ? 00 00 ss:[rsp+150],rdx 48 8B 94 24 ? ? ? ? 00 00 ptr ss:[rsp+C0] [rsp+C0]:""/all"" 48 89 94 24 ? ? ? ? 00 00 ss:[rsp+158],rdx [rsp+158]:""/all"" 48 8B 54 24 ? ? ptr ss:[rsp+50] 48 89 94 24 ? ? ? ? 00 00 ss:[rsp+160],rdx 48 89 84 24 ? ? ? ? 00 00 ss:[rsp+168],rax [rsp+168]:""/Quiet"" 48 89 9C 24 ? ? ? ? 00 00 ss:[rsp+170],rbx 48 8B 84 24 ? ? ? ? 00 00 ptr ss:[rsp+D0] [rsp+D0]:""vssadmin.exe"" 48 8B 5C 24 ? ? ptr ss:[rsp+60] 48 8D 8C 24 ? ? ? ? 00 00 ptr ss:[rsp+138] [rsp+138]:""delete"" }

// mov rdx,qword

// mov qword ptr

// mov rdx,qword

// mov qword ptr

// mov rdx,qword

// mov qword ptr

// mov rdx,qword

// mov qword ptr

// mov rdx,qword

// mov qword ptr

// mov rdx,qword

// mov qword ptr

// mov qword ptr

// mov qword ptr

// mov rax,qword

// mov rbx,qword

// lea rcx,qword

$vss2 = { 48 BA CB BB 16 11 B4 B1 42 rdx,AD42B1B41116BBCB 48 89 94 24 ? ? ? ? 00 00 ss:[rsp+B1],rdx 48 BA 6D A1 5B 11 15 7B 7B

// mov

// mov qword ptr

// mov"|data_input/DarkBit_reports/entry_848376ae-e217-45fc-b788-d4e45d616c57.text|58012f0e8a9e4cfba6734cbd4c1396c9
"// mov

// mov qword ptr

// mov

5/11

rdx,7B7B15115BA16DAD 48 89 94 24 ? ? ? ? 00 00 ptr ss:[rsp+B8],rdx 48 BA 9D C8 65 70 D0 DC 2B C3 rdx,C32BDCD07065C89D 48 89 94 24 ? ? ? ? 00 00 ptr ss:[rsp+A2],rdx 48 BA C3 4D C5 3E 7D 70 0F 1E rdx,1E0F707D3EC54DC3 48 89 94 24 ? ? ? ? 00 00 ptr ss:[rsp+A9],rdx }

// mov qword

// mov

// mov qword

// mov

// mov qword

condition:

uint16(0) == 0x5A4D

and uint32(uint32(0x3C)) == 0x00004550

and 3 of them

}

DarkBit diary: SHA256: 9107be160f7b639d68fe3670de58ed254d81de6aec9a41ad58d91aa814a247ff Packer: None Compile time: 2023-02-11 22:10:54 PEInfo: PE32+ executable (console) x86-64 (stripped to external PDB), for MS Windows Language: Golang (CGO) Obfuscation: Gobfuscate Hashing: Wyhash hash algorithm and wyrand PRNG Ransomware Mutex: Global\dbdbdbdb Ransomware Note: RECOVERY_DARKBIT.txt SHA256: fca050431ba94630d691a7d6cbdd491354c69f738b0d8e03b531173a741ad286 TOR: hxxp://iw6v2p3cruy7tqfup3yl4dgt4pfibfa3ai4zgnu5df2q3hus3lm7c7ad[. ]oni on/support TOX ID: AB33BC51AFAC64D98226826E70B483593C81CB22E6A3B504F7A75348C38C862F00042 F5245AC Telegram: DarkBitChannel Twitter: DarkBitTW

DarkBit parameters:

6/11

h | Help

all | Run on all without timeout counter

domain | Domain

force | Force blacklisted computers

list | List

nomutex | Force not checking mutex

noransom | No encryption

password | Password

path | Path

t | Threads

username | Username

VirusTotal perks:

vhash:0560b76d5555151c051d1az3f1d&z1"|data_input/DarkBit_reports/entry_848376ae-e217-45fc-b788-d4e45d616c57.text|623a40ada486443db8edaf9b17a63376
"password | Password

path | Path

t | Threads

username | Username

VirusTotal perks:

vhash:0560b76d5555151c051d1az3f1d&z1

authentihash:8a1db8d4c117daa25ab31735b9866cb989907cf524fe2c052ffa9e67

f582c79c

imphash:9bcadd8ed34a63728178995d1b006421

ssdeep:""49152:S4mkYp+03HbhndpeoVK9/0cjXd77yg6PxHuy7vDKD12K5EKGHg1q14g

UynCLgIMk:UF31ed/XB7AbvbAEKGpTI7""

behaviour_files:""%HOMEPATH%\\recovery_darkbit.txt""

behaviour_files:""%HOMEPATH%\\appdata\\recovery_darkbit.txt""

behaviour:""Global\\dbdbdbdb""

behaviour:""\\Sessions\\1\\BaseNamedObjects\\Global\\dbdbdbdb""

Config template:

7/11

""limits"": [

""limitMB"": 25,

""parts"": 1,

""eachPart"":

1

},

{

""limitMB"": 1000,

""parts"": 2,

""eachPart"": 12000

},

{

""limitMB"": 4000,

""parts"": 3,

""eachPart"": 10000

},

{

""limitMB"": 7000,

""parts"": 2,

""eachPart"": 20000

},

{

""limitMB"": 11000,

""parts"": 3,

""eachPart"": 30000

},

{

""limitMB"": 51000,

""parts"": 5,

""eachPart"": 30000

},

{

""limitMB"": 1000000,

""parts"": 3,

""eachPart"": 1000000

},

{

""limitMB"": 5000000,

""parts"": 5,

""eachPart"": 1000000

},

{

""limitMB"": 6000000,

""parts"": 20,

""eachPart"": 10000000

}

],

""extensions"": {

""msilog"": 1,

""log"": 1,

""ldf"": 1,

""lock"": 1,

""theme"": 1,

8/11

""msi"": 1,

""sys"": 1,

""wpx"": 1,

""cpl"": 1,

""adv"": 1,

""msc"": 1,

""scr"": 1,

""key"": 1,

""ico"": 1,

""dll"": 1,

""hta"": 1,

""deskthemepack"": 1,

""nomedia"": 1,

""msu"": 1,

""rtp"": 1,

""msp"": 1,

""idx"": 1,

""ani"": 1,

""386"": 1,

""diagcfg"": 1,

""bin"": 1,

""mod"": 1,

""ics"": 1,

""com"": 1,"|data_input/DarkBit_reports/entry_848376ae-e217-45fc-b788-d4e45d616c57.text|223641f36e3649ffb3dd53ecc488b9b0
"""nomedia"": 1,

""msu"": 1,

""rtp"": 1,

""msp"": 1,

""idx"": 1,

""ani"": 1,

""386"": 1,

""diagcfg"": 1,

""bin"": 1,

""mod"": 1,

""ics"": 1,

""com"": 1,

""hlp"": 1,

""spl"": 1,

""nls"": 1,

""cab"": 1,

""diagpkg"": 1,

""icl"": 1,

""ocx"": 1,

""rom"": 1,

""prf"": 1,

""themepack"": 1,

""msstyles"": 1,

""icns"": 1,

""mpa"": 1,

""drv"": 1,

""cur"": 1,

""diagcab"": 1,

""exe"": 1,

""cmd"": 1,

""shs"": 1,

""Darkbit"": 1

},

""names"": {

""thumbs.db"": 1,

""desktop.ini"": 1,

""darkbit.jpg"": 1,

""recovery_darkbit.txt"": 1,

""system volume information"": 1

},

9/11

""processes"": [], ""hostnames"": [ --- LIST OF TARGET HOSTNAMES --]

Ransom note:

10/11"|data_input/DarkBit_reports/entry_848376ae-e217-45fc-b788-d4e45d616c57.text|cb53558c63fb496e87732213f41ab986
Dear Colleagues, We’re sorry to inform you that we’ve had to hack Technion network completely and transfer “all” data to our secure servers. So, keep calm, take a breath and think about an apartheid regime that causes troubles here and there. They should pay for their lies and crimes, their names and shames. They should pay for occupation, war crimes against humanity, killing the people (not only Palestinians’ bodies, but also Israelis’ souls) and destroying the future and all dreams we had. They should pay for firing high-skilled experts. Anyway, there is nothing for you (as an individual) to be worried. That’s the task of the administration to follow up our instruction for recovering the network. But, you can contact us via TOX messenger if you want to recover your files personally. (TOX ID: AB33BC51AFAC64D98226826E70B483593C81CB22E6A3B504F7A75348C38C862F00042 F5245AC) Our instruction for the administration: All your files are encrypted using AES-256 military grade algorithm. So, 1. Don't try to recover data, because the encrypted files are unrecoverable unless you have the key. Any try for recovering data without the key (using thirdparty applications/companies) causes PERMANENT damage. Take it serious. 2. You have to trust us. This is our business (after firing from high-tech companies) and the reputation is all we have. 3. All you need to do is following up the payment procedure and then you will receive decrypting key using for returning all of your files and VMs. 4.|data_input/DarkBit_reports/entry_848376ae-e217-45fc-b788-d4e45d616c57.text|2643bdd7b5db4e0fa45c27824faec2c1
"Payment method: Enter the link below http://iw6v2p3cruy7tqfup3yl4dgt4pfibfa3ai4zgnu5df2q3hus3lm7c7ad.onion /support Enter the ID below and pay the bill (80 BTC) $TARGETID You will receive decrypting key after the payment. Notice that you just have 48 hours. After the deadline, a 30% penalty will be added to the price. We put data for sale after 5 days. Take it serious and don’t listen to probable advices of a stupid government. Good Luck! “DarkBit”

11/11"|data_input/DarkBit_reports/entry_848376ae-e217-45fc-b788-d4e45d616c57.text|9f11466424714db4b1c6ded8954afee7
"MERCURY and DEV-1084: Destructive attack on hybrid environment microsoft.com/en-us/security/blog/2023/04/07/mercury-and-dev-1084-destructive-attack-on-hybrid-environment/ April 7, 2023

April 2023 update – Microsoft Threat Intelligence has shifted to a new threat actor naming taxonomy aligned around the theme of weather. MERCURY is now tracked as Mango Sandstorm and DEV-1084 is now tracked as Storm-1084. To learn more about the new taxonomy represents the origin, unique traits, and impact of threat actors, to get complete mapping of threat actor names, read this blog: Microsoft shifts to a new threat actor naming taxonomy. Microsoft Threat Intelligence has detected destructive operations enabled by MERCURY, a nation-state actor linked to the Iranian government, that attacked both on-premises and cloud environments. While the threat actors attempted to masquerade the activity as a standard ransomware campaign, the unrecoverable actions show destruction and disruption were the ultimate goals of the operation. Previous MERCURY attacks have been observed targeting on-premises environments, however, the impact in this case notably also included destruction of cloud resources. Microsoft assesses that MERCURY likely worked in partnership with another actor that Microsoft tracks as DEV-1084, who carried out the destructive actions after MERCURY’s successful operations had gained access to the target environment."|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|a2d3c39647e844719da98d397a33e2dd
MERCURY likely exploited known vulnerabilities in unpatched applications for initial access before handing off access to DEV-1084 to perform extensive reconnaissance and discovery, establish persistence, and move laterally throughout the network, oftentimes waiting weeks and sometimes months before progressing to the next stage. DEV-1084 was then later observed leveraging highly privileged compromised credentials to perform en masse destruction of resources, including server farms, virtual machines, storage accounts, and virtual networks, and send emails to internal and external recipients. In this blog post, we detail our analysis of the observed actor activity and related tools. We also share information to the community and industry partners on ways to detect these attacks, including detection details of MERCURY and DEV-1084’s tools in Microsoft 365 Defender, Microsoft Defender for Identity, Microsoft Defender for Cloud Applications, Microsoft Defender Antivirus, and Microsoft Defender for Endpoint. As with any observed nation-state actor activity, Microsoft has directly notified targeted or compromised customers, providing them with important information needed to secure their environments.|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|6053647a7aa04f3bac6c89249ccce747
"Microsoft uses DEV-#### designations as a temporary name given to an unknown, emerging, or a developing cluster of threat activity, allowing Microsoft to track it as a unique set of information until we reach high confidence about the origin or identity of the actor behind the activity.

Who is DEV-1084? Microsoft tracks the destructive actions documented in this blog post as DEV-1084. DEV-1084 likely worked in partnership with MERCURY—an Iran-based actor that the US Cyber Command has publicly linked to Iran’s Ministry of Intelligence and Security (MOIS). DEV-1084 publicly adopted the DarkBit persona and presented itself as a criminal actor interested in extortion, likely as an attempt to obfuscate Iran’s link to and strategic motivation for the attack. The link between the DEV-1084 cluster and MERCURY was established based on the following evidence:

1/13"|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|b2a0c29983a3461d8752fa59187efec7
"1/13

DEV-1084 operators were observed sending threatening emails from 146.70.106[. ]89, an IP address previously linked to MERCURY. DEV-1084 used MULLVAD VPN, the same VPN provider historically used by MERCURY. DEV-1084 used Rport and a customized version of Ligolo. MERCURY has also been observed using Rport and a similar version of Ligolo in previous attacks. DEV-1084 used the vatacloud[. ]com domain for command and control (C2) during this incident. Microsoft assesses with high-confidence that the vatacloud[. ]com domain is controlled by MERCURY operators. Microsoft assesses that MERCURY gains access to the targets through remote exploitation of an unpatched internet-facing device. MERCURY then handed off access to DEV-1084. It is not currently clear if DEV-1084 operates independently of MERCURY and works with other Iranian actors or if DEV-1084 is an ‘effects based’ sub-team of MERCURY that only surfaces when MERCURY operators are instructed to carry out a destructive attack."|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|6ad76b0a747b44f1a6a2760ee20e145f
Early activities, related attacker tools and techniques Microsoft assesses with moderate confidence that the threat actors attempted several times and succeeded to perform initial intrusion leveraging exposed vulnerable applications, for example, continuing to exploit Log4j 2 vulnerabilities in unpatched systems in July 2022. After gaining access, the threat actors deploy several tools and leverage techniques to maintain persistence, which provide effective and continued access to compromised devices, such as the following: Installing web shells Adding a local user account and elevating privileges to local administrator Installing legitimate remote access tools, such as RPort, Ligolo and eHorus Installing a customized PowerShell script backdoor Stealing credentials Once the persistence is established, the threat actors perform extensive discovery leveraging common native Windows tools and commands such as netstat and nltest. Such reconnaissance activities were seen leveraged throughout the attack chain. The threat actors consistently perform extensive lateral movement actions using the acquired credentials within a targeted environment. These actions mainly involved: Remote scheduled tasks to launch their customized PowerShell backdoor Windows Management Instrumentation (WMI) to launch commands on devices Remote services to run encoded PowerShell commands After infecting the new devices, the threat actors often installed the same persistence mechanisms as described above.|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|20ad2a5f91eb43d18079bbe2aa9cfd22
"Interestingly, after each main attack step, the actors did not always immediately continue their operations but would wait weeks and sometimes months before moving to the next step. For execution and communication, the threat actors leverage several C2 servers and sometimes deploy tunnelling tools, such as Ligolo and OpenSSH, commonly leveraged to stay under the radar of security teams and solutions.

On-premises destructive impact In observed activity, the threat actors leveraged highly privileged credentials and access to domain controllers on on-premises destructive operations to prepare for large-scale encryption of targeted devices.

2/13

To do so, they first interfered with security tools using Group Policy Objects (GPO). With defenses impaired, the threat actors proceeded to stage the ransomware payload in the NETLOGON shares on several domain controllers. GPO was leveraged again to register a scheduled task used to launch the ransomware payload. Finally, the ransomware payload encrypted files found on the file system of the targeted devices by changing the file name extension to DARKBIT and dropped ransom notes.

Figure 1. On

premises attack flow"|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|e28d501d0ff742698352d0539dc07dff
"Figure 1. On

premises attack flow

Moving from on-premises to cloud To move from on-premises to the cloud, the threat actors had to first compromise two privileged accounts and leverage them to manipulate the Azure Active Directory (Azure AD) Connect agent. Two weeks before the ransomware deployment, the threat actors first used a compromised, highly privileged account to access the device where the Azure Active Directory (Azure AD) Connect agent is installed. We assess with high confidence that the threat actors then used the AADInternals tool to extract the plaintext credentials of a privileged Azure AD account. The threat actors then used these credentials to pivot from the on-premises environment to the Azure AD environment. Azure AD Connect is an on-premises application for managing hybrid identities through features like password hash synchronization, pass-through authentication, objects synchronization, and others. As part of the express settings installation process, multiple accounts are created both in the on-premises (Windows Server Active Directory) and cloud (Azure AD) environments. The first account is the AD DS Connector Account. The account name is prefixed with MSOL_ and it is created with a long complex password.

Figure 2. Example of AD DS Connector account

3/13"|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|e77e74ed236646d98a7b333234c56ff0
"Figure 2. Example of AD DS Connector account

3/13

This account’s permissions are set based on features enabled during the service’s installation, but in most common scenarios, the account has permissions to replicate directory changes, modify passwords, modify users, modify groups, and so on (see all the permissions here). In addition, during installation, an Azure AD account called the Azure AD Connector Account is also created. This account is used by the synchronization service to manage Azure AD objects. The account is created with a long complex password as well, and by default (if using the express settings) prefixed with Sync_[ServerName]. This user is assigned with the Directory Synchronization Accounts role (see detailed permissions of this role here). In older versions, this account might be assigned with the Global Administrator role.

Figure 3. Example of an Azure AD Connector account There are other entities detailed here that are created but are less relevant to this topic."|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|f242d88192014029bd72b00d22164d01
"Figure 3. Example of an Azure AD Connector account There are other entities detailed here that are created but are less relevant to this topic.

Extracting credentials Two weeks before the ransomware deployment, the threat actors were observed using compromised credentials to access the Azure AD Connect device. Next, they set up an SSH tunnel to an attacker-controlled device. On a separate attacker-controlled compromised device, evidence indicates cloning of the AADInternals tool. One of the functions available in this tool’s library is Get-AADIntSyncCredentials, which allows any local administrator on a device where Azure AD Connect is installed to extract the plaintext credentials of both the Azure AD Connector account and the AD DS Connector account. Shortly before the ransomware deployment, we observed authentication from a known attacker IP address into the Azure AD Connector cloud account. Investigating this sign-in showed that the threat actors were able to access the account on the first attempt without any guessing or modification of the password, indicating that the actors possessed the password for this account. The Azure AD Connector account is configured with singlefactor authentication, making it easier for the attacker to gain entry and elevate privileges."|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|20d9769e9cec4815a04d895452c6039b
"Cloud destructive impact On the day of the ransomware attack, the threat actors executed multiple actions in the cloud using two privileged accounts. The first account was the compromised Azure AD Connector account, which had Global Administrator permissions as it was set up for an old solution (DirSync). For the second account, which also had Global Administrator permissions, the threat actors leveraged RDP for access into the account. Even though this account had MFA in place, the threat actors accessed it through RDP, which is an open session that evades MFA blocking their activities.

Figure 4. Pivoting to the cloud

Mass Azure resource deletion

4/13

On the same day, a successful sign-in to the Microsoft Azure environment was observed. The threat actors claimed the Global Administrator permission through Azure Privileged Identity Management (PIM) and elevated access to get permissions to the target’s management groups and Azure subscriptions. The Azure AD Connector account and the compromised administrator account were then used to perform significant destruction of the Azure environment—deleting within a few hours server farms, virtual machines, storage accounts, and virtual networks. We assess that the attacker’s goal was to cause data loss and a denial of service (DoS) of the target’s services."|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|426afc8925a149b8a4d68dd3e5059ec6
"Exchange Web Server API abuse The actors went on to provide an existing legitimate OAuth application with both the full_access_as_app permission and administrator consent, which granted the threat actors full access to mailboxes through Exchange Web Services.

Figure 5. Adding access permission to the existing application With the obtained cloud administrator privileges, the threat actors updated the OAuth application with certificates to conduct malicious activities. These newly added credentials could then be used to issue access tokens and authenticate on behalf of the application to access cloud resources. We then observed the threat actors using this application’s permissions to perform GetItem operations over many mailboxes in the target environment. They also performed thousands of search activities, which we suspect were attempts to dump mailboxes and/or search for sensitive data in them.

Email impersonation The threat actors used the compromised administrator account to grant SMTP Send on behalf permissions to the Azure AD Connector account over a high-ranking employee’s mailbox, using the Set-Mailbox PowerShell cmdlet.

5/13

Figure 6. Threat actors granting access to

send emails on behalf of the target’s account Emails were then created and sent both internally and externally.

Figure 7. Threat actors successfully sent email through the targeted account The timeline below summarizes the sequence of events:

6/13

Figure 8. Cloud attack flow timeline"|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|ec9297e2f5384d1988a4a579e3856a37
"6/13

Figure 8. Cloud attack flow timeline

Mitigations for destructive attacks The techniques used by the actors and described in this blog can be mitigated by adopting the following security measures: Recommendations to secure your on-prem environment Refer to Microsoft’s blog Ransomware as a service: Understanding the cybercrime gig economy and how to protect yourself for recommendations on building strong credential hygiene and other robust measures to defend against ransomware and human operated attacks. Enable tamper protection – Tamper protection is a feature in Microsoft Defender for Endpoint that prevents antivirus tampering and misconfiguration by malicious apps and actors. Customers running Intune can enable DisableLocalAdminMerge to prevent modification of antivirus exclusions via GPO. Recommendations to secure your Azure AD environment Enable Conditional Access policies – Conditional Access policies are evaluated and enforced every time the user attempts to sign in. Organizations can protect themselves from attacks that leverage stolen credentials by enabling policies such as device compliance or trusted IP address requirements. Enable continuous access evaluation – Continuous access evaluation (CAE) revokes access in real time when changes in user conditions trigger risks, such as when a user is terminated or moves to an untrusted location. Search unified audit logs for the SendAs operation to identify and track emails sent on behalf of a user mailbox."|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|7532814442464079a694776ae289c50a
"Further steps and recommendation to manage, design, and secure your Azure AD environment can be found by referring to Azure Identity Management and access control security best practices.

Detections Microsoft 365 Defender The following alerts in Microsoft 365 Defender can be used to detect suspicious operations in Azure related to the attacker activities described in this blog, including destructive activity: Access elevation by risky user Suspicious Azure resource deletions Suspicious Addition of an Exchange related App Role In addition, the following alert can help detect compromised Azure AD Connect accounts: Unusual activities by Azure AD Connect sync account

Microsoft Defender for Cloud Apps

7/13

For Microsoft Defender for Cloud Apps with Azure Connector enabled, the following alerts can be used to detect destructive operations in Azure: Multiple storage deletion activities Multiple delete VM activities

Azure AD Identity Protection Monitor medium and high severity alerts for highly privileged accounts as they can indicate malicious activity. For example: Unfamiliar sign-in properties Find details of Azure AD Identity Protection alerts here.

Microsoft Defender for Identity The following Microsoft Defender for Identity alerts can indicate associated threat activity: Suspicious additions to sensitive groups For relevant accounts with Honeytoken configured, the following alert can indicate malicious activity: Honeytoken activity"|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|f747e4b84bda4f1f875dc710b87d3e78
"Microsoft Defender Antivirus Microsoft Defender Antivirus detects attempted exploitation and post-exploitation activity and payloads. Turn on cloud-delivered protection to cover rapidly evolving attacker tools and techniques. Cloud-based machine learning protections block most new and unknown threats. Refer to the list of detection names related to exploitation of Log4j 2 vulnerabilities. Detections for the IOCs listed above are listed below: Backdoor:PHP/Remoteshell.V HackTool:Win32/LSADump VirTool:Win32/RemoteExec Trojan:PowerShell/Downloader.SB Trojan:Win32/Nibtse.G!tsk Backdoor:ASP/Shellman.SA Ransom:Win64/DarkBit VirTool:Win32/AtExecCommand

Microsoft Defender for Endpoint Microsoft Defender for Endpoint alerts with the following titles can indicate possible presence of the indicators of compromise listed below. Mercury actor activity detected Ransomware-linked emerging threat actor DEV-1084 detected Reducing the attack surface Microsoft Defender for Endpoint customers can turn on the following attack surface reduction rule to block or audit some observed activity associated with this threat: Block executable files from running unless they meet a prevalence, age, or trusted list criterion.

8/13"|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|f2b01acb531346a2af53e6490da54c44
"8/13

Implement controlled folder access and add folders to the protected folders list to help prevent files from being altered or encrypted by ransomware. Set controlled folder access to Enabled. Detecting Log4j 2 exploitation Alerts that indicate threat activity related to the exploitation of the Log4j 2 exploitation should be immediately investigated and remediated. Refer to our Log4j related blogs to learn about this vulnerability and for a list of Microsoft Defender for Endpoint alerts that can indicate exploitation and exploitation attempts. Detecting post-exploitation activity Alerts with the following titles may indicate post-exploitation threat activity related to MERCURY activity described in this blog and should be immediately investigated and remediated."|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|9c6e40326c1d466c8fbf4e0e3caafdbd
These alerts are supported on both Windows and Linux platforms: Any alert title related to web shell threats, for example: ‘WebShell’ backdoor was prevented on an IIS Web server Any alert title that mentions the DarkBit ransomware threat or DEV-1084, for example: ‘DarkBit’ ransomware was blocked ‘DarkBit’ ransomware was detected ‘DarkBit’ ransomware was prevented Ransomware-linked emerging threat actor DEV-1084 detected Any alert title that mentions suspicious scheduled task creation or execution, for example: Suspicious scheduled task Any alert title that mentions suspected tunneling activity, for example: Suspicious SSH tunneling activity Any alert title that mentions suspected tampering activity, for example: Suspicious Microsoft Defender Antivirus exclusion Microsoft Defender Antivirus tampering Any alert title that mentions PowerShell, for example: Suspicious process executed PowerShell command A malicious PowerShell Cmdlet was invoked on the machine Suspicious PowerShell command line Suspicious PowerShell download or encoded command execution Suspicious remote PowerShell execution Any alert title related to suspicious remote activity, for example: Suspicious RDP session An active ‘RemoteExec’ malware was blocked Suspicious service registration Any alert related to persistence: Anomaly detected in ASEP registry 9/13|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|8411457045604619807a3e64e63ec489
"User account created under suspicious circumstances Any alert title that mentions credential dumping activity or tools, for example: Malicious credential theft tool execution detected Credential dumping activity observed Mimikatz credential theft tool ‘DumpLsass’ malware was blocked on a Microsoft SQL server

Microsoft Defender Vulnerability Management In addition to the mitigations above being presented and managed through Microsoft Defender Vulnerability Management, Microsoft 365 Defender customers can use threat and vulnerability management to identify and remediate devices that are vulnerable to Log4j 2 exploitation. More comprehensive guidance on this capability can be found on this blog: Guidance for preventing, detecting, and hunting for exploitation of the Log4j 2 vulnerability."|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|f091328468d8454a9148d57a19019245
"Advanced hunting queries Microsoft 365 Defender To locate related activity, Microsoft 365 Defender customers can run the following advanced hunting queries: // Advanced Hunting Query to surface potential Mercury PowerShell script backdoor installation DeviceFileEvents | where InitiatingProcessFileName =~ ""powershell.exe"" | where FolderPath in~ (@""c:\programdata\db.ps1"", @""c:\programdata\db.sqlite"") | summarize min(Timestamp), max(Timestamp) by DeviceId, SHA256, InitiatingProcessParentFileName DeviceProcessEvents | where InitiatingProcessFileName =~ ""powershell.exe"" | where InitiatingProcessCommandLine has_cs ""-EP BYPASS -NoP -W h"" | summarize makeset(ProcessCommandLine), min(Timestamp), max(Timestamp) by DeviceId

// Advanced Hunting Query to surface potential Mercury PowerShell script backdoor initiating commands DeviceProcessEvents | where InitiatingProcessFileName =~ ""powershell.exe"" | where InitiatingProcessCommandLine contains_cs @""c:\programdata\db.ps1"" | summarize makeset(ProcessCommandLine), min(Timestamp), max(Timestamp) by DeviceId"|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|3668cbbb3d08402fb323d8defb98eeb7
"//Advanced Hunting Query for Azure resource deletion activity let PrivEscalation = CloudAppEvents | where Application == ""Microsoft Azure"" | where ActionType == ""ElevateAccess Microsoft.Authorization"" | where ActivityObjects has ""Azure Subscription"" and ActivityObjects has ""Azure Resource Group"" | extend PrivEscalationTime = Timestamp | project AccountObjectId, PrivEscalationTime ,ActionType; CloudAppEvents | join kind = inner PrivEscalation on AccountObjectId | extend DeletionTime = Timestamp | where (DeletionTime - PrivEscalationTime) <= 1h | where Application == ""Microsoft Azure"" | where ActionType has ""Delete"" |summarize min(DeletionTime), TotalResourcersDeleted =count(), CountOfDistinctResources= dcount(ActionType), DistinctResources=make_set(ActionType) by AccountObjectId

10/13"|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|42a41c00860f4ebd98878d8b5f9448d3
"10/13

//AHQ used to detect attacker abusing OAuth application during the attack CloudAppEvents | where Application == ""Office 365"" | where ActionType == ""Consent to application."" | where RawEventData.ResultStatus =~ ""success"" | extend UserId = tostring(RawEventData.UserId) | mv-expand AdminConsent = RawEventData.ModifiedProperties | where AdminConsent.Name == ""ConsentContext.IsAdminConsent"" and AdminConsent.NewValue == ""True"" | project ConsentTimestamp =Timestamp, UserId, AccountObjectId, ReportId, ActionType | join kind = leftouter (CloudAppEvents | where Application == ""Office 365"" | where ActionType == ""Add app role assignment to service principal."" | extend PermissionAddedTo = tostring(RawEventData.Target[3].ID) | extend FullAccessPermission = RawEventData.ModifiedProperties | extend OuthAppName = tostring(FullAccessPermission[6].NewValue) // Find app name | extend OAuthApplicationId = tostring(FullAccessPermission[7].NewValue) // Find appId | extend AppRoleValue = tostring(FullAccessPermission[1].NewValue) // Permission Level | where AppRoleValue == ""full_access_as_app"" | project PermissionTime=Timestamp, InitiatingUser=AccountDisplayName, OuthAppName, OAuthApplicationId, AppRoleValue, AccountObjectId, FullAccessPermission ) on AccountObjectId"|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|473540a032624a2cbb00360315d751ef
"Microsoft Sentinel Microsoft Sentinel has a range of detection and threat hunting content that customers can use to detect the post exploitation activity detailed in this blog in addition to Microsoft Defender detections list above. Microsoft Sentinel customers can use the TI Mapping analytic (a series of analytics all prefixed with “TI map”) to automatically match the indicators mentioned in this blog post with data in their workspace. If the TI Map analytics are not currently deployed, customers can install the Threat Intelligence solution from the Microsoft Sentinel Content Hub to have the analytics rule deployed in their Sentinel workspace. More details on the Content Hub can be found here: https://learn.microsoft.com/azure/sentinel/sentinel-solutions-deploy

Indicators of compromise (IOCs) The below list provides IOCs observed during our investigation. We encourage our customers to investigate these indicators in their environments and implement detections and protections to identify past related activity and prevent future attacks against their systems. Indicator

Type

Description

9107be160f7b639d68fe3670de58ed254d81de6aec9a41ad58d91aa814a247ff

DEV

1084

ransom payload

8thCurse.exe

80bd00c0f6d5e39b542ee6e9b67b1eef97b2dbc6ec6cae87bf5148f1cf18c260

DEV

1084

batch script

8dd9773c24703e803903e7a5faa088c2df9a4b509549e768f29276ef86ef96ae

DEV

1084

batch script

486eb80171c086f4d184423ed7e79303ad7276834e5e5529b199f8ae5fc661f2

DEV

1084

batch script"|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|fe2eb6bdb9af400b82ed788ab8659e79
"DEV

1084

batch script

486eb80171c086f4d184423ed7e79303ad7276834e5e5529b199f8ae5fc661f2

DEV

1084

batch script

f1edff0fb16a64ac5a2ce64579d0d76920c37a0fd183d4c19219ca990f50effc

DEV

1084

batch script

887ae654d69ac5ccb8835e565a449d7716d6c4747dc2fbff1f59f11723244202

DEV

1084

batch script

11/13

3fba459d589cd513d2478fb4ae7c4efd6aa09e62bc3ff249a19f9a233e922061

DEV

1084

batch script

0dde13e3cd2dcda522eeb565b6374c97b3ed4aa6b8ed9ff9b6224ea97bf2a584

DEV

1084

batch script

afd16b9ad57eb9c26c8ae347c379c8e2b82361c7bdff5b189659674d5614854c

DEV

1084

batch script

3e59d36faf2d5e6edf1d881e2043a46055c63b7c68cc08d44cc7fc1b364157eb

DEV

1084

batch script

786bd97172ec0cef88f6ea08e3cb482fd15cf28ab22d37792e3a86fa3c27c975

DEV

1084

batch script

36c71ce7cd38733eb66f32a8c56acd635680197f01585c5a2a846cc3cb0a8fe2

DEV

1084

batch script

016967de76382c674b3a1cb912eb85ff642b2ebfe4e107fc576065f172c6ef80

DEV

1084

batch script

3059844c102595172bb7f644c9a70d77a198a11f1e84539792408b1f19954e18

DEV

1084

batch script

194.61.121[. ]86

Command and

control

hxxps://pairing[.]rport[. ]io/qMLc2Wx

Download Rport

software from it

141.95.22[. ]153

Command and

control

193.200[. ]16.3

Command and

control

192.52.166[. ]191

Command and

control

45.56.162[. ]111

Command and

control

104.194.222[. ]219

Command and

control

192.169.6[. ]88

Command and

control

192.52.167[. ]209

Command and

control

webstore4tech[.]uaenorth.cloudapp.azure[. ]com

Command and

control"|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|912902d9940a4688832f99a8bbffee15
"192.169.6[. ]88

Command and

control

192.52.167[. ]209

Command and

control

webstore4tech[.]uaenorth.cloudapp.azure[. ]com

Command and

control

vatacloud[. ]com

Actor

owned

Rport domain

12/13

146.70.106[. ]89

DEV

1084

operators were

observed

sending

threatening

emails to the

victim after the

attack from

146.70.106[. ]89,

an IP address

previously

linked to

MERCURY

b9cf785b81778e2b805752c7b839737416e3af54f64f1e40e008142e382df0c4

Rport Legit

remote access

tool

ab179112caadaf138241c43c4a4dccc2e3c67aeb96a151e432cfbafa18a4b436

Customized

Ligolo tunneling

tool

46.249.35[. ]243

Command and

control

45.86.230[. ]20

Command and

control

6485a68ba1d335d16a1d158976e0cbfad7ab15b51de00c381d240e8b0c479f77

db.ps1

Customized

Script Backdoor

b155c5b3a8f4c89ba74c5c5c03d029e4202510d0cbb5e152995ab91e6809bcd7

db.sqlite

Customized

Obfuscated

Script Backdoor

rport.exe

NOTE: These indicators should not be considered exhaustive for this observed activity.

Microsoft Defender Threat Intelligence Community members and customers can find summary information and all IOCs from this blog post in the linked Microsoft Defender Threat Intelligence article.

References

13/13"|data_input/DarkBit_reports/entry_e6950bfb-7826-4f8c-8d2c-8a3fc191869e.text|62ee3bb50a6d48e3a2763a6945320594
"MuddyWater Back with DarkBit

labs.k7computing.com/index.php/muddywater

back

with

darkbit/

By Sudeep

April 21, 2023

Recently, we came across a tweet about DarkBit ransomware. An Iranian APT group, named MuddyWater, is reportedly behind the DarkBit ransomware. In this blog we will explore the ransomware’s initial access method, the use of Cobalt Strike and the final ransomware payload.

Initial Access Method The initial lure was delivered as an ISO file.

Figure 1 – ISOFile The payload included a shortcut file (with a .doc extension) and a zip file.

1/10

Figure 2 – Contents Inside ISO File The shortcut was using PrintBrm.exe to unpack the HR-Update.zip and run it as shown below. PrintBrm.exe is a windows inbuilt command line tool.

Figure 3 – Shortcut File

cmd.exe /c xcopy .\HR-Update.zip %TEMP% /h /y && PrintBrm.exe -r -f %TEMP%\HRUpdate.zip -d %TEMP%\unzip & %TEMP%\unzip\HR-Update.exe

Figure 4 – HR-Update.exe Running HR-Update.exe was a Cobalt Strike beacon. Cobalt Strike, a penetration testing tool, can also be used by attackers for gaining a foothold in the system. The final ransomware payload is downloaded with the help of Cobalt Strike.

2/10

At the time of writing the blog, we were unable to get the exact DarkBit ransomware payload. So we are using another available sample that belonged to the same campaign.

Analysis of Ransomware This DarkBit ransomware sample is written in GoLang. It contains command line arguments.

Figure 5 – Ransomware Features"|data_input/DarkBit_reports/entry_12fdab3b-0554-4c2e-a4dc-f8e1a3ebf647.text|ab36f9ac777f40ef8d58d3b197503ee7
"Analysis of Ransomware This DarkBit ransomware sample is written in GoLang. It contains command line arguments.

Figure 5 – Ransomware Features

It also contains an inbuilt configuration file as shown in Figure 6.

3/10

Figure 6 – InBuilt Config Further analysis revealed that they had obfuscated some dll names like advapi32.dll and functions like SystemFunction036.

Figure 7

Obfuscation

Its dynamically resolving API at this address. Malware authors tend to dynamically resolve API to avoid static detections.

4/10

Figure 8 –

Dynamically Resolving API CreateMutexW API is being used to check if an instance of the malware is already running. As can be seen in Figure 5 previously, they are also using multithreading. As the customary prelude to file encryption, they are using vssadmin.exe to delete all the shadow copies.

Figure 9 – Delete

Shadow all Here they are using SystemFunction036 (documented in MSDN as RtlGenRandom) to generate a random key as shown in Figure 10.

5/10

Figure 10 – SystemFunction036 SystemFunction036 is accessed multiple times in the code with varying buffer sizes passed to it.

Figure 11 – Call To Dynamically Resolve API and

Then SystemFunction036 Here we can see that the buffer size of 80 is made available for SystemFunction036.

6/10

Figure 12 – Encrypting Key

Later-on, the key used for encrypting the files is itself encrypted and attached to the encrypted files.

Figure 13 – EncryptionAlgorithm"|data_input/DarkBit_reports/entry_12fdab3b-0554-4c2e-a4dc-f8e1a3ebf647.text|a321241a9b4a48e9839c0fdd1b5b453b
"Later-on, the key used for encrypting the files is itself encrypted and attached to the encrypted files.

Figure 13 – EncryptionAlgorithm

From Figure 13, we can see that It’s encrypting. It is likely using AES to encrypt the files, as strings related to the same functions can be found elsewhere in this same sample. FindFirstFileW, FindNextFileW are used to iterate through the file system, to find the appropriate file and then encrypt it. At that point it was observed that its writing file in chunks and not as a whole. For doing the same it’s using SetFilePointerEx API to move the file pointer to a specific address. 7/10

Figure 14 – SetFilePointerEx It’s then using the WriteFile API.

Figure 15 – WriteFile All these functions are called one after another, till all the files are encrypted. After encrypting the file, the key is stored at the end of the file.

8/10

Figure 16 – Ransomware key The encrypted files are given ‘.darkbit’ extension and also a ransom note is dropped in the respective folders.

Figure 17 – Ransomware Note

9/10

Figure 18 – Tweet on"|data_input/DarkBit_reports/entry_12fdab3b-0554-4c2e-a4dc-f8e1a3ebf647.text|f23057601d5f4466bc5916f97f9d28bd
"Figure 17 – Ransomware Note

9/10

Figure 18 – Tweet on

DarkBit MuddyWaters uses different types of attacks for initial access like phishing email campaigns, using tools like MimiKatz to break into the system, etc. In this case, MuddyWaters made use of Cobalt Strike to get initial access into the system. From the ransomware note, we figured out that it was a politically motivated attack. We at K7 Labs provide detection for DarkBit ransomware and all the latest threats. Users are advised to use a reliable security product such as “K7 Total Security” and keep it up-todate to safeguard their devices.

Indicators of Compromise (IOCs)

File Name

Hash

Detection Name

DarkBit.exe

9880FAE6551D1E9EE921F39751A6F3C0

Trojan (0058e3dd1)

hr

update.iso

1219A8880DEBDD10D081195E27A2A016

Trojan (0001140e1)

References

https://attack.mitre.org/groups/G0069/

10/10"|data_input/DarkBit_reports/entry_12fdab3b-0554-4c2e-a4dc-f8e1a3ebf647.text|ebb2a7dbb7a541429eab97275eb49621
"DarkBit Ransomware Targets Israel with Command-Line Options and Optimized Encryption Routines blogs.blackberry.com/en/2023/02/darkbit-ransomware-targets-israel The BlackBerry Research & Intelligence Team

1. BlackBerry Blog 2. DarkBit Ransomware Targets Israel with Command-Line Options and Optimized Encryption Routines

Summary A new ransomware strain dubbed ""DarkBit"" has recently appeared on the threat landscape after targeting one of Israel's top research universities, Technion - Israel Institute of Technology (IIT). The threat actor behind this Golang-compiled ransomware appears to have geopolitical motivations; the ransom note is laden with anti-Israeli and anti-government rhetoric, along with mentions of the recent spate of layoffs across the technology industry. The main portable executable (PE) module supports command-line options and data encryption optimization for large files.

1/13"|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|1ae5c195f00743598ef5458f7319ce9f
"1/13

Figure 1: DarkBit ransom note The requested ransom to release the decryptor was 80 Bitcoin (BTC), equating to around USD $1,869,760 at the time of writing. The Haifa-based academic university is currently carrying out incident response activities to determine the scope of the attack, according to a post in Hebrew on their Twitter account, which states: “The Technion is under cyber attack. The scope and nature of the attack are under investigation. To carry out the process of collecting the information and handling it, we use the best experts in the field, in the Technion and outside, and coordinate with the authorized authorities. The Technion proactively blocked all communication networks at this stage.”

Weaponization and Technical Overview

Weapons

Golang compiled PE executable

Attack Vector

Unknown

Network Infrastructure

TOX, TOR

Targets

Education"|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|a2c38f1605744e2cabc32dc8015a1816
"Weapons

Golang compiled PE executable

Attack Vector

Unknown

Network Infrastructure

TOX, TOR

Targets

Education

Technical Analysis Context On February 12, 2023, Technion – Israel Institute of Technology (IIT) suffered a ransomware attack. The threat actor behind the attack was a previously unknown group – DarkBit, who named themselves and claimed responsibility via a branded .onion website and Twitter page. To date, the college has not publicly revealed the attack's true extent nor how many computer systems were impacted by the ransomware. The origins of the breach and initial infection vector have not yet been disclosed publicly. During the attack, affected devices had various files encrypted by the ransomware, with the file extension '.Darkbit' being appended to signify encryption. Additionally, a ransom note with the filename 'RECOVERY_DARKBIT.txt' was added to all directories compromised by the ransomware.

2/13

The ransomware boasts several capabilities, including accepting command-line arguments or being run autonomously. It encrypts the victim’s device by default, employing Advanced Encryption Standard 256-bits (AES256) during its encryption routine, and impacts a wide range of file types. Furthermore, it utilizes the technique of multi-threading for faster and more efficient encryption. SHA-256

9107be160f7b639d68fe3670de58ed254d81de6aec9a41ad58d91aa814a247ff

MD5

9880fae6551d1e9ee921f39751a6f3c0

File Name

N/A

File Size

5385216 bytes

File Type

X64 PE"|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|45c06ab9228a4ffa9e175f69846177c3
"MD5

9880fae6551d1e9ee921f39751a6f3c0

File Name

N/A

File Size

5385216 bytes

File Type

X64 PE

Compile Date:

Sat Feb 11 17:10:53 2023

Executing the malware via the command-line can be done with multiple optional arguments, as seen below:

Figure 2: DarkBit command

line options

Argument

Description

all

Run on all without timeout counter

domain (string)

Domain

force

Force blacklisted computers

3/13

list (string)

List

nomutex

Force not checking mutex

noransom

Just spread/ No encryption

password (string)

Password

path (string)

Path

t (int)

Threads (default

1)

username (string)

Username

Upon execution, the malware will call vssadmin.exe, the localized Windows® administrative tool for shadow copies. The malware then attempts to run this command to delete shadow copies in order to prevent the victim organization from performing data recovery: vssadmin.exe delete shadow /all /Quiet During the file encryption process, file extensions that the malware has not whitelisted are appended with a seemingly randomized name along with the “.Darkbit” file extension. That is appended to all affected files to signify encryption.

Figure 3: DarkBit encrypted files Additionally, when a file is encrypted, the string “DARKBIT_ENCRYPTED_FILES” is appended to the nowencrypted code.

4/13

Figure 4: Encrypted file's contents

DarkBit Ransomware Filetype Exclusion List msilog

log

ldf

lock

theme

msi

sys

wpx

cpl

adv

msc

scr

key

ico

dll

hta

deskthemepack"|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|2d9c1fb35bb743edb6ca036d648dac3a
"DarkBit Ransomware Filetype Exclusion List msilog

log

ldf

lock

theme

msi

sys

wpx

cpl

adv

msc

scr

key

ico

dll

hta

deskthemepack

nomedia

msu

rtp

msp

5/13

idx

ani

386

diagcfg

bin

mod

ics

com

hlp

spl

nls

cab

diagpkg

icl

ocx

rom

prf

themepack

msstyles

icns

mpa

drv

cur

diagcab

exe

cmd

shs

Darkbit

DarkBit File

Specific Exclusion List

Thumbs.db

Desktop.ini

Darkbit.jpg

Recovery_darkbit.txt

System volume information

When it comes to encrypting files larger than 25MB, the malware is instructed (depending on the target file size) to divide those files into parts, with each part being a specific size, and then to encrypt them. Max file size (MB)

Parts

Part size (bytes)

1000

2

12000

4000

3

10000

7000

2

20000

11000

3

30000

51000

5

30000

1000000

3

1000000

5000000

5

1000000

6000000

20

10000000

Network Infrastructure The DarkBit group has a .onion webpage accessible to the TOR network. Under the DarkBit logo, the site includes the provocative subheading, “Against any kind of racism, fascism and apartheid,” leading one to believe this might be a hacktivist group. The ransom note includes its address, offering ""support"" to the victim.

6/13

URL

hxxp://iw6v2p3cruy7tqfup3yl4dgt4pfibfa3ai4zgnu5df2q3hus3lm7c7ad[. ]onion/support"|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|a7a2057e378d4b74a2b549cd8fc0a30f
"6/13

URL

hxxp://iw6v2p3cruy7tqfup3yl4dgt4pfibfa3ai4zgnu5df2q3hus3lm7c7ad[. ]onion/support

Figure 5: DarkBit “support” page As an additional extortion method, 48 hours after its initial attack, the ransomware group demanded a further 30% penalty (24 BTC) to pressurize the university into immediately paying the specified sum.

Figure 6: Victim payment information page Furthermore, the DarkBit group has a Telegram account where it was last noted to be boasting about the hack of the university, citing more anti-Israeli rhetoric.

7/13

Figure 7: The DarkBit ransomware group’s Telegram page DarkBit also has a Twitter page containing similar political messaging as was seen in the ransom note, with the Twitter handle (@)DarkBitTW. It promotes the hashtag “#HackForGood”. A Tweet from the account dated Feb 12th gives us a little more insight into the possible motivations of the threat actor, stating: “A kindly advice to the hight-tech [sic] companies: From now on, be more careful when you decide to fire your employees, specially [sic] the geek ones. #DarkBit”.

8/13

Figure 8: DarkBit’s Twitter page

Targets

9/13

Figure 9: DarkBit targets At the time of writing, the only known target of this new group has been the Technion - Israel Institute of Technology. However, given that DarkBit has set up a support site for victim interaction and payment facilitation, combined with their seemingly political motivations, new targets may come up in Israel in the near future."|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|fb2699abab18453a8652148d2b4c9202
"Attribution Given the political theme behind the attack and the political and institutional rhetoric posted on the threat group’s web pages, there may be other factors at play here besides financial motivation. Due to the note about tech layoffs on its Twitter page, it is conceivable that a disgruntled employee or group of employees may be behind this ransomware attack, unless this is simple misdirection. Based on the code analysis, BlackBerry cannot link this group to any publicly known ransomware groups.

Conclusions Ransomware is no longer about financial gain. We have noted a growing trend where ransomware is used as a weapon in geopolitics. This trend began a few years ago in Ukraine. Today we now see it in Israel, used against one of the largest universities in the country. We should expect more ransomware attacks with geopolitical motivations as time goes by. Ransomware is used as a blunt tool by threat actors because upon deployment, it immediately disrupts systems, causing reputational and financial damage; it may also result in financial benefit to the threat actor if the ransom is paid. Finally, the messages displayed on the ransomware’s support pages and sites offer threat actors a public place to spread their own flavor of geopolitical propaganda.

APPENDIX 1 – Indicators of Compromise (IoCs)

10/13

Hashes

(md5,

sha

256)

9880fae6551d1e9ee921f39751a6f3c0

Ransom

Note

recovery_darkbit.txt

Mutex in

the

System

Global\dbdbdbdb

Network

Indicators"|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|df420eb887444843a5f4f5560c0872c2
"(md5,

sha

256)

9880fae6551d1e9ee921f39751a6f3c0

Ransom

Note

recovery_darkbit.txt

Mutex in

the

System

Global\dbdbdbdb

Network

Indicators

hxxp://iw6v2p3cruy7tqfup3yl4dgt4pfibfa3ai4zgnu5df2q3hus3lm7c7ad[. ]onion/support

9107be160f7b639d68fe3670de58ed254d81de6aec9a41ad58d91aa814a247ff

TOX ID:

AB33BC51AFAC64D98226826E70B483593C81CB22E6A3B504F7A75348C38C862F00042F5245AC"|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|0d88f861d47b487cb259cb617c25717d
"APPENDIX 2 – Applied Countermeasures Yara Rules rule Darkbit_Ransomware { meta: description = ""Yara rule based of the DarkBit Ransomware code"" author = ""The BlackBerry Research & Intelligence team"" date = ""2023-02-14"" last_modified = ""2023-02-15"" distribution = ""TLP:White"" version = ""1.0"" sha256 = ""9107be160f7b639d68fe3670de58ed254d81de6aec9a41ad58d91aa814a247ff"" md5 = ""9880fae6551d1e9ee921f39751a6f3c0"" strings: $4538285_63 = { 9? 9? 9? 48 ? ? ? ? ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? C6 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 66 ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? 84 ? ? 0F 85 } $5891110_63 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? 4C ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 4C ? ? ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? 0F 1F ? ? ? ? ? ? 48 ? ? ? ? 0F 8E } $7545077_63 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? 0F 1F ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? 0F 84 } $5903045_63 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? B9 ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 4C ? ? ? ? 0F 1F ? ? ? ? ? ? 48 ? ? ? ? 73 } $5127463_63 = { 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? ?"|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|58cdc422572742fabe2025c5bb3dccdb
? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 4C ? ? ? ? 0F 1F ? ? ? ? ? ? 48 ? ? ? ? 73 } $5127463_63 = { 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? ? ?|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|4683b59ff1f94f0991a65f682796bced
? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 4C ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 4C ? ? ? ? ? ? ? ? 4C ? ? ? ? 0F 9E ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 } $6072198_63 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? B9 ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 9? 48 ? ? ? ? 0F 84 } $4935722_63 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 84 ? ? 0F 85 } $4976425_63 = { 41 ? ? ? ? ? ? ? ? 0F 11 ? ? ? ? ? ? ? ? ? ? ? ? 4F ? ? ? ? ? ? 4D ? ? ? ? ? ? 41 ? ? ? ? ? ? 0F 11 ? ? ? ? ? ? ? ? ? ? ? ? 4F ? ? ? ? ? ? 4D ? ? ? ? ? ? 41 ? ? ? ? ? ? 0F 11 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? 74 } $4527589_63 = { 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? 0F B7 ? ? ? ? ? ? 0F B7 ? ? ? ? ? ? 4C ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 4C ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 4C ? ? ? ? ? ? ? ? ? ? ? ? ? ? 9? 48 ? ? ? ? 7D } $4716056_63 = { 0F B6 ? ? ? ? ? ? 0F B6 ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? ? ? 66 ? ? ? ? ? ? ? ? B8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? C3 } $5798030_63 = { 48 ? ? ? ? ?|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|e120e2565cc24dd787cc493d8bcd9385
? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 0F 1F ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 9? 48 ? ? ? ? ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 83 ? ? ? ? ? ? ? ? ? ? ? ? 75 } $6047533_63 = { 0F B6 ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 44 ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? 48 } $7558727_62 = { 31 ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? 11/13|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|2f3d3d5f82324d2d82b6a70029517918
? ? ? ? ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? B9 ? ? ? ? ? ? ? ? BF ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 0F 1F ? ? 48 ? ? ? ? 0F 84 } $4266979_62 = { 48 ? ? ? ? ? ? 48 ? ? ? ? 8B ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? FF D? 48 ? ? ? ? ? ? ? ? 0F B6 ? ? ? ? 83 ? ? ? ? 88 ? ? ? ? 0F B6 ? ? ? ? BE ? ? ? ? ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? ? ? ? ? 66 ? ? 74 } $5892010_62 = { 4B ? ? ? ? ? ? 49 ? ? ? ? ? ? 49 ? ? ? ? ? ? ? ? 49 ? ? ? ? ? ? ? ? 8B ? ? ? ? ? ? ? ? ? ? ? ? 4C ? ? ? ? ? ? ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? 4C ? ? ? ? ? ? ? ? ? ? ? ? ? ? 49 ? ? ? ? 0F 8F } $5132165_62 = { 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 9? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 4C ? ? ? ? ? ? ? ? 4C ? ? ? ? 0F 9E ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? ? ? ? ? EB } $6850214_62 = { 44 ? ? ? ? ? ? ? ? ? ? 8B ? ? 89 ? ? ? ? ? ? 8B ? ? ? ? 89 ? ? ? ? ? ? 8B ? ? ? ? 89 ? ? ? ? ? ? 8B ? ? ? ? 89 ? ? ? ? ? ? 0F 10 ? ? ? ? ? ? 0F 11 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? C3 } $4976188_62 = { 41 ? ? ? ? ? ? ? ? 0F 11 ? ? ? ? ? ? ? ? ? ? ? ? 4B ? ? ? ? ? ? 48 ? ? ? ? ? ? 0F 10 ? ? 0F 11 ? ? ? ? ? ? ? ? ? ? ? ? 4B ? ? ? ? ? ? 48 ? ? ? ? ? ? 0F 10 ? ? 0F 11 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? 0F 85 } $4610524_62 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ?|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|062a8a25e2e4420ca135a529929e4be1
? ? ? ? ? ? ? ? ? 0F 85 } $4610524_62 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ?|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|dbd806675a9b42f084329a92785d1f25
? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? 84 ? ? 0F 85 } $6072616_61 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? B9 ? ? ? ? ? ? ? ? 0F 1F ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 66 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? 0F 84 } $4442442_61 = { 4C ? ? ? ? ? ? ? ? 4C ? ? ? ? ? ? ? ? ? ? ? ? 44 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 45 ? ? ? ? ? ? 41 ? ? ? ? ? ? 41 ? ? ? ? ? ? 47 ? ? ? ? ? ? 45 ? ? ? ? ? ? 41 ? ? ? ? ? ? 44 ? ? ? ? ? ? ? ? 4C ? ? ? ? ? ? ? ? ? ? ? ? 45 ? ? ? ? 0F 8E } $4448822_61 = { 48 ? ? ? ? ? ? ? ? 0F 1F ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 8B ? ? 89 ? ? C1 ? ? ? ? C1 ? ? ? ? 01 ? ? C1 ? ? ? ? 41 ? ? ? ? C1 ? ? ? ? 29 ? ? 85 ? ? 0F 8C } $4726213_61 = { 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 40 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? 4C ? ? ? ? 4C ? ? ? ? E8 ? ? ? ? ? ? ? ? 4C ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 0F B6 ? ? ? ? ? ? 4C ? ? ? ? ? ? ? ? 48 } $5127401_61 = { 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 4C ? ? ? ? ? ? ? ? 4C ? ? ? ? 0F 9E ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? ? ? ? ? EB } $4357770_61 = { 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ?|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|4b9889127ccd44e28378a2d9b959be69
? ? ? ? EB } $4357770_61 = { 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ?|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|be38dedceb4f4eb593278c5214b062e5
? ? ? ? 0F 10 ? ? ? ? ? ? ? ? ? ? 0F 11 ? ? ? ? ? ? 0F 10 ? ? ? ? ? ? ? ? ? ? 0F 11 ? ? ? ? ? ? 31 ? ? EB } $5046026_60 = { 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? FF D? 66 ? ? 48 ? ? ? ? ? ? 0F 85 } $6918301_60 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? 0F 10 ? ? ? ? ? ? ? ? ? ? ? ? 0F 11 ? ? ? ? 0F 10 ? ? ? ? ? ? ? ? ? ? ? ? 0F 11 ? ? ? ? 0F 10 ? ? ? ? ? ? ? ? ? ? ? ? 0F 11 ? ? ? ? 0F 10 ? ? ? ? ? ? ? ? ? ? ? ? 0F 11 ? ? ? ? EB } $5651196_60 = { 0F 1F ? ? ? ? E8 ? ? ? ? ? ? ? ? 9? 66 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? C6 ? ? ? ? ? ? ? ? ? ? ? ? ? ? C7 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? 66 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? C6 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 31 ? ? EB } $5735857_60 = { E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 0F 1F ? ? ? ? E8 ? ? ? ? ? ? ? ? 83 ? ? ? ? ? ? ? ? ? ? ? ? 75 } $5058799_60 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 0F BA ? ? ? ? 73 } $4987306_60 = { 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 81 E? ? ? ? ? ? ? ? ? 44 ?|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|dd6c7286594740898be7199a763e1900
? ? ? ? ? ? ? 41 ? ? ? ? ? ? 4C ? ? ? ? 9? 0F B6 ? ? 40 ? ? ? ? ? ? 75 } $4491881_60 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 66 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? 0F 82 } $5384124_60 = { 0F 1F ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 83 ? ? ? ? ? ? ? ? ? ? ? ? 75 } $6212553_60 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 9? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 0F 1F ? ? ? ? 48 ? ? ? ? 0F 84 } $5991938_60 = { 4C ? ? ? ? 48 ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? 0F 94 ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 4C ? ? ? ? ? ? ? ? ? ? ? ? ? ? 4C ? ? ? ? ? ? ? ? ? ? ? ? ? ? 89 ? ? 48 } $4975050_60 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 0F 10 ? ? 0F 11 ? ? ? ? ? ? ? ? ? ? ? ? 0F 10 ? ? ? ? 0F 11 ? ? ? ? ? ? ? ? ? ? ? ? 0F 10 ? ? ? ? 0F 11 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 0F 1F ? ? 48 ? ? ? ? ? ? 0F 8F } $7558357_59 = { 31 ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? B9 ? ? ? ? ? ? ? ? BF ? ? ? ? ? ? ? ?|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|e6fd50e95d5a443ba2cfb91de0e9ef6c
"E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? 0F 84 } $5152831_59 = { 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? 0F 1F ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? 48 } $4347563_59 = { 48 ? ? ? ? ? ? ? ? 66 ? ? ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? 9? 9? 48 ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? 48 ? ? ? ? ? ? 66 ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? 0F 83 } $6022661_59 = { 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 0F 1F ? ? E8 ? ? ? ? ? ? ? ? E8 ? ? ? ? ? ? ? ? 83 ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 89 ? ? 48 } $6139378_59 = { 88 ? ? ? ? ? ? 44 ? ? ? ? ? ? ? ? ? ? C6 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? FF D? 48 ? ? ? ? ? ? ? ? 0F B6 ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? ? ? 48 ? ? ? ? ? ? ? ? ? ? ? ? C3 } condition: uint16(0) == 0x5A4D and filesize < 10MB and all of them }

12/13

Related Reading:

About The BlackBerry Research & Intelligence Team The BlackBerry Research & Intelligence team examines emerging and persistent threats, providing intelligence analysis for the benefit of defenders and the organizations they serve. Back

13/13"|data_input/DarkBit_reports/entry_e610da5f-1528-4d02-bf29-3e7dcecf09c6.text|8a5b64466df640e3891d79a534d0787b
