node_1|node_2|edge|chunk_id|Edge
github|malware-notes/ransomware-windows-darkbit/readme.md|file_relationship|84380db6f9554f9fb124914053c6027a|
ransomware|windows|IOC|84380db6f9554f9fb124914053c6027a|
windows|darkbit ransomware|affected_system|84380db6f9554f9fb124914053c6027a|
ransomware_darkbit_ransomnote|darkbit ransomware|entity_relationship|fe79bf8d9e6f42bc8e21e1320447c4ba|
rule|yara rule|category_type|fe79bf8d9e6f42bc8e21e1320447c4ba|
malware entity|ransomware_darkbit_windows_asm|is a type of|eb8d1c6722e248a98ea4e89bc4cb762d|
author|albertzsigovits|written by|eb8d1c6722e248a98ea4e89bc4cb762d|
filetype|pe|is a file of type|eb8d1c6722e248a98ea4e89bc4cb762d|
threat|ransomware.darkbit.windows|has threat as|eb8d1c6722e248a98ea4e89bc4cb762d|
sha256|9107be160f7b639d68fe3670de58ed254d81de6aec9a41ad58d91aa814a247ff|has sha256 as|eb8d1c6722e248a98ea4e89bc4cb762d|
movabs r10|4d 01 d1 49 bb db 28 b4 a0 d1 7e 03 e7|entity_relationship|b190b7725fde4673bc548e74a0e37043|
add r9, r10|||b190b7725fde4673bc548e74a0e37043|
darkbit|malware entity|is a type of|483363bad6de431985575c0b472c2ab9|
thumbs.db|file extension|associated with|483363bad6de431985575c0b472c2ab9|
desktop.ini|file extension|associated with|483363bad6de431985575c0b472c2ab9|
darkbit.jpg|file extension|associated with|483363bad6de431985575c0b472c2ab9|
recovery_darkbit.txt|file extension|associated with|483363bad6de431985575c0b472c2ab9|
system volume information|folder name|contains|483363bad6de431985575c0b472c2ab9|
payment method|enter the link below http://iw6v2p3cruy7tqfup3yl4dgt4pfibfa3ai4zgnu5df2q3hus3lm7c7ad.onion /support |entity_relationship|62ca1b517845429c8ef5bb46a1103e66|
enter the link below http://iw6v2p3cruy7tqfup3yl4dgt4pfibfa3ai4zgnu5df2q3hus3lm7c7ad.onion /support|payment method|entity_relationship|62ca1b517845429c8ef5bb46a1103e66|
enter the id below and pay the bill (80 btc)|payment requirement|attribute_association|62ca1b517845429c8ef5bb46a1103e66|
48 hours deadline|time constraint for action|attribute_association|62ca1b517845429c8ef5bb46a1103e66|
30% penalty added to the price after 5 days|penalty for non-compliance|attribute_association|62ca1b517845429c8ef5bb46a1103e66|
mango sandstorm|nation-state actor linked to iranian government|affiliation|b56ba333c18c499e8fcf72d7db6eb1b7|
storm-1084|threat actor naming taxonomy|entity_relationship|b56ba333c18c499e8fcf72d7db6eb1b7|
mercury|ransomware campaign|misdirection|b56ba333c18c499e8fcf72d7db6eb1b7|
microsoft threat intelligence|destructive operations enabled by mercury|detection|b56ba333c18c499e8fcf72d7db6eb1b7|
on-premises environments|previous mercury attacks|targeting|b56ba333c18c499e8fcf72d7db6eb1b7|
cloud resources|destruction of|impacted environment|b56ba333c18c499e8fcf72d7db6eb1b7|
dev-1084|another actor that microsoft tracks|partnership|b56ba333c18c499e8fcf72d7db6eb1b7|
destructive actions|carried out after mercury's successful operations had gained access to the target environment.|following|b56ba333c18c499e8fcf72d7db6eb1b7|
mercury|known vulnerabilities in unpatched applications for initial access|exploited|317a6031edb846d4878d07a8b4714c7d|
mercury|dev-1084|handing off access to perform extensive reconnaissance and discovery|317a6031edb846d4878d07a8b4714c7d|
dev-1084|highly privileged compromised credentials|leveraging|317a6031edb846d4878d07a8b4714c7d|
dev-1084|server farms, virtual machines, storage accounts, and virtual networks|destruction of resources|317a6031edb846d4878d07a8b4714c7d|
dev-1084|internal and external recipients|sending emails to|317a6031edb846d4878d07a8b4714c7d|
dev-1084|mercury—an iran-based actor|affiliation|837e232ae5af4440ab324aa86d7debb8|
dev-1084|iran’s ministry of intelligence and security (mois)|indirect_relationship|837e232ae5af4440ab324aa86d7debb8|
dev-1084|mercury|affiliation|9eaa1b1d48fb487f855a7e5c2f9f8f28|
ip address 146.70.106[.]89|operator|operation|9eaa1b1d48fb487f855a7e5c2f9f8f28|
mullvad vpn|dev-1084 mercury|tool usage|9eaa1b1d48fb487f855a7e5c2f9f8f28|
rport|dev-1084 mercury|attack technique|9eaa1b1d48fb487f855a7e5c2f9f8f28|
ligolo customized version|dev-1084 mercury|exploitation method|9eaa1b1d48fb487f855a7e5c2f9f8f28|
vatacloud[.]com domain|c2|command and control channel|9eaa1b1d48fb487f855a7e5c2f9f8f28|
log4j 2 vulnerabilities|unpatched systems|vulnerability|28a804525bd54a8da6d233a667ffc1f9|
microsoft|threat actors|assessment|28a804525bd54a8da6d233a667ffc1f9|
threat actors|continuous intrusion|persistence|28a804525bd54a8da6d233a667ffc1f9|
web shells|local user account|installing tool|28a804525bd54a8da6d233a667ffc1f9|
legitimate remote access tools|persistent presence|leveraging technique|28a804525bd54a8da6d233a667ffc1f9|
customized powershell script backdoor|credential theft|tool|28a804525bd54a8da6d233a667ffc1f9|
netstat and nltest tools|extensive discovery|reconnaissance technique|28a804525bd54a8da6d233a667ffc1f9|
threat actors|actors|entity_relationship|b1e8831eec794a069833e356eb8bd682|
c2 servers|execution and communication|relation|b1e8831eec794a069833e356eb8bd682|
tunnelling tools|ligolo and openssh|type|b1e8831eec794a069833e356eb8bd682|
security teams and solutions|under the radar|goal|b1e8831eec794a069833e356eb8bd682|
highly privileged credentials|domain controllers|access|b1e8831eec794a069833e356eb8bd682|
on-premises destructive operations|large-scale encryption of targeted devices|objective|b1e8831eec794a069833e356eb8bd682|
group policy objects (gpo)|impaired defenses|function|b1e8831eec794a069833e356eb8bd682|
ransomware payload|netlogon shares on domain controllers|location|b1e8831eec794a069833e356eb8bd682|
scheduled task|launch ransomware payload|action|b1e8831eec794a069833e356eb8bd682|
ransom notes|encrypted files|change file name extension to DARKBIT|b1e8831eec794a069833e356eb8bd682|
on-premises attack flow|azure active directory (azure ad)|threat_actors|ad1926f188db4318bae672b50ceeb660|
compromised privileged account|azure ad connect agent|access_relationship|ad1926f188db4318bae672b50ceeb660|
azure active directory (azure ad) connect agent installation|multiple accounts creation|functional_role|ad1926f188db4318bae672b50ceeb660|
azure ad ds connector account|ad ds connector account|entity_relationship|3ab053f82c17461390fc11f6d4394bf2|
permissions|features enabled during installation|cause_effect|3ab053f82c17461390fc11f6d4394bf2|
threat actors|azure ad connector account|uses|485ca11111e8422d811bdeb1ef3b99c3|
compromised credentials|azure ad connect device|used for accessing|485ca11111e8422d811bdeb1ef3b99c3|
ssh tunnel|attacker-controlled device|established to|485ca11111e8422d811bdeb1ef3b99c3|
aadinternals tool|compromised device|installed on|485ca11111e8422d811bdeb1ef3b99c3|
get-aadintsynccredentials function|azure ad connector account and the ad ds connector account credentials extraction|used for extracting plaintext credentials of both accounts|485ca11111e8422d811bdeb1ef3b99c3|
authentication from attacker ip address|azure ad connector cloud account access|for sign-in|485ca11111e8422d811bdeb1ef3b99c3|
single factor authentication|easier for the attackers to gain entry and elevate privileges|Configuration on Azure AD Connector account|485ca11111e8422d811bdeb1ef3b99c3|
threat actors|ransomware attack|actor-attack|6511e1a0158d48eb85675dcdff9a35e6|
global administrator permissions|azure ad connector account|permission-account|6511e1a0158d48eb85675dcdff9a35e6|
global administrator permissions|rdp for access into the account|access-permissions|6511e1a0158d48eb85675dcdff9a35e6|
threat actors|cloud destructive impact|actor-impact|6511e1a0158d48eb85675dcdff9a35e6|
azure environment sign-in|azure privileged identity management (pim)|signin-pim|6511e1a0158d48eb85675dcdff9a35e6|
threat actors|significant destruction of the azure environment|actor-destruction|6511e1a0158d48eb85675dcdff9a35e6|
exchange web server api abuse|oauth application with full access permission and administrator consent|entity_relationship|ba1b9c3199f04a7c9d0431a67d6fa6db|
obtained cloud administrator privileges|updated oauth application with certificates to conduct malicious activities|sequence|ba1b9c3199f04a7c9d0431a67d6fa6db|
newly added credentials for access tokens and authenticate on behalf of the application to access cloud resources|threat actors performing getitem operations over mailboxes in target environment|entity_relationship|ba1b9c3199f04a7c9d0431a67d6fa6db|
search activities suspected attempts to dump mailboxes/search for sensitive data|thousands of search activities|sequence|ba1b9c3199f04a7c9d0431a67d6fa6db|
compromised administrator account granting smtp send on behalf permissions to the azure ad connector account over a high-ranking employee's mailbox using set-mailbox powershell cmdlet|email impersonation used by threat actors|sequence|ba1b9c3199f04a7c9d0431a67d6fa6db|
emails created and sent both internally and externally.|threat actors successfully sending emails through targeted account|sequence|ba1b9c3199f04a7c9d0431a67d6fa6db|
cloud attack flow timeline|destructive attacks|technique|8a7e5bd9189a42d1ac94e895f627d8ce|
mitigations for destructive attacks|microsoft’s blog ransomware as a service: understanding the cybercrime gig economy and how to protect yourself|resource_reference|8a7e5bd9189a42d1ac94e895f627d8ce|
tamper protection|antivirus tampering|countermeasure|8a7e5bd9189a42d1ac94e895f627d8ce|
conditional access policies|organizations|security_measure|8a7e5bd9189a42d1ac94e895f627d8ce|
continuous access evaluation|real-time protection|security_protection|8a7e5bd9189a42d1ac94e895f627d8ce|
sendas operation|email tracking|detection_method|8a7e5bd9189a42d1ac94e895f627d8ce|
suspicious operations in azure|attacker activities|related|4eabec73ad3b4c0ea1f166d6c1270464|
microsoft 365 defender alerts|detecting suspicious operations|used_for|4eabec73ad3b4c0ea1f166d6c1270464|
azure ad connect accounts|compromised azure ad|related|4eabec73ad3b4c0ea1f166d6c1270464|
microsoft defender for cloud apps alerts|destructive operations in azure|used_for|4eabec73ad3b4c0ea1f166d6c1270464|
azure connector enabled|alerts can be used to detect destructive operations|related|4eabec73ad3b4c0ea1f166d6c1270464|
medium and high severity alerts for highly privileged accounts|indicate malicious activity|used_for|4eabec73ad3b4c0ea1f166d6c1270464|
unfamiliar sign-in properties|unfamiliar sign-in properties|related|4eabec73ad3b4c0ea1f166d6c1270464|
microsoft defender antivirus|detected attempted exploitation and post-exploitation activity|detection|e2359a81ca00422c9c9bb01ec3106a86|
cloud-delivered protection|covers rapidly evolving attacker tools and techniques|coverage|e2359a81ca00422c9c9bb01ec3106a86|
log4j 2 vulnerabilities|list of detection names related to exploitation|exploitable_vulnerability|e2359a81ca00422c9c9bb01ec3106a86|
backdoor:php/remoteshell.v|hacktool:win32/lsadump virtool:win32/remoteexec trojan:powershell/downloader.sb trojan:win32/nibtse.g!tsk backdoor:asp/shellman.sa ransom:win64/darkbit|IOCs|e2359a81ca00422c9c9bb01ec3106a86|
microsoft defender for endpoint|alerts with the following titles|alerts|e2359a81ca00422c9c9bb01ec3106a86|
mercury actor activity detected|ransomware-linked emerging threat actor dev-1084 detected reducing the attack surface microsoft defender for endpoint customers can turn on the following attack surface reduction rule to block or audit some observed activity associated with this threat:|activity|e2359a81ca00422c9c9bb01ec3106a86|
block executable files|from running unless they meet a prevalence, age, or trusted list criterion.|blocking|e2359a81ca00422c9c9bb01ec3106a86|
controlled folder access|ransomware prevention|defense mechanism|36c5920a17ea462cb88318106ba4bbee|
log4j exploitation alert|threat activity investigation and remediation|indicator|36c5920a17ea462cb88318106ba4bbee|
microsoft defender vulnerability management|log4j 2 vulnerability detection and remediation|is used for|f77d231059b3464f929c7fe0161ccdaa|
microsoft 365 defender customers|threat and vulnerability management|utilize to identify and remediate vulnerable devices|f77d231059b3464f929c7fe0161ccdaa|
log4j 2 exploitation|comprehensive guidance blog|explains prevention, detection, and hunting for the capability|f77d231059b3464f929c7fe0161ccdaa|
advanced hunting query|mercury powershell script backdoor installation|assists in locating potential related activity|f77d231059b3464f929c7fe0161ccdaa|
powershell.exe process|specific file locations and command line parameters|used to identify instances of the query's target|f77d231059b3464f929c7fe0161ccdaa|
advanced hunting query|mercury powershell script backdoor initiating commands|entity_relationship|ec5906f349264ee889f87e78ca441637|
advanced hunting query|azure resource deletion activity|entity_relationship|ec5906f349264ee889f87e78ca441637|
oauth application|office 365|used in attack|6f62c5acd06f4e5287f174a9dcee5fcf|
cloudappevents|event|generated during the event|6f62c5acd06f4e5287f174a9dcee5fcf|
microsoft sentinel|threat intelligence solution|solution_integration|8fff8551f18342a98572d376f7cd3a10|
customers|ti mapping analytic|customer_tool|8fff8551f18342a98572d376f7cd3a10|
ti mapping analytics|data in their workspace|analysis_source|8fff8551f18342a98572d376f7cd3a10|
dev|batch script|is-related-to|d604b67f169244f0ae9a98f9bb3cfee6|
f1edff0fb16a64ac5a2ce64579d0d76920c37a0fd183d4c19219ca990f50effc|dev|is-related-to|d604b67f169244f0ae9a98f9bb3cfee6|
batch script|command and control|is-related-to|d604b67f169244f0ae9a98f9bb3cfee6|
hxxps://pairing[.]rport[. ]io/qmlc2wx|download rport software from it|is-used-for|d604b67f169244f0ae9a98f9bb3cfee6|
194.61.121[. ]86|command and control|is-related-to|d604b67f169244f0ae9a98f9bb3cfee6|
command and control|ip address|uses-for-communication|d604b67f169244f0ae9a98f9bb3cfee6|
command and control|ip address 192.169.6[.]88|has_location|0feb8140d75d4f4584eaaa08b21ed91f|
command and control|ip address 192.52.167[.]209|has_location|0feb8140d75d4f4584eaaa08b21ed91f|
command and control|webstore4tech[.]uaenorth.cloudapp.azure[.]com|is_connected_to|0feb8140d75d4f4584eaaa08b21ed91f|
command and control|vatacloud[.]com|is_connected_to|0feb8140d75d4f4584eaaa08b21ed91f|
actor|rport domain|owns|0feb8140d75d4f4584eaaa08b21ed91f|
operators|threatening emails|sent_after|0feb8140d75d4f4584eaaa08b21ed91f|
ip address 146.70.106[.]89|attack source|is|0feb8140d75d4f4584eaaa08b21ed91f|
mercury|b9cf785...fstring|has_hash|0feb8140d75d4f4584eaaa08b21ed91f|
rport legit remote access tool|ab179112caadaf138241c...tool|is_type|0feb8140d75d4f4584eaaa08b21ed91f|
customized ligolo tunneling tool|46.249.35[.]243|has_location|0feb8140d75d4f4584eaaa08b21ed91f|
command and control 1|ip address 45.86.230...20|is_connected_to|0feb8140d75d4f4584eaaa08b21ed91f|
command and control 2|ip address 6485a6...b0c79f77|has_location|0feb8140d75d4f4584eaaa08b21ed91f|
customized script backdoor db.ps1|b155c5...e15299ab|is_type|0feb8140d75d4f4584eaaa08b21ed91f|
customized obfuscated script backdoor rport.exe|rport.sqlite obfuscated script backdoor|has_location|0feb8140d75d4f4584eaaa08b21ed91f|
muddywater|iranian apt group|is_attributed_to|6b62ea36d1b6419cb2d700047ae9e40a|
darkbit ransomware|ransomware related|has_relationship_with|6b62ea36d1b6419cb2d700047ae9e40a|
muddywater| darkbit |is_responsible_for|6b62ea36d1b6419cb2d700047ae9e40a|
ransomware|darkbit ransomware sample (written in golang)|malware entity relationship|bb1d3f3255cc486cb0af85762c048ea3|
command line arguments|darkbit ransomware sample|technique relationship|bb1d3f3255cc486cb0af85762c048ea3|
inbuilt configuration file|darkbit ransomware sample|malware entity attribute|bb1d3f3255cc486cb0af85762c048ea3|
obfuscated dll names|darkbit ransomware sample|evasion relationship|bb1d3f3255cc486cb0af85762c048ea3|
dynamically resolving api|malware authors|technique relationship|bb1d3f3255cc486cb0af85762c048ea3|
createmutexw api|instances of malware running check|malware entity technique|bb1d3f3255cc486cb0af85762c048ea3|
multithreading|darkbit ransomware sample|technique relationship|bb1d3f3255cc486cb0af85762c048ea3|
vssadmin.exe|delete shadow copies|cybersecurity measure relationship|bb1d3f3255cc486cb0af85762c048ea3|
systemfunction036|generate random key|malware entity technique|bb1d3f3255cc486cb0af85762c048ea3|
buffer size 80|systemfunction036 access|technique relationship|bb1d3f3255cc486cb0af85762c048ea3|
encrypted files (key used for encrypting files)|attached to encrypted files|cybersecurity measure relationship|bb1d3f3255cc486cb0af85762c048ea3|
encryptionalgorithm|aes|used for encrypting the files|761aeb64d3ae48d2902a479ee8c7493f|
filesystemapi|findfirstfilew, findnextfilew|used to iterate through file system|761aeb64d3ae48d2902a479ee8c7493f|
writefile api|setfilepointerex api|encrypting files in chunks and not as a whole|761aeb64d3ae48d2902a479ee8c7493f|
encryption key|stored at the end of encrypted file|after encrypting each file|761aeb64d3ae48d2902a479ee8c7493f|
.darkbit extension|encrypted files|given after encryption|761aeb64d3ae48d2902a479ee8c7493f|
ransom note|dropped in respective folders|after encrypting all the files|761aeb64d3ae48d2902a479ee8c7493f|
tweet on ransomware activity|malware threat actor or security researcher's observation|discussed the attack and its impact|761aeb64d3ae48d2902a479ee8c7493f|
darkbit|ransomware family|entity_relationship|74b0c36e91b3422abc7027b33d002023|
muddywaters|threat actor|entity_relationship|74b0c36e91b3422abc7027b33d002023|
cobalt strike|tool for initial access|used_by|74b0c36e91b3422abc7027b33d002023|
political motivation|attack purpose|relationship|74b0c36e91b3422abc7027b33d002023|
k7 labs|security provider|provides_detection|74b0c36e91b3422abc7027b33d002023|
k7 total security|recommended security product|used_for|74b0c36e91b3422abc7027b33d002023|
iocs|file name, hash, detection name|related_to|74b0c36e91b3422abc7027b33d002023|
darkbit ransomware|ransomware strain|is-a|c7e59205d49f40aa923115047c49fc19|
israel|target of attack|targeted|c7e59205d49f40aa923115047c49fc19|
technion - israel institute of technology (iit)|university targeted|attacked|c7e59205d49f40aa923115047c49fc19|
golang-compiled ransomware|ransomware type|implementation|c7e59205d49f40aa923115047c49fc19|
geopolitical motivations|threat actor's intentions|motive|c7e59205d49f40aa923115047c49fc19|
anti-israeli rhetoric|ransom note content|contains|c7e59205d49f40aa923115047c49fc19|
command-line options and data encryption optimization for large files|main pe module feature|supports|c7e59205d49f40aa923115047c49fc19|
darkbit ransom note|80 bitcoin (btc)|Monetary Demand|3e1758b9545c4807b9532daf97c8ee9e|
haifa-based academic university|incident response activities|Event Relation|3e1758b9545c4807b9532daf97c8ee9e|
technion's twitter account post|the scope and nature of the attack|Contextual Information|3e1758b9545c4807b9532daf97c8ee9e|
best experts in the field|coordination with authorized authorities||3e1758b9545c4807b9532daf97c8ee9e|Expert Collaboration
darkbit ransomware|filetype exclusion list msilog ldf lock theme msi sys wpx cpl adv msc scr key ico dll hta deskthemepack nomedia msu rtp msp 5/13 idx ani diagcfg bin mod icl ocx rom prf themes pack mpa drv cur diagnostic cab exe cmd shs|targeted_exclusion|77f427e017f34d60be16638be52218bf|
darkbit ransomware|max file size (mb)|encryption_threshold|77f427e017f34d60be16638be52218bf|
encrypted files|parts and part sizes|divided_files_structures|77f427e017f34d60be16638be52218bf|
darkbit|ransomware group|entity_relationship|7edb96557003411cb5364e8c9e1f3bbd|
victim payment information page|figure 6|refers_to|7edb96557003411cb5364e8c9e1f3bbd|
telegram account|darkbit group's telegram page|mentioned_in|7edb96557003411cb5364e8c9e1f3bbd|
darkbit ransomware group’s twitter page|figure 7|refers_to|7edb96557003411cb5364e8c9e1f3bbd|
twitter handle (@)darkbittw|ransom note|related_with|7edb96557003411cb5364e8c9e1f3bbd|
#hackforgood|hashtag used by darkbit|used_in|7edb96557003411cb5364e8c9e1f3bbd|
darkbit’s twitter page|figure 8|refers_to|7edb96557003411cb5364e8c9e1f3bbd|
technion - israel institute of technology|only known target of darkbit|is_targeted_by|7edb96557003411cb5364e8c9e1f3bbd|
geopolitical motivations|ransomware attacks|relationship|b73a7e9b28624b9fb752d38a6fd4efee|
threat actors|disgruntled employees/groups of employees|association|b73a7e9b28624b9fb752d38a6fd4efee|
malware entity|a related malware|entity_relationship|e7d90c5d6aed43008e82953dce954461|
b9 ?? |0f 84 } $4935722_63 = {|execution|e7d90c5d6aed43008e82953dce954461|
e8 ?? |0f b6 ?? ?? 0f b6|communication|e7d90c5d6aed43008e82953dce954461|
e8|0f b6|entity_relationship|49b73aa50a2142dcbfe6ac4f66a94360|
48|b9|entity_relationship|49b73aa50a2142dcbfe6ac4f66a94360|
malware entity|a related malware|entity_relationship|7fb631a39c324536980ab6706c87c467|
malware entity|c6|entity_relationship|81e158789d31496e84a15b30cb9573d2|
c6|a related malware|entity_relationship|81e158789d31496e84a15b30cb9573d2|
malware entity|techniques or methods used in malware creation and execution|has technique|85278abc502746c3bf01811c72543726|
cybersecurity measures|iocs for detecting the malware threats|detection method|85278abc502746c3bf01811c72543726|
blackberry research & intelligence team|threat analysis and intelligence|provides|591664674508490fa2423207ea13cea5|
emerging threats|persistent threats|examines|591664674508490fa2423207ea13cea5|
