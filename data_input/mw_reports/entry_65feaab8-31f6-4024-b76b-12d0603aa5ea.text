THROUGH THE EYES OF
THE ADVERSARY
T H E S Y N T H E S I S O F T H R E AT I N T E L L I G E N C E & T H R E AT
H U N T I N G O P E R AT I O N S

SPEAKER
JEN AYERS
VP, OverWatch and Security Response

§ Over 20 years of cybersecurity experience
§ Serves more than 20% of the Fortune 500
§ Multiple roles both as a service provider as well as
working in industry

© 2019 CROWDSTRIKE

SPEAKER
JASON RIVERA
Director: Global Threat Intelligence Advisors

§ 13+ years experience in threat intelligence
§ Experience building threat intel programs for
Fortune 500 companies and large government
agencies.
§ Former US Army Intelligence Officer at NSA & US
Cyber Command

© 2019 CROWDSTRIKE

EXECUTIVE SUMMARY

THE CHALLENGE
On the other side of the most advanced attacks are intelligent,
motivated, and highly capable human beings

The adversary is intelligent
enough to estimate your
defenses and to creatively
conceive of ways to bypass
them

© 2019 CROWDSTRIKE

The adversary is sufficiently
motivated, either financially,
ideologically, or by nationalism,
and is willing to do what it takes to
achieve their objectives

The adversary is highly
capable, and has a wealth of
tools, personnel, experience &
resources at their disposal

THE ADVERSARY IS SUCCEEDING AT HIGHER RATES
THAN EVER BEFORE
2019 Big Game Hunting Incidents

© 2019 CROWDSTRIKE

KEY OBSERVATIONS

OBSERVATION 1
Flexibility & Creativity

© 2019 CROWDSTRIKE

WICKED SPIDER

WICKED PANDA

Target:

Financial

Target:

Telecom

Technique:

Remote RDP login with
stolen credentials.
Establish foothold

Technique:

Use common Microsoft
admin tools to download
implants, bypassing detection

VELVET CHOLLIMA

CLOCKWORK SPIDER

Target:

Academic

Target:

Opportunistic

Technique:

Spearphishing to
deliver malicious
Chrome extensions

Technique:

Install custom root certificate
on victim to support man-in-themiddle network monitoring

OBSERVATION 2
Speed & Agility
2018 Breakout Times
Russia
North Korea
China
Iran
E-Crime

© 2019 CROWDSTRIKE

HOW TO SEE
THROUGH THE EYES
OF THE ADVERSARY

SO… WHAT IS AN “ADVERSARY”?
The adversary is a person or group of people who seek to harm
our interests.
Ourselves

© 2019 CROWDSTRIKE

The Adversary

HOW CAN WE CONCEIVE OF OURSELVES?
Ourselves

Public
Sector

Healthcare

Strategic

Operational

Industry

Critical Assets

Energy

Tech

Financial

Access Vectors

Consumer
Products

People

What things of value do you
have that the adversary wants
to target?
© 2019 CROWDSTRIKE

Tactical

Processes

Technology

What people, processes, and
technologies will the adversary
target?

Physical

Human

Digital

Supply Chain

Social
Engineering

Internal to
Network

Comms
Infrastructure

Coercion

External to
Network

Close Access

Business
Transaction

Lateral
Movement

How will the adversary gain
entry into your organization?

HOW CAN WE CONCEIVE OF THE ADVERSARY?
The Adversary

Strategic
Motive

Intent

What are the underlying
conditions that contribute to
motive & intent?
© 2019 CROWDSTRIKE

Operational
Capability

Infrastructure

What capabilities do they
possess, how do they work, &
what infrastructure will those
capabilities come from?

Tactical
TTPs

What TTPs will the adversary
execute in order to gain
access?

THE CYBER THREAT LANDSCAPE
The Adversary

Ourselves
Public
Sector

Healthcare

Energy

Tech

Financial

Consumer
Products

Operational

Critical Assets

People

Physical

Processes

Access
Vectors
Human

Motive

Intent

Capability

Infrastructure

Technology

Digital

Supply Chain

Social
Engineering

Internal to
Network

Comms
Infrastructure

Coercion

External to
Network

Close Access

Business
Transaction

Lateral
Movement

© 2019 CROWDSTRIKE

Strategic

Tactical

TTPs

SO HOW DO WE FIGHT
BACK?

THREAT HUNTING & THREAT INTELLIGENCE
The Adversary

Ourselves
Public
Sector

Healthcare

Energy

Tech

Financial

Consumer
Products

Operational

Critical Assets

People

Processes

Physical

Access
Vectors
Human

Motive

Intent

Capability

Infrastructure

Technology

Digital

Supply Chain

Social
Engineering

Internal to
Network

Comms
Infrastructure

Coercion

External to
Network

Close Access

Business
Transaction

Lateral
Movement

Threat Hunting

© 2019 CROWDSTRIKE

Strategic

Tactical

TTPs

Threat Intelligence

OPERATIONALIZING THREAT HUNTING
Observations from from
intrusions drive long-term R&D

Analyze

Analysts identify possible
intrusion activity

Find

Fix

Activity is scoped,
analyzed, &
tracked

Threat intel is
operationalized

Exploit
© 2019 CROWDSTRIKE

Finish

Actionable intel is
provided to customer

ENABLING ELEMENTS

ENVIRONMENT

Process

Technical

§ Asset Inventory
§ Classification of Data
& Assets

§ Speed
§ Context
§ Baselining

§
§
§
§

© 2019 CROWDSTRIKE

Host Visibility
Network Awareness
Enterprise Search
Threat Intelligence

TECHNICAL CAPABILITIES FRAMEWORK
Capability
Host-level activity
awareness

Minimum
•

Centralized log aggregation

•

Real-time EDR

•

Transaction logging
(Proxy/FW)
Netflow

•
•
•

NIPS
PCAP
SSL inspection

On-demand triage scripts
Clean asset / application
inventory

•

Centralized aggregation of data
(searchable)
Event correlation

Ad-hoc, open sourced
research
Primary tactical

•
•
•

Network-level awareness
•
Enterprise Log Search

•
•
•

Threat Intelligence

© 2019 CROWDSTRIKE

Preferred

•

•

Subscription to reputable source
Information sharing
Integrated tactical, strategic and
operational

A NO-COST STARTING POINT
Logs (Network, Event Logs, DNS, AD Logs, DHCP, etc.)
LOG TYPES

LOG SOURCE

RETENTION
PERIOD

Requests

DNS Logs

3 months

Applications, Security & System

Windows Event Logs

12 months

Access

Web Proxy Logs
Firewall Logs

6 months

Active Directory
Authentication

Remote Access

6 months

Authentication Logs
https://apps.nsa.gov/iaarchive/library/reports/spotting-the-adversary-with-windows-event-log-monitoring.cfm
www.crowdstrike.com/blog/the-importance-of-logs/
© 2019 CROWDSTRIKE

OPERATIONALIZING THREAT INTELLIGENCE
Which stakeholders will
consume the things we
produce?

Why are we doing this?

Planning &
Direction

Dissemination
& Feedback

What kinds of things are
we going to produce?
© 2019 CROWDSTRIKE

Collection &
Processing

Analysis &
Production

How are we going to
collect stuff?

INTELLIGENCE LIFECYCLE STEPS 1 & 2
Process
Planning &
Direction

Collection &
Processing

© 2019 CROWDSTRIKE

Goal

Desired Outcome

Use your estimate of the cyber threat landscape
to develop your hypotheses, which then serve to
define your mission through PIRs. Understand
who will benefit from cyber threat intelligence,
your stakeholders, what their intel requirements
are and how to fulfill them.

•
•

Cyber Threat Landscape
Priority Intelligence
Requirements

Identify the inventory of existing threat
intelligence sources within your environment
(historical and real time). Collect from these
trusted sources and external providers to satisfy
PIRs, then de-duplicate, prioritize, normalize,
and correlate raw threat data in an indicator /
reporting storage solution (such as a SIEM, TIP,
or Wiki).

•
•

Collection Plan
Information Gaps

INTELLIGENCE LIFECYCLE STEPS 3 & 4
Process
Analysis &
Production

Dissemination &
Feedback

© 2019 CROWDSTRIKE

Goal

Desired Outcome

Contextualize threat intelligence through
enrichment and correlation within your
enrichment. Produce human-readable or
machine-readable products that are relevant,
and predictive.

•
•

Analytic Products
Production Cadence

Deliver timely and actionable intelligence
products to your teams and technologies to stay
aware of significant or emerging threats and
inform decision-making. Receive feedback in
order to further refine the intelligence lifecycle in
pursuit of fulfilling PIRs and other cybersecurity
information objectives.

•

Stakeholder Consumption
1. Tactical
2. Operational
3. Strategic

•

Stakeholder Feedback

HOW TO SERVE THREAT HUNTING & THREAT INTEL
STAKEHOLDERS
Let’s imagine them as being kinda like a race car driving team…
TACTICAL
STAKEHOLDERS:
• Security Engineers
• SIEM
• Firewall
• Endpoints
• IDS/IPS

”Mechanic”

Focused on enhancing automated
defenses, optimizing visibility, and
achieving high states of situational
awareness and efficacy throughout
the enterprise.

© 2019 CROWDSTRIKE

OPERATIONAL
STAKEHOLDERS:
• SOC Analyst
• Vulnerability Mgmt.
• Incident Response
• Threat Hunters
• Threat Intelligence

”Race Car Driver”

Focused on understanding adversarial
capabilities, infrastructure, & TTPs, and
then leveraging that understanding to
conduct more targeted and prioritized
cybersecurity operations.

STRATEGIC
STAKEHOLDERS:
• CISO
• CIO
• CTO
• Executive Board
• Strategic Intel

”The Owner”

Focused on understanding high level
trends and adversarial motives, and
then leveraging that understanding to
engage in strategic security and
business decision-making.

WHAT DOES THIS LOOK
LIKE IN ACTION?

CASE STUDY: BIG GAME HUNTING
§ Increased global activity by ECrime actor GRIM SPIDER
§ Targeted ransomware deployment (Big Game Hunting)
§ Goal: Get deep access to network, deploy ransomware broadly, PROFIT!

§ Initial access via targeted phishing email with macro-enabled MS Word
doc
§ Obfuscated PowerShell script deploys modular malware TrickBot
1

Initial
Access

5
2

3

Execution

Persistence

4

Privilege
Escalation
© 2019 CROWDSTRIKE

Defense
Evasion

6

7

8

9

10

11

12

Credential
Access

Discovery

Lateral
Movement

Collection

Exfiltration

Command
& Control

Impact

CYBER THREAT LANDSCAPE: BIG GAME HUNTING
The Adversary

Ourselves
Public
Sector

Healthcare

Energy
Tech
Financial
Financial
Resources

Consumer
Products

Strategic

Motive

Intent
Extortion
Data Theft

Operational

Critical Assets

People

Physical

Processes

Access
Vectors
Human

Fraud

Capability

Infrastructure

Technology

Digital

Supply Chain

Social
Engineering

Internal to
Network

Comms
Infrastructure

Coercion

External to
Network

Close Access

Business
Transaction

Lateral
Movement

© 2019 CROWDSTRIKE

Criminal

Tactical

TTPs
Spear Phishing

CASE STUDY: BIG GAME HUNTING
•

•

•
•

Additional tools downloaded and deployed
•
Trickbot modules for recon and id theft
•
PowerShell Empire framework
Leveraged scheduled tasks, services, and masqueraded file names to attempt to blend in
•
Tasks and services: WinDotNet, GoogleTask, Sysnetsf, ControlServiceA,
Updater
•
Files, directories: WinDefrag, NetSocket
TrickBot module pwgrab64 sets registry key UseLoginCredential = 1 resulting in
creds stored in plaintext memory, accessible to cred dumping tools
Collected creds for mail clients, web browsers, FileZilla, WinSCP, PuTTY, VNC, RDP

3
1

Initial
Access

2

Execution

© 2019 CROWDSTRIKE

Persistence

5
4

Privilege
Escalation

Defense
Evasion

6

Credential
Access

7

8

9

10

11

12

Discovery

Lateral
Movement

Collection

Exfiltration

Command
& Control

Impact

CYBER THREAT LANDSCAPE: BIG GAME HUNTING
The Adversary

Ourselves
Strategic

Financial Resources

Motive

Intent
Extortion
Data Theft

Operational

Critical Assets

Physical

Processes

Access
Vectors
Human

Capability

Infrastructure

Technology

Digital

Supply Chain

Social
Engineering

Internal to
Network

Comms
Infrastructure

Coercion

External to
Network

Close Access

Business
Transaction

Lateral
Movement

© 2019 CROWDSTRIKE

Fraud

Trickbot

PowerShell
People

Wizard
Criminal
Spider

Tactical

TTPs
Spear Phishing

CASE STUDY: BIG GAME HUNTING
•

Trickbot modules networkdll and psfin
•
Collects local system and network data via WMI, LDAP, and command line
•
Hunts for financial and Point-of-Sale systems

•

Hunting for admin credentials

•
•
•

First lateral movement can happen within hours of initial access
Tools: PsExec.exe, TrickBot shareDll module
Achieving admin access can take days to months

1

2

3

Initial
Access

Execution

Persistence

© 2019 CROWDSTRIKE

4

Privilege
Escalation

5

Defense
Evasion

6

Credential
Access

7

8

9

Discovery

Lateral
Movement

Collection

10

11

12

Exfiltration

Command
& Control

Impact

CYBER THREAT LANDSCAPE: BIG GAME HUNTING
The Adversary

Ourselves
Strategic

Financial Resources

Motive

Intent
Extortion
Data Theft

Operational

Critical Assets
Admin Creds
People

Physical

PowerShell
Processes

Access
Vectors
Human

System & Network Data
Financial & POS Systems

Fraud

Capability

Infrastructure

Trickbot

Technology

Digital

Supply Chain

Social
Engineering

Internal to
Network

Comms
Infrastructure

Coercion

External to
Network

Close Access

Business
Transaction

Lateral
Movement

© 2019 CROWDSTRIKE

Wizard Spider

Tactical

TTPs
Spear Phishing

CASE STUDY: BIG GAME HUNTING
•

Trickbot modules networkdll and psfin
•
Collects local system and network data via WMI, LDAP, and command line
•
Hunts for financial and Point-of-Sale systems
Hunting for admin credentials

•
•
•

First lateral movement can happen within hours of initial access
Tools: PsExec.exe, TrickBot shareDll module
Achieving admin access can take days to months

•

1

2

3

Initial
Access

Execution

Persistence

© 2019 CROWDSTRIKE

4

Privilege
Escalation

5

Defense
Evasion

6

Credential
Access

7

8

9

Discovery

Lateral
Movement

Collection

10

11

12

Exfiltration

Command
& Control

Impact

CYBER THREAT LANDSCAPE: BIG GAME HUNTING
The Adversary

Ourselves
Strategic

Financial Resources

Motive

Intent
Extortion
Data Theft

Operational

Critical Assets
Admin Creds
People

Physical

PowerShell
Processes

Access
Vectors
Human

System & Network Data
Financial & POS Systems

Fraud

Capability

Infrastructure

Trickbot

Technology

Digital

Supply Chain

Social
Engineering

Internal to
Network

Comms
Infrastructure

Coercion

External to
Network

Close Access

Business
Transaction

Lateral
Movement

© 2019 CROWDSTRIKE

Wizard Spider

Tactical

TTPs
Spear Phishing

CASE STUDY: BIG GAME HUNTING
•
•

Leverage domain admin and Domain Controller as staging ground
Stage Ryuk ransomware and deploy to targets via PsExec
•
Noisy operation, so speed is of the essence at this point
•
3-8 hours to deploy globally

2
1

Execution

Initial
Access
© 2019 CROWDSTRIKE

3

4

Persistence
Privilege
Escalation

5

Defense
Evasion

6

Credential
Access

7

8

9

10

Discovery

Lateral
Movement

Collection

Exfiltration

11

12

Command
& Control

Impact

CYBER THREAT LANDSCAPE: BIG GAME HUNTING
The Adversary

Ourselves
Strategic

Financial Resources

Motive

Intent
Extortion
Data Theft

Operational

Critical Assets
Admin Creds
People

PowerShell
Processes

Physical

Access
Vectors
Human

Domain Controller
System & Network Data
Financial & POS Systems

Fraud

Capability

Infrastructure

Trickbot

Technology

Digital

Supply Chain

Social
Engineering

Internal to
Network

Comms
Infrastructure

Coercion

External to
Network

Close Access

Business
Transaction

Lateral
Movement

Threat Hunting

© 2019 CROWDSTRIKE

Wizard Spider

Ryuk

Tactical

TTPs

Threat Intelligence

Spear Phishing

RECOMMENDATIONS
A proactive mindset and a little bit of planning go a long way

The fundamentals still
matter – continue to enforce
basic security hygiene

© 2019 CROWDSTRIKE

Look beyond malware:
strengthen defenses
against modern attack

Survival of the fastest:
accept the 1-10-60
challenge

Look to partners to help
solve the skills shortage

THANK YOU.
ANY QUESTIONS?
© 2019 CROWDSTRIKE