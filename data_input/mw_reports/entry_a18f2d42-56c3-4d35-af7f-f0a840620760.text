855 868
3 33

du

ur

s

s

r

dr

d d

s
r
s

ds
w r
r

s

w r

s

s

r du
r w s
r
d rs

s
d

ss

s

s

E 201

113

rs

r
s
s ru

rd d d
w r
rds

s
w
w r us d
d ws
s r
rs

w r s
s ru
z d

ddr ss s r
s
w
r

dr
s

su r u
r

r

w

ur

s rs
r

u

s

s u
s

r
rs w

d ss

s

r

s

s

s d

Eur
r d
s
s r d

ur
s

I
s

s
d

d s
s
I
d

r

d
d

d

r

s r
ss

d
s

s

w r us rs w
s
us d
r
s u d w
r
rd
rus s u
s
r
d
d
w r
r r d rs r
s
r s
s
r

ss

r
sd r

s u

s
u
w

d

d

z

E 2015 1 01 w r

d

s

us
r s ur

ww r d

u d

s d
w r w

s

sw

s

s

d

s
d

ur

d
ur

s
sr

r

w r s ur
r s s
s
ud
ss s w r
s
d
d

ss
rs

s

ddr ss s u
s ru

r

u s r u
ss u

s
s
r

u s
u d

E

u

I

r us
s
r

d

ss
r s

r

ss
s

s
r
ss w

u 6

u
s

ru

s

d

rs

s
ds s

r

I
rus s

s d
w r

d

u

ss

ss

u
r
s

z d
s

u

s

s
ur r
r d

ss
z d s

r
d

d

s
d

s

s

I

w r
d
d
d d

s

ur

sw
r r
s
r
ur
r
sw ud
r
s w

s ur

I Nt* and Rtl*
ddr
s s
s INT 2Eh
d CALL ntdll!KiFastSystemCall
ss us r s
s us d
rus s w r
ds d
s
s s d
sr s
w
Is d s s
s r u d u
d u d r d u
d d
w
u d rs
d
s u
s
s
rw
d ws r r
r d r
s
d ws
r
s s

s

s

sur s

s

r
s su

www z
I
s
sw ud

us
r

s d
u

s u

w

r
u

d
r d

ss

s

u

s

us d
ss
r u
r
d
rw r
r
d
r s r
w r
d ws d s
d
d
ss r d
s u
s
us s d
u s d
u s
w r w s
u
d

w r

w s wr
s d

s

w

s

r
E s r Eur

dr
r
d w
ud
rs s
r s
r r
d
ss d

w r

I
s s

r d
rs

r
d

w r w sr
d s
d

d d
r r

w

ds

w r

rs

r

r
r

r

rs
u

d

d
ddr ss s

r s
r

d

d
s

rs

s

u
s
d

d

ss

u

r

rus r du s

ds w

ss
r

s

ru d r
d
w

u

u

s
r u

s
dds

s

w

s

d

s
w ds
r sr
u s r d
ss s d
r
r

s

r

us
d

us

rs
r

us

d
ru

r

r

d
sdr
ss

r

w r

r
r

s

r

s
s
s r
rus s w r
r ru
s
d
us
ru s d
sr
r w
w
r
s
s r
ud d
s
2015 1 01
sw
s
ss w
r us d
ur d
sr
r
ss s
s r s r
r
r
d
s
d
sr
r
s
s ru
s d
sr
r
w
dd
d
sr
r r u
w
d
sr
r
ss
u ur
s
ru

r
ds
r u r
d
r
ss w r s
d ws su s s
s r
d s
kernel32.dll
d user32.dll
sN
s dd
N
C:\Windows\Temp:1
us
w
s
r
r ws rs
s r d ru
u
r
u s SetupExecute
d BootExecute
r

w
r
sr

w wr

s sN

s
z d
r

u

s

s
s
s
E 201
113 d
s
w us
urr
us r

r
d

E

ntdll.dll I

r

r
r
N

explorer.exe

sr

HKLM\SYSTEM\CurrentControlSet\Control\Session Manager\\

sur
ss

dr
s

s s

su
ss
N
sr
r s
r dr
r
s dr

s
s

ru

w
d

r

N
dur
s s
d

s

w
r

s

r
u

r
r

r
r
rus s r
ds u d r

r

r

N
ur

w

ru

s

rus s w r
w sd
us

s

d

w
u
r r
s r

ud d

s ru ur
rs
rs
d
rs
r

s

s
s r
ss

r

r

sd

N

rr
ss

r

s

ss

d dr

s

r

ru s
u

d

r

s

N

s

d
s

dr

rdpinst.exe

r
r
w

r
r ur

rs
u
ddr ss

r

u

d
s
r
s s ru ur

rs
ss d s

s

s
r
d us
ss ds
d
u
r
d

dr

r
ss

rs

s
d
s s
r
us s
N
rus s w r s
ru
s rs
ru
r

d
s u

N
r

ru
r

r wr
r

ss

r
s
r

sr

r

s

s
r

r

s
u

6

r

s

s

s

r
r

dr
r
ss s
r du
s

us

r
d

s s ru ur
ss
r
rs
r

r
r

r

u
dr
s

r

s
d

sr
sr

d d
E 201

rs

r

s
u

r r s
s ur

E

d

r
r s
sr

r

s
r

r ss d
113

r
d

d

ss

d

d ws N

r

I

u s s d
s

Id
d

r

sz
r d

z d

ddr ss

dr

s

d

s r
r

ur

r

u
s
ss w w r

dN
d

d

u

I

u s

s

d

r

s

d

s

s
r

u
N

r

r

r dr rs r
ru
r
d
w r
ss
d ud
r r w

ur

r
r
r

w r
rus s w r

\Registry\Machine\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce

r

I

s
ss

r

u

d r
dw

s
rs r us
rs r
d d

d s

d u
N
su s s
us d
rr r
ss

w s

E

r
r

r

r

u
I

Native

s
d

r

s

I
E

WindowsGUI

w

d

s

d r

w

rd

H
sw

d r

d Subsystem
r ru
r

u
d r
u

s r

us

u

s

r

1
s

2
s

s

s
d

ddr ss

d
s

d

s

d
ssw rd d r
s

s

s

r

sd r

sd
s ur

u

d
s
r

d
s

u
s ur

su r u
rd

u

s

r

s

sr

u r
dr

s r s s r
u 1 56 1 26

r
r
sd r

s

r

r s r u

r d

d

s
d

r

s
u d

r
r

d us

w
d N

r

r
s ru

u

rs

s

r

N

r
u

r

rr
s

r

s
r

sd
ss

sd
d
s

r
rr

d

r

dr

r

r

6
r ss d
d

d

r

r ss d s r

d
r

us d

d
r
d

s
E 201

r
113

r

s

s s

s
ur

d
r

s
r

N

u
r

s
w r

s

r

sr

r

u
s
w ud

rw
r u

r

sr
us d
I w r ru
r
ur
I w r
r d
w

s

s

s

d
d s

u

r

us su

rs

ws

s

s

s

d

s
u

d

u
ru
r
s

u
u

s
rs

r
r u
s

s

s

s
d

ru d r

u

s

d

r u

d

rus r du s
s

s d
r du s

r

rus

s

s

d

u w

s
s

w

r
d

r r s

s

rd r

s

r

dds
r

d

s

d

rs

r
d

u d

I
s

s s
s
s
ss r r d I s w ud
rd r
I
s ru
w ud
ru
s
d
d
ru
w ud
s w
d
r
ss r
s
s
r
r
r
d
s d
r ru
86 s ru
s ru
s r
us d
w
ur s r su
r d
u
ur s
d
s
us s
s s ru
d r
s
u d d
r s rE
s
0 80000002 0 80000003 r 0 8000000
r du
r d r
I
r ds r
s u d
s
s
s
r

s

I w

r E

0 8000000

ru

z
s s
s
I w r
d
I
ru
r

s ds
rs
w
d s ss
r
d I s ru

sr
ss w

s rs E
r
ur

d
sur
s
ur s

d

I
E

E
r

us
s d
us
d s
s
r
s ru
s
dE
w

Intel(R) Xeon(R) CPU
Common KVM processor
Common 32-bit KVM
Virtual CPU
Intel Celeron_4x0 (Conroe/Merom Class Core 2)
Westmere E56xx/L56xx/X56xx (Nehalem-C)
Intel Core 2 Duo P9xxx (Penryn Class Core 2)
Intel Core i7 9xx (Nehalem Class Core i7)
Intel Xeon E312xx (Sandy Bridge)
AMD Opteron 240 (Gen 1 Class Opteron)
AMD Opteron 22xx (Gen 2 Class Opteron)
AMD Opteron 23xx (Gen 3 Class Opteron)
AMD Opteron 62xx class CPU
Intel CPU version

s

sr

s

# kvm -cpu ?
x86
qemu64
x86
phenom
x86
core2duo
x86
kvm64
x86
qemu32
x86
kvm32
x86
coreduo
x86
486
x86
pentium
x86
pentium2
x86
pentium3
x86
athlon
x86
n270
x86
Conroe
x86
Penryn
x86
Nehalem
x86
Westmere
x86
SandyBridge
x86
IvyBridge
x86
Haswell-noTSX
x86
Haswell
x86 Broadwell-noTSX
x86
Broadwell
x86
Opteron_G1
x86
Opteron_G2
x86
Opteron_G3
x86
Opteron_G4
x86
Opteron_G5
x86
host

I
r

r
r s r

s

r

sr

s us d

d

E

QEMU Virtual CPU version 2.4.0
Intel(R) Atom(TM) CPU N270
@ 1.60GHz
Intel Celeron_4x0 (Conroe/Merom Class Core 2)
Intel Core 2 Duo P9xxx (Penryn Class Core 2)
Intel Core i7 9xx (Nehalem Class Core i7)
Westmere E56xx/L56xx/X56xx (Nehalem-C)
Intel Xeon E312xx (Sandy Bridge)
Intel Xeon E3-12xx v2 (Ivy Bridge)
Intel Core Processor (Haswell, no TSX)
Intel Core Processor (Haswell)
Intel Core Processor (Broadwell, no TSX)
Intel Core Processor (Broadwell)
AMD Opteron 240 (Gen 1 Class Opteron)
AMD Opteron 22xx (Gen 2 Class Opteron)
AMD Opteron 23xx (Gen 3 Class Opteron)
AMD Opteron 62xx class CPU
AMD Opteron 63xx class CPU
KVM processor with all supported host features (only available in KVM mode)

sr
I

I w

r

QEMU Virtual CPU version 2.4.0
AMD Phenom(tm) 9550 Quad-Core Processor
Intel(R) Core(TM)2 Duo CPU
T7700 @ 2.40GHz
Common KVM processor
QEMU Virtual CPU version 2.4.0
Common 32-bit KVM processor
Genuine Intel(R) CPU
T2600 @ 2.16GHz

ss s
ur

u

ss r d

s ru

s ru

r E

u dw

0

r

r

s

r

s rE

d

u

s

0

0000000

sw

r ur

sr

s

0000000

VMwareVMware
XenVMMXenVMM
KVMKVMKVM
prl hyperv
Microsoft Hv

r
1 9
s ru

u

I
www
s r

u d

r

u

I
I s ru
d
www u
us
325383 d

r

s r
s

u s 6

3
32 r

ur s s

w r d

r

H s
s
r

s

s

s

s I

r su

GetComputerNameW() s

u d

s

r

s

brbrb-d8fb22af1
jonathan-c561e0
avreview1-VMXP
vwinxp-maltest
avreview-VMSunbox
infected-system

us d

s sr s r
r
w r s

s r su s
s s s

su

s

r
ss

s

s

rs

d

s

d

s

s

s

s r

s

ss

s

GetModuleFileNameW()

u sr

s

s

s

s

s

s

us d

s

s

ru

d

s

u

rw s w r
r

r

C:\xxx\sample.exe
C:\sample.exe
C:\Shared\dum._vxe
C:\SniferFiles\sample.exe
C:\virus\virus.exe
C:\virus.exe
c:\sampel.exe
C:\setup.exe
C:\runme.exe
c:\VMRun\Zample.exe
c:\FILE.EXE
C:\run\temp.exe
c:\taskrun\samples\rtktst.exe.exe
c:\artifact.exe
C:\manual\sunbox.exe
C:\1.exe

r

d

malware.exe
\virus\
admin\downloads\samp1e_
sample_execution
mlwr_smpl.exe

s

r

w

r

s

r

r

'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\\xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxxxxxx'

s

r

rs
s

I sr
s r s

dr

r

us

s
s r

s

d

us s
d

s

sd r d
s
w
d d d
r
sd
d
s s
s

us

r

sw

r

d

r
s r s
us d
s d
r
ss
d

r

s ss

dw

s

u us d
rd
ru
w
s s
s
w
r dr
r
w s

s

r

s
s s s

d
rus r du s

u z
ss r

ntdll.dll s

d s

d

u

dw

us r

r
s

ntdll.dll

s

w

w
d

s

u d
z d

u

dd

d
s

w

s ss
d
r 32

ss
r 32 d
ur u
u

d

r

r

s s

r
r d

s

wr
d

ud
d sw d u

ntdll.dll

s

r

us r s

s

ntdll.dll u

s

us r s

s

ss s

dw

s r

su

d d I
r du s

u ur

ss

dw

us u

u

sds

su

r ss d

rs

s

s

r

s

ss s
ss
u

r ntdll.dll
w
d

ss
d

dr

r d

r

s s

I
s

s
w r

d

r

s

s rdr

r s r

u d

ss

r

s r

ur

us
r s

d
r

s

u s

r

dd

s
r

s

N

s
N
d r
u 32 d
d r
d
u u rd
u rd32 d
w
d
u
EH
d
ur
2
s32 d E s s

r

s

d
s

dr

kernel32!GetModuleHandle()

r

r
r
r
d I

kernel32.dll

r

u d r

r
s

ss r ds

ud

r

ru
us

dd
r su

s
d
w d

dr

s

I

d
rs

s

kernel32.dll

r

s

rus

u
d
ur s
r
kernel32.dll
s
r

ntdll!LdrGetDllHandle()

r d

u

ss

dw

s

d

C:\agent\agent.pyw
C:\sandbox\starter.exe
c:\ipf\BDCore_U.dll
C:\cwsandbox_manager
C:\cwsandbox
C:\Stuff\odbg110
C:\gfisandbox
C:\Virus Analysis
C:\iDEFENSE\SysAnalyzer
c:\gnu\bin
C:\SandCastle\tools
C:\cuckoo\dll
C:\MDS\WinDump.exe
C:\tsl\Raptorclient.exe
C:\guest_tools\start.bat
C:\tools\aswsnx\snxcmd.exe
C:\Winap\ckmon.pyw
c:\tools\decodezeus
c:\tools\aswsnx
C:\sandbox\starter.exe
C:\Kit\procexp.exe
c:\tracer\mdare32_0.sys
C:\tool\malmon
C:\Samples\102114\Completed
c:\vmremote\VmRemoteGuest.exe
d:\sandbox_svc.exe

Nu

r

w
s s

I

r
r
s

d

r s
r du
r d r
r s1 r
s

r

d
r

r us
ru

H r sw

I

s

ud

r

1

r

u

s
w
s
struct
d \_SYSTEM\_BASIC\_INFORMATION.NumberOfProcessors
d
r
r
r
ss s r
d

RtlGetNativeSystemInformation(SystemBasicInformation, ...)

SYSTEM\_BASIC\_INFORMATION s ru

s1

w ss r d r
ru
sd

r du
ds r

r

s

d

s

r

r

r

s
r ds

ud

u

I N
d

u

d

'Intel(R) Core(TM) i7'
'Intel(R) Core(TM) i5'
'Intel(R) Core(TM) i3'
'Intel(R) Core(TM)2 Duo CPU'

N
s

u r
r

s

I

r

E

IN

NtQuerySystemInformation() d

r

SYSTEM_BASIC_INFORMATION

s 32

r
s

s r

u
r

N
rd

I

u d

d

s ur RtlGetNativeSystemInformation() s
u
s ur
struct
3 00 0
s ru
E
I IN

s
I N

s
ss

dw

s

w r us d

u

z s

d d

r

s

dir_watch.dll
tracer.dll
SbieDll.dll
APIOverride.dll
NtHookEngine.dll
api_log.dll
LOG_API.DLL
LOG_API32.DLL

ntdll!LdrGetDllHandle() I

r

r

s

s r

ss

r

r
N

s

I

r

s us N

u r

s

I

r

s

ntdll!RtlGetNativeSystemInformation(SystemModuleInformation, ...) s

E
I

r

s

du
s dr

s

r d

rs r

u d

s ru
ru
ru s s
s ru
ru
s s
d
d sI
r s dr
s
s s
us s s
s s
ur r
ss
rs s

r

rs

s

s r

ss w

r

z d

d r

d

du I
r
s r ur s
s

d d

r

dr

rs

ur
ur

sr
d
d

I

rs s
rs s
d
r s

s s

w
dr rs r
I d
ds
s s
ds s s
s s
s s
ws s s
s s
s
s s
E
I
r
sd
s s
360
s
360
s s
360
6 s s
360
r s s
360
r 6 s s
360
r
s s
360
H
rs s
360
H
r6 s s
360
s s
s
w r
N r
Nd s s s
Nd s
6 s s
N r
360
360
s s
360 s
s s
u
I d
r s s
s s
dH s s
rus
r
z
u
s s s
r
w r
w 6s s
r
rd s
I d
ws
s s
r
sr s s s
ds rs s
s s
s
s
s
s s
dds s s
ds s
ds s
s rs
1s s
s s
d s s
ss s
d s s
u s s
r
s s
Nd sI s s
dw
d6 s s
dw
d32 s s
r
s
s s
s
z
u
sw
s s
sw r s s
sw dr2 s s
u

u d

H

ur

s

d

s ru

r

r

s

u s

sw
s s
swNd s
s s
sw
s s
sw s s
sw
s s
r
r
s s
rs s
s s
s s
E E
E w
s s
ww s s
s s
dr s s
ws s
s s
du
s
rs s
s s
s s s
z
u
ds s s
dsdr r s s
d s s
u
s s

r

ss

sw

u

r

ss s s
5

r

r
d

r

s sw
s s

r

s
u ru s
u ru s
du
u
r r
r
r r
d
d
rr
u
r
s r

r

u
d
d
s

r
s
s
s s
sr

z r

z r
sd

u

w s
r

u d

d
N

u
r r
r s
s r usu
ru
r
u

d

r
r
r

s

r
N

E

E

u
r

s

IN

r

I

r

I NI

s
r

du

s s s
d
ss

5
r

s

ss w

r
r
r r s
s

s

s

ss
u

u d

d

ss
d

r s

s r

d
r

ss d s r

rd d

d

rus u
s d

d

usr
w r r
r

r
s

ss
urs

QueryFullProcessImageNameW() s

u

r

HE E
EN
N
r
r du
r H
1
r
d
1
r
ss
r
H
1
r
dd w r

E

N

s

I
s

d

rus dus r
s r
w
w

Is

r

N
r
r

s
r
r

H rd

s

s
u

r
u

r

d

r

s
s

s
w r
86

s
s

ds

sI s
s
s

d

r d

s

s

u

s

s
r us d r

su

w

s
5

s

s

d
s

w dr
r s
s I
w r
s
w r
w r
s

r

s

r

ss s

r

d

w r
E
E

u s r

sr
urr
urr

s

s r

u

r d
E u I E
E u
I

r
r
s

ru

z d

rd d s

d rs

E
w r
d H
s
s
I

r d

rI

ru
u

u d

s

s H rdw r

d rs

s

s

rdw r s
sr
sr
sr

s I

r

r

sr

H
E
E

E
urr
urr

ss s

r

d I

d

s

s r
I

I
r
r

s
E u
E u

r
ss
I
I H
r
I EN0000

r

s
u

u
H

1

sr

d r

dr
sr
sr

d

sr

s

E HE

d s

w r

r

r

Is

ss

ss

r

1

s sd
d H

s

d

su

s

256
u d

s

sr
I

E

s

u
s

s

urr

r

E u

EN

E

02

\Registry\Machine\HARDWARE\DESCRIPTION\System\ s u r d

d

d

s

s

s

rs

H

1
1
1

d

s

rs

ru
I

s r

sr

s

N w r I

r

ss

r

s
s

s

d
s

r

du s ss

d

NI s
d
8139

r

w

s

us
I

r
s E

r

d

d

r

ur
NI

r

s

w r

w

r d

d I

ssu

r

w r

d

s

I

IPHLPAPI!GetAdaptersInfo()

NI

rds w
r
d u r
r d
N
d
r
ru
us N w r
d
r
H
r N w r
d
r
d r d r d d us d
u
ru d

w r
rd s N
w r
ru E
r
w r
ru E
r
ru
H s
E
s

dw

w r
w r
r s
r s

I

d

rd NI

s us r
s
s
d w
ds
ss
8139
s E
r
s us r
s
s
d w
ds
ss
s

r

us

s u
s

ss s

d
d
r

s
w
r r
r r
d
r

8
1

r

ur

ddr ss s w r su
ddr ss
II
r

ddr ss

r
N
s
d u
ddr ss
d s

00:01:02:03:04:xx 3
00:03:FF:xx:xx:xx
00:0C:29:xx:xx:xx
08:00:27:xx:xx:xx

r s
w r I
d us

r

r
u r

s

s

00:07:e9:e4:ce:4d I
00:30:18:ab:d7:f2

w
d

I

00:50:56:xx:xx:xx

r

w r

ru
I

r

s I

00:ff:f2:f8:30:xx

r s

r s
r s
ww
w s
r
r

00:1d:d8:xx:xx:xx

Iw ud
d

s

rdw r

0 r su s

s

00:15:5d:xx:xx:xx

us

ru
0 r su s

52:54:00:12:34:56
00:1c:42:xx:xx:xx

us

w r
r
r

r
r
00 0
d

9

d

E
r du

s ru s r

d 00 30 18
d d

s

d

2

I

r

ur

s

d

s

r

d w
rs w d w
ss
s
r us d
s s ds
d w
ss
E
N
IN
u ru s
w ss
0
0
0
0

d
s r
r us d
d w
s s
r
s s
r
s s
r
s s
r
w

r
s

r

d

s

u d

s

ss r

s

s
s
s
s
s
r

sr
ss

d

r
s
r
r

s www s s
r s
r s www s s
r
s
r s www s s
s
r s www s s

s
r
r

s
s

ss s

r

d r

ur

s

s

d

d w
ss
d w
I
E
IN

d w
r s r
0

0
0
0
0
0
0
0
0
0
0
0
0
0

100
r r
wr s r
d s
2
s r
r
u
E
0 95

u d r
r

6

10011 6 35016

r
s
d w
s r
sr
sr
sr
sr
3 6532531
sr
dd
s
sr
ru
u s

s
u

ssd
du
r

r

ud

r

u

d r 0
I
d r 6 53
I
sr
d r 56
r
d r 56
s r w rr
r
r
s
z r
E
us d
r 1 6 rN
86
r s @
r
us
w r I
r
r
r
r
r

r

00000

rs
r s r

s
du

ss

N

dd

E
E
E
E

r s
r s
r s
r s

d ws
d ws
d ws
d ws

urr
urr
urr
urr

rs
rs
rs
rs

s
s
s
s

E

r s

d ws

urr

rs

s

r

E

w6 32N d

d ws

urr

rs

r s

Ir s N w r r
I s
r 25
s
z r s1
13 E68 1 98 8

s

z r

9 22

ru

I

r 2

u s

s

r

s

sr

E

urr

r

E u

I

EN 80EE

E

sr

E

urr

r

E u

I

EN 80EE

E

sr

E

urr

r

E u

I

EN 5333

sr

E

urr

r

E u

I

EN 1

sr

E

urr

r

E u

I

sr

E

urr

r

E u

EE

ru

00000000

E

00

E

00000000

E

00

E

8811

00000000

E

8

E

005

0 001

8

E

ru
r
3 d
00
ru
r
s
00

EN 1

8

E

000

0 001

8

E

00

I

EN 1

8

E

006

0 061

8

E

00

sr
E
r s
d ws urr
8 9 600 5
sr
E
w6 32N d
r s
r
z r
sr
E
w6 32N d
r s
sr
E
w6 32N d
r s
25
sr
E
w6 32N d
r s
98 8
9 22
3 6532531
sr
E
w6 32N d
r s
8
55 83
8 9 600 5

rs

8

55 83

s

25

16E5

d ws

urr

rs

s

Ir s N w r

d ws
d ws

urr
urr

rs
rs

s
s

s
I s

d ws

urr

rs

s

13 E68 1

d ws

urr

rs

s

25

r

r
r

r
rs
u s

s

r rs
rd us d
s
s
r rs

s
rs

r

s

r

r

r
ss
d w

r

z r s1
r
I

16E5

r 2
ss
d w

r

r
s

s

IN

u
sd

sd
u

s
r

d

u
w

r s
r
u s

w r
d

r
d u sd
r d

s ru
u s

r

s
s s

r

s ru

s

d

r
s

s

r

u

I
IN
s ru
w
E
w r u s w u d r su
r us s
s s w
r s u s s

s
r
w r

u
r

u
u

s I

us

s

r

us

wr

ss

I ssu

N

s r

d

d

w r

s

d

d s

r

3

d

rd

s

r 3
d rs r
d rI
d rN
0 15 d
r I
0 80
r
r
0 1013

r

s
r

s
N

u
ur

r

r

r

u

s

d r

ur

s

d

s s
us
us urs r r u d

s u

z sdr

w r s

s s
us u

r

rs I

d

rds r

us

us

d
s
us
r
r

w s
s
s w

r s I
ssu s
r
w ud
su
s
w

s
s
s
r

s

d
d

s

rw

r

GetCursorPosition()

s

u w

s

ss

s

ur
w
d

us r

us r s

s

r
s

s ru
s

r

s

u
r

rs

r d

r
N
us s

us
r s wr
r
ss r

r

s
r

r
r
u d

s

d
us

r

s
s
r
d d
r
w d ws su s s
udu r d
s s
r
d w u d ru

s

r

r

s

N

u

d

d

d r
s
d rI
d rN
0 8086 I
0 10d N d
0 1002
N w
us
r s w
s
d
s
r
ss
ss
ss
d
GetCursorPosition() I
r r 15
us
s d
d
u s
u
I
r s
15
us
s
s
ur
sw
r d
d
s
sr
r
d I
s
w
s d
s u
du
s
r
r
d
du

s

s
s

s
ru
s
E

rrus

s
ss r

u d

s
r s

s
d
s
s

d

s

r
rus u d

u s us

r

us

r

I

s

uw

ds
r
s

s

r

r

r ss d
s r
d d I
32 N

u

s
rds r
sd

s

d
r

d
u

s
ru
s

s ru

s
d
r ss d us

s

0.0.0.0

d
r
s r

u
rs

d
r
wr
w d ws 2000
ru s
s

N

d
r
s s

r
r

s

r

s
r d d
s

r

rus s

w r

s r s u

I w

s
s

d

rs I

s

host us d

w

rus

N
s

d

I

sur

ru s

r

u

s

s

r

sr

s

dr

d

%SystemRoot%\rdpinst.exe

d

s

r

s 2s r

r

d

u

\Registry\Machine\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce

d
ds
u

r

r ss
rs

s

d

sr

r

r

r

d s

I

sw

r s

d

H

s

d s

dr

w

s

rs

w

s ru

d

w

u

u

ur

rH

s nullptr

r

256 66 9811 0
21
2 3 6 866 15d 0
638d5 9 2
0 28 62 0880 3 9 9 13
6
0633d8 652028 0
916
5 0218
1 598 8
2d d88d3 0 60
829 12d
3
6 3 295 6985251d 1 962 2 2 69 36 5 2
803 5 8
31 816855 d82 5 d68 3832d
I
uw r w
w d

u u

r
d s

s

r

dw ud
ss

r du s

u

r

r

r

r

2016

rs

11d dd 3 d

9

dN
d rd
d
d6

I

r

s ur

r

s

d
ss d
E 201

u

113

ss

s

d

E

s

33 d6963

s r

d

w

s

r

du

r s

s

u

r

us

d