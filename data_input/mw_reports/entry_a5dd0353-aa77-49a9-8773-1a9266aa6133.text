PANDAS AND BEARS

Incident response and security breach
investigations experience

Vice President, CrowdStrike Services
Managing Director, Mandiant
Special Agent, Air Force Office of Special Investigations

LINKEDIN: Wendi Whitmore
TWITTER: @WendiLou2
wwhitmor@us.ibm.com

PARTNER, IBM SECURITY SERVICES

Conducting security assessment, incident
response, insider threat analysis, and security
architecture.

Defended networks for the Defense
Industrial Base

LINKEDIN: Christopher Scott
TWITTER: @NetOpsGuru
chris@crowdstrike.com

DIRECTOR OF REMEDIATION

Comment Panda: Commercial, Government, Non-profit

Deep Panda: Financial, Technology, Non-profit

Energetic Bear: Oil and Gas
Companies

Foxy Panda: Technology & Communications
Anchor Panda: Government organizations, Defense &
Aerospace, Industrial Engineering, NGOs
Impersonating Panda: Financial Sector
Silent Chollima:
Government, Military,
Financial

Karma Panda: Dissident groups
Keyhole Panda: Electronics & Communications
Poisonous Panda: Energy Technology, G20,
NGOs, Dissident Groups

Magic Kitten: Dissidents

Cutting Kitten: Energy Companies

Putter Panda: Governmental & Military
Toxic Panda: Dissident Groups

Deadeye Jackal: Commercial, Financial,

Union Panda: Industrial companies

Media, Social Networking

Vixen Panda: Government
Viceroy Tiger: Government, Legal,
Financial, Media, Telecom
Singing Spider: Commercial, Financial

Union Spider: Manufacturing
Andromeda Spider: Numerous

Ghost Jackal: Commercial, Energy,
Financial
Corsair Jackal: Commercial, Technology,

Financial, Energy
Extreme Jackal: Military, Government

Track attackers and actively
hunt for them in real-time
Search for indicators of attack
Remove affected machine from
network immediately

Begin posturing for remediation
on Day 1 of IR

Collect data from one machine
at a time

Long Long Ago

Contain the adversary quickly

Not So Long Ago
Automation!
Search for indicators of compromise
Clean entire network before
beginning to remediate
Conduct forensics for months before
containment of the adversary

Today

IOAs

IOCs
MALWARE
SIGNATURES
EXPLOITS
VULNERABILITIES
IP ADDRESSES

IOCs

VS

PROCESS FLOW
ACTION VS MALWARE
LATERAL MOVEMENT

IOAs

We need a shift in detection capabilities from indicators of compromise to
Indicators of Attack

Forces attackers to change behaviors
Not all behaviors change - good intel and pattern
analysis can identify the new TTPs

Analysts need the ability to tailor intel
and extract relevance via tools and
skillsets
Understanding your adversaries helps you gain
focus and understand what intel is relevant

TTPs are now rapidly changing
Some things must still remain

What are adversaries adjusting to?
Better intelligence
Hiding from forensics
Better analysts
Better technology

How many adversaries are attacking you?

BEAR

PANDA

Successful spear-phish in
Jan 2015
Complete set of tools for lateral
movement copied to network and
executed

Attackers identified as “living off
the land” and largely using tools
readily available on the system

Forensic analysis identifies
lateral movement and malware
created BEFORE spear-phish
Toolset attributed to China; use
TTPs point to Russia; earliest
went back several years, but
activity occurred Jan 2015
recently inactive
Two attacker profiles emerge

Toolset #1:
- Sloppy coding
- Compile time and debug info intact
- Chinese character set information present
Attribution: Eloquent Panda

Toolset #2:
- Professional and sanitized code
- Use of valid digital signatures
- Attempts to frustrate reverse engineering
Attribution: Cozy Bear

Complete set of tools for lateral
movement copied to network and
executed

Attackers identified as “living off
the land” largely using tools
readily available on the system

Toolset attributed to China; use
went back several years, but
recently inactive

TTPs point to Russia; earliest
activity occurred Jan 2015

Toolset #1:
- Sloppy coding
- Compile time and debug info intact
- Chinese character set information present
Attribution: Eloquent Panda

Toolset #2:
- Professional and sanitized code
- Use of valid digital signatures
- Attempts to frustrate reverse engineering
Attribution: Cozy Bear

Multiple Adversaries?
Multiple Locations – Franchise Expansion
Different POS Software and Vendors
Different Support Vendors
Different Concerns on Security

Hunting and Responding
Understand the Environment
Do You Have Access to the Endpoint?
This is not a technical question ;-)
Do You Have Tools to Respond?
This is a technical question

Multiple Adversaries?
Plans to purchase
What adversaries would be interested?
Understand the negotiation plans

Hunting and Responding
Do you have access in multiple environments?
Law firm?
Other company?
Targeted hunting on people key to the M & A
…and their assistants

• Why would you care?
– Understand who is targeting your intellectual property
– Plan to spend your security budget better
– Employ more effective containment and mitigation strategies
• What areas of the kill chain is the adversary targeting?
• Where is the weakness?

• What would better help you identify?
– Context of the incident
• M & A, Franchises, Development Plans
– Malware tools used
– Sequencing of commands
– Known C2 channels

• Why?
– Intellectual property leaving the building during the attack
– What makes you unique is quickly being taken
– Containment is not “Remediation”

• How?
– Visibility, Visibility, Visibility
– Isolate in real time
– New technologies allow for this
– Look at the IOAs
• Where in the attack cycle?

• When?
– As soon as possible
– Before forensics is complete? YES. Are you crazy? No.

THE TAKEAWAYS
Not every adversary group is created
equal. Groups have differing skills,
resources, and capabilities.
Do not fit data into your expectations –
Look for anomalies in your findings
focusing on timing, behavior, and
tradecraft

The likelihood of being targeted by
multiple adversaries is high. In this
example, remediation had to include both
actors simultaneously!

• All Adversaries
– Privileged Account Control
• Think outside of the box on ways to do this
– Blacklisting known IOCs?
• What is the effort vs the reward?
– Service Accounts
• Can you reset them?
• Who has the source code?
• How long to fix it?

• Where is the adversary in the kill chain?
• The earlier in the kill chain, the more options at your disposal.
– Visibility, Visibility, Visibilty
– If you can find them at: exploitation, installation, command and control
• You can stop them quickly
– If you understand the pattern of the attack you have additional options
• Anticipate the next move
• Use the intel you collected

26