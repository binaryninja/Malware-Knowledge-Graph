1/6/2020

First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog

Trend Micro
About TrendLabs Security Intelligence Blog

Search:

Go to…
Home
Categories
Home » Exploits » First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to
SideWinder APT Group

First Active Attack Exploiting CVE-2019-2215
Found on Google Play, Linked to SideWinder APT
Group
Posted on:January 6, 2020 at 5:00 am
Posted in:Exploits, Mobile
Author:
Trend Micro
0

by Ecular Xu and Joseph C Chen

Will you take a few moments to answer a few ques‐
tions surrounding your blog preferences?

We found three malicious apps in the Google Play Store that work together to compromise a victim’s device
and collect user information. One of these apps, called Camero, exploits CVE-2019-2215, a vulnerability that
exists in Binder (the main Inter-Process Communication system in Android). This is the ﬁrst known active
attack in the wild that uses the use-after-free vulnerability. Interestingly, upon further investigation we also
found that the three apps are likely to be part of the SideWinder threat actor group’s arsenal. SideWinder, a

START

https://blog.trendmicro.com/trendlabs-security-intelligence/ﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/

1/12

1/6/2020

First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog

group that has been active since 2012, is a known threat and has reportedly targeted military entities’
Windows machines.
The three malicious apps were disguised as photography and ﬁle manager tools. We speculate that these apps
have been active since March 2019 based on the certiﬁcate information on one of the apps. The apps have
since been removed from Google Play.

Figure 1. The three apps related to SideWinder group

Figure 2. Certiﬁcate information of one of the apps
Installation
SideWinder installs the payload app in two stages. It ﬁrst downloads a DEX ﬁle (an Android ﬁle format) from
its command and control (C&C) server. We found that
Apps to
Conversion
Tracking
Willthe
yougroup
take aemploys
few moments
answer a few
ques‐ to
conﬁgure the C&C server address. The address wastions
encoded
by
Base64
then
set
to
referrer
parameter
in the
surrounding your blog preferences?
URL used in the distribution of the malware.

START
https://blog.trendmicro.com/trendlabs-security-intelligence/ﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/

2/12

1/6/2020

First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog

Figure 3. Parsed C&C Server address
After this step, the downloaded DEX ﬁle downloads an APK ﬁle and installs it after exploiting the device or
employing accessibility. All of this is done without user awareness or intervention. To evade detection, it uses
many techniques such as obfuscation, data encryption, and invoking dynamic code.
The apps Camero and FileCrypt Manger act as droppers. After downloading the extra DEX ﬁle from the
C&C server, the second-layer droppers invoke extra code to download, install, and launch the callCam app on
the device.

Figure 4. Two-stage payload deployment
Will you take a few moments to answer a few ques‐
tions surrounding your blog preferences?

START
https://blog.trendmicro.com/trendlabs-security-intelligence/ﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/

3/12

1/6/2020

First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog

Figure 5. Code showing how the dropper invokes extra DEX code
To deploy the payload app callCam on the device without the user’s awareness, SideWinder does the
following:
1. Device Rooting
This approach is done by the dropper app Camero and only works on Google Pixel (Pixel 2, Pixel 2 XL),
Nokia 3 (TA-1032), LG V20 (LG-H990), Oppo F9 (CPH1881), and Redmi 6A devices. The malware
retrieves a speciﬁc exploit from the C&C server depending on the DEX downloaded by the dropper.

Figure 6. Code snippet from Extra DEX downloaded by Camero
We were able to download ﬁve exploits from the C&C server during our investigation. They use the
vulnerabilities CVE-2019-2215 and MediaTek-SU to get root privilege.

Figure 7. CVE-2019-2215 exploit
Will you take a few moments to answer a few ques‐
tions surrounding your blog preferences?

START
https://blog.trendmicro.com/trendlabs-security-intelligence/ﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/

4/12

1/6/2020

First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog

Figure 8. MediaTek-SU exploit
After acquiring root privilege, the malware installs the app callCam, enables its accessibility permission, and
then launches it.

Figure 9. Commands install app, launch app, and enable accessibility
2. Using the Accessibility Permission
This approach is used by the dropper app FileCrypt Manager and works on most typical Android phones
above Android 1.6. After its launch, the app asks the user to enable accessibility.

Will you take a few moments to answer a few ques‐
tions surrounding your blog preferences?

START
https://blog.trendmicro.com/trendlabs-security-intelligence/ﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/

5/12

1/6/2020

First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog

Figure 10. Steps FileCrypt Manager prompts user to do
Once granted, the app shows a full screen window that says that it requires further setup steps. In reality, that
is just an overlay screen that is displayed on top of all activity windows on the device. The overlay window
sets its attributions to FLAG_NOT_FOCUSABLE and FLAG_NOT_TOUCHABLE, allowing the activity
windows to detect and receive the users’ touch events through the overlay screen.

Will you take a few moments to answer a few ques‐
tions surrounding your blog preferences?

START
https://blog.trendmicro.com/trendlabs-security-intelligence/ﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/

6/12

1/6/2020

First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog

Figure 11. Overlay screen
Meanwhile, the app invokes code from the extra DEX ﬁle to enable the installation of unknown apps and the
installation of the payload app callCam. It also enables the payload app’s accessibility permission, and then
launches the payload app. All of this happens behind the overlay screen, unbeknownst to the user. And, all
these steps are performed by employing Accessibility.

Figure 12. Code enabling install of unknown apps and new APK

Figure 13. Code enable accessibility permission of the newly installed app
callCam’s Activities
The app callCam hides its icon on the device after being launched. It collects the following information and
sends it back to the C&C server in the background:
Location
Battery status
Files on device
Installed app list
Device information
Sensor information
Camera information
Screenshot
Account
Wiﬁ information

Will you take a few moments to answer a few ques‐
tions surrounding your blog preferences?

START

https://blog.trendmicro.com/trendlabs-security-intelligence/ﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/

7/12

1/6/2020

First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog

Data of WeChat, Outlook, Twitter, Yahoo Mail, Facebook, Gmail, and Chrome
The app encrypts all stolen data using RSA and AES encryption algorithms. It uses SHA256 to verify data
integrity and customize the encoding routine. When encrypting, it creates a block of data we named
headData. This block contains the ﬁrst 9 bytes of origin data, origin data length, random AES IV, the RSAencrypted AES encrypt key, and the SHA256 value of AES-encrypted origin data. Then the headData is
encoded through the customized routine. After the encoding, it is stored in the head of the ﬁnal encrypted ﬁle
followed by the data of the AES-encrypted original data.

Figure 14. Data encryption process

Will you take a few moments to answer a few ques‐
tions surrounding your blog preferences?

Figure 15. Customized encoding routine done
Relation to SideWinder

START

https://blog.trendmicro.com/trendlabs-security-intelligence/ﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/

8/12

1/6/2020

First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog

These apps may be attributed to SideWinder as the C&C servers it uses are suspected to be part of
SideWinder’s infrastructure. In addition, a URL linking to one of the apps’ Google Play pages is also found
on one of the C&C servers.

Figure 16. Google Play URL of FileManager app found in one of the C&C servers.
Trend Micro Solutions
Trend Micro solutions such as the Trend Micro™ Mobile Security for Android™ can detect these malicious
apps. End users can also beneﬁt from its multilayered security capabilities that secure the device owner’s data
and privacy and safeguard them from ransomware, fraudulent websites, and identity theft.
For organizations, the Trend Micro Mobile Security for Enterprise suite provides device, compliance, and
application management, data protection, and conﬁguration provisioning. It also protects devices from attacks
that exploit vulnerabilities, prevents unauthorized access to apps, and detects and blocks malware and
fraudulent websites. Trend Micro’s Mobile App Reputation Service (MARS) covers Android and iOS threats
using leading sandbox and machine learning technologies to protect users against malware, zero-day and
known exploits, privacy leaks, and application vulnerabilities.
Indicators of Compromise

SHA256

Package Name/File type

App Name/Detection
Name
AndroidOS_SWinderS
py.HRXA
AndroidOS_SWinderS
py.HRXA

ec4d6bf06dd3f94f4555d75c6daaf540dee15b18d62cc004
DEX
e774e996c703cb34
a60fc4e5328dc75dad238d46a2867ef7207b8c6fb73e8bd0
DEX
01b323b16f02ba00
0daefb3d05e4455b590da122255121079e83d48763509b0
ELF
AndroidOS_MtkSu.A
688e0079ab5d48886
441d98dff3919ed24af7699be658d06ae8dfd6a12e4129a3
AndroidOS_BinderEx
ELF
85754e6218bc24fa
p.A
ac82f7e4831907972465477eebafc5a488c6bb4d460575c
AndroidOS_BinderEx
ELF
d3889226c390ef8d5
p.A
ee679afb897213a3fd09be43806a7e5263563e86ad255fd5
AndroidOS_BinderEx
ELF
00562918205226b8
p.A
135cb239966835fefbb346165b140f584848c00c4b6a724
ELF
AndroidOS_MtkSu.A
ce122de7d999a3251
a265c32ed1ad47370d56cbd287066896d6a0c46c80a0d95 com.callCam.android.call
callCamm
Will you take a few moments to answer
a few ques‐
73d2bb915d198ae42
Cam2base
tions surrounding your blog preferences?

Package Name/File type
com.abdulrauf.ﬁlemanager
com.callCam.android.callCam2base

App Name/Detection
Name
FileCrypt Manager
callCamm

START

https://blog.trendmicro.com/trendlabs-security-intelligence/ﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/

9/12

1/6/2020

First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog

com.camero.android.camera2basic

Camero

C&C Servers
ms-ethics.net
deb-cn.net
ap1-acl.net
ms-db.net
aws-check.net
reawk.net
MITRE ATT&CK Matrix™

Will you take a few moments to answer a few ques‐
tions surrounding
your blog
preferences?
Learn how to protect Enterprises, Small Businesses,
and Home
Users
from ransomware:
ENTERPRISE »

SMALL BUSINESS »

HOME »

Tags: appAPTgoogle play

START
https://blog.trendmicro.com/trendlabs-security-intelligence/ﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/

10/12

1/6/2020

First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog

0 Comments

TrendLabs

 Recommend

t Tweet

1 Login


Sort by Best

f Share

Start the discussion…
LOG IN WITH

OR SIGN UP WITH DISQUS ?

Name

Be the ﬁrst to comment.

✉ Subscribe d Add Disqus to your siteAdd DisqusAdd

🔒 Disqus' Privacy PolicyPrivacy PolicyPrivacy

Featured Stories
systemd Vulnerability Leads to Denial of Service on Linux
qkG Filecoder: Self-Replicating, Document-Encrypting Ransomware
Mitigating CVE-2017-5689, an Intel Management Engine Vulnerability
A Closer Look at North Korea’s Internet
From Cybercrime to Cyberpropaganda

Security Predictions for 2019

Our security predictions for 2019 are based on our experts’ analysis of the progress of current and
emerging technologies, user behavior, and market trends, and their impact on the threat landscape. We
have categorized them according to the main areas that are likely to be affected, given the sprawling
nature of the technological and sociopolitical changes under consideration.
Read our security predictions for 2019.

Business Process Compromise
Will you take a few moments to answer a few ques‐
tions surrounding your blog preferences?

Attackers are starting to invest in long-term operations that target speciﬁc processes enterprises rely on.
They scout for vulnerable practices, susceptible systems and operational loopholes that they can
leverage or abuse. To learn more, read our Security 101: Business Process Compromise.

START

https://blog.trendmicro.com/trendlabs-security-intelligence/ﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/

11/12

1/6/2020

First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT Group - TrendLabs Security Intelligence Blog

Recent Posts
First Active Attack Exploiting CVE-2019-2215 Found on Google Play, Linked to SideWinder APT
Group
Looking into Attacks and Techniques Used Against WordPress Sites
Why Running a Privileged Container in Docker Is a Bad Idea
DDoS Attacks and IoT Exploits: New Activity from Momentum Botnet
More than a Dozen Obfuscated APT33 Botnets Used for Extreme Narrow Targeting

Popular Posts
More than a Dozen Obfuscated APT33 Botnets Used for Extreme Narrow Targeting
Banking Trojan DRIDEX Uses Macros for Infection
Microsoft November 2019 Patch Tuesday Reveals 74 Patches Before Major Windows Update
(Almost) Hollow and Innocent: Monero Miner Remains Undetected via Process Hollowing
April Patch Tuesday: Microsoft Patches Ofﬁce Vulnerability Used in Zero-Day Attacks

Stay Updated
Email Subscription

Your email here
Subscribe

Home and Home Ofﬁce
|
For Business
|
Security Intelligence
|
About Trend Micro
Asia Paciﬁc Region (APAC): Australia / New Zealand, 中国, ⽇本, 대한민국, 台灣
Latin America Region (LAR): Brasil, México
North America Region (NABU): United States, Canada
Europe, Middle East, & Africa Region (EMEA): France, Deutschland / Österreich / Schweiz, Italia,
Россия, España, United Kingdom / Ireland
Privacy Statement
Legal Policies
Copyright © 2020 Trend Micro Incorporated. All rights reserved.

Will you take a few moments to answer a few ques‐
tions surrounding your blog preferences?

START
https://blog.trendmicro.com/trendlabs-security-intelligence/ﬁrst-active-attack-exploiting-cve-2019-2215-found-on-google-play-linked-to-sidewinder-apt-group/

12/12