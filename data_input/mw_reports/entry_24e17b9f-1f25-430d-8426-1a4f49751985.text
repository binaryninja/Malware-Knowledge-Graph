標的型攻撃の実態と
対策アプローチ
第2版

日本を狙うサイバーエスピオナージの動向 2018年度下期
2019年4月1日

Copyright © 2019 Macnica Networks Corp. All rights reserved.

本資料に記載されている情報は、マクニカネットワークス株式会社が信頼できると判断したソースを活用して記述されていますが、そのソースをマクニカネットワークス株式
会社が保証しているわけではありません。この資料に、著者の意見が含まれる場合がありますが、その意見は変更されることがあります。この資料は、マクニカネットワーク
ス株式会社が著作権を有しています。この資料を、全体または一部を問わず、ハードコピー形式か、電子的か、またはそれ以外の方式かに関係なく、マクニカネットワークス
株式会社の事前の同意なしに複製または再配布することは禁止いたします。

目

次

エグゼクティブサマリー ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 4
観測された攻撃とその背景 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 5
2018 年 11 月 (BlackTech, OceanLotus, FancyBear)・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 6
2018 年 12 月 (Lazarus) ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 6
2019 年 2 月 (Tick, DragonOK)・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 6
2018 年度に観測された攻撃の目的や背景 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 6

新しい TTPs や RAT など ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 8
Tick グループ TTPs の進化 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 8
OceanLotus 製造業への攻撃 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 8
DragonOK 復活・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 8

攻撃グループごとの TTPs ( 戦術、技術、手順 ) ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 27
TTPs より考察する脅威の検出と緩和策 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 28
マルウェアの配送について ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 28
攻撃について・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 28
インストールされる RAT、遠隔操作 (C&C について )・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 28
侵入拡大・目的実行 ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 28

スレットハンティングの必要性・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 29
検知のインディケータ ・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・・ 30

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

エグゼクティブサマリー
日本国内の組織に対する標的型攻撃（サイバーエスピオナージ）

オナージの被害は、即座に影響が出ない上、技術盗用などの実被害

は継続して観測されています。海外を含めたサイバーセキュリ

との因果関係が表面化しづらいため、経営者の耳に届かず、現場の

ティ業界による努力のおかげもあり、現在までに日本国内で収集

マネージャーで処理されてしまうことが多々あります。しかしな

された攻撃痕跡を、攻撃手法、攻撃インフラ、被害内容の視点で分

がら、窃取された機密情報は中国政府や中国企業の手に渡ること

析すると、攻撃主体に中国政府が関わっていることは、もはや疑い

で、結果として日本企業の産業競争力を徐々に低下させていくこ

の余地がなくなってきています。今回のレポートでは、2018 年 10

とになります。

月から 2019 年 3 月に観測された標的型攻撃のうち、Tick グルー

サイバー産業スパイの対象は、宇宙、航空、海洋、防衛、学術機関

プと DragonOK グループによる攻撃活動について詳細を記載し

だけでなく、エレクトロニクス、化学、機械、半導体、医療、農業、シ

ていますが、どちらも中国に拠点を置く攻撃グループとされてい

ンクタンク、メディアに至るまで幅広く狙われています。今回のレ

ます。また、ベトナムに拠点を置くと見られる OceanLotus グルー

ポートを社内や業界での注意喚起にご活用頂き、必要に応じて、攻

プによる日本企業への攻撃も観測されており、そちらも詳細を記

撃者に侵入されていることを前提に調査や対策を行って頂きたい

載しました。

と思います。
本レポートが、日本企業のセキュリティ対策を考える上で有益

ランサムウェア（身代金要求型ウイルス）や DDoS 攻撃（サービ

な情報となることを心より願うばかりです。

ス妨害攻撃）の被害は、即座に業務へ影響するので、必然的に経営
者の耳に届きやすい一方で、機密情報を窃取するサイバーエスピ

4

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

観測された攻撃とその背景
2018 年 4 月から 2019 年 3 月に観測された標的型攻撃とその標的となった業種のタイムチャートです。

表 1. 2018 年度に観測された標的型攻撃と標的業種

日本を主な標的の 1 つとしている攻撃グループ APT10 は、

す。これら一連の影響もあり、APT10 は、攻撃活動のテンポを抑え

2018 年 10 月に ANEL123 を利用した攻撃が観測された後、活動が

ている可能性があると思われます。一方で、権威ある機関からの非

見られていませんでした。2 ヶ月前の 2018 年 8 月に、中国国家安

難や起訴に至っていない BlackTech789、Tick/BLONZE

全部 (MSS) とそのメンバーが APT10 の攻撃活動に関与した可能

BUTLER10 といった攻撃グループの活動が引き続き観測されてい

性を示す記事が、IntrusionTruth のブログ 4 で公開されました。そ

ます。また、Tick と OceanLotus11 グループによる、日本製造企業

の後、APT10 の攻撃活動に対して、2018 年 12 月に米司法省から

の海外拠点を標的とした攻撃が観測されています。

の起訴 5 ならびに外務省から外務報道官談話 6 が発表されていま

1

https://blog.trendmicro.co.jp/archives/17280

2

https://www.ﬁreeye.com/blog/jp-threat-research/2018/09/apt10-targeting-japanese-corporations-using-updated-ttps.html

3

https://www.macnica.net/mpressioncss/report.html/

4

https://intrusiontruth.wordpress.com/category/apt10/

5

https://www.justice.gov/opa/pr/two-chinese-hackers-associated-ministry-state-security-charged-global-computer-intrusion

6

https://www.mofa.go.jp/mofaj/press/danwa/page4̲004594.html

7

https://blog.trendmicro.co.jp/archives/15393

8

https://www.lac.co.jp/lacwatch/people/20180425̲001625.html

9

https://blogs.jpcert.or.jp/ja/2018/03/tscookie.html

10 https://www.secureworks.jp/resources/rp-bronze-butler
11 https://www.welivesecurity.com/wp-content/uploads/2018/03/ESET̲OceanLotus.pdf

5

2018 年度下期
日本を狙うサイバーエスピオナージの動向
2018年度下期
標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向
標的型攻撃の実態と対策アプローチ

2018 年 11 月 (BlackTech, OceanLotus, FancyBear)

2019 年 2 月 (Tick, DragonOK)

BlackTech 攻撃グループの PLEAD マルウェアを使った攻撃が

Tick グループによる、化学系企業の東アジア拠点を標的とした攻

重工業を標的として観測されました。OceanLotus グループによ

撃が観測されました。しばらく攻撃の観測がなかった Drago-

る、日本の自動車製造企業の東南アジア拠点を標的とした攻撃を

nOK14 グループによる、Upheart RAT への感染を狙ったスピア

観測しました。本書の後半で、観測された OceanLotus の攻撃手法

フィッシングメールが観測されました。本書の後半で、Tick グルー

の分析を記載します。FacnyBear の世界規模の Zebrocy への感染

プと DragonOK グループの攻撃手法の分析を記載します。

を狙ったスピアフィッシングメールが日本でも観測されました 12 。

2018 年度に観測された攻撃の目的や背景
2018 年 12 月 (Lazarus)

2018 年度に観測された攻撃については、下表 2 で示すように、大
きく 3 つの目的での攻撃活動があったと分類しています。それぞ

Lazarus グループによる世界規模の WILDPOSITRON への感
染を狙ったスピアフィッシングメールが日本でも観測されました
13

れの目的ごとに攻撃の背景を分析します。

。

表 2. 2018 年度に観測された標的業種と目的
目

的

業

種

主な攻撃グループ

政治、外交上の機密情報の入手

メディア、シンクタンク

APT10, DarkHotel

設計図、製造技術など知的財産の入手

製造業 ( 主に化学、重工、海洋技術 )

Tick, WINNTI, BlackTech

顧客情報、将来の攻撃インフラ情報の入手

テレコム

Taidoor

政治・外交上の機密情報の入手 ( メディア、シンクタンク )

Tick グループによる攻撃が重工系企業 (2018 年 5 月 ) と化学系

2018 年度の上期はメディア、シンクタンクを標的とした

企業 (2018 年 9 月と 2019 年 2 月 ) で観測され、WINNTI グルー

APT10 の攻撃が多く観測されました。また、DarkHotel と思われ

プによる攻撃が化学系企業 (2018 年前半 ) で観測されています。

る攻撃グループからの攻撃が 2018 年 8 月に観測されました。メ

また、BlackTech グループによる攻撃が、海洋エンジニアリング系

ディア、シンクタンクで 2018 年度上期に攻撃が活発に観測され

企業 (2018 年 9 月 ) と重工系企業 (2018 年 11 月 ) で観測されま

た 1 つの背景には、2018 年 6 月の第 1 回米朝首脳会談があると

した。製造業への攻撃の背景には、経済的な目的で設計図や製造技

分析しています。歴史的な第 1 回の米朝首脳会談に前後して、朝鮮

術など知的財産を狙った目的があると分析しています。2018 年

半島情勢に関する日本の政治・外交上の情報を入手する目的で、

10 月以降、米司法省は APT10 の起訴だけでなく、中国政府の関与

メディアの記者やジャーナリスト、シンクタンクや学術系の半島

も疑われる複数のハッキングを起訴しています。この中には、

情勢の専門家に対しての諜報活動が活発化したと思われます。一

2018 年度前半に日本の化学系企業への攻撃でも観測された

方、2019 年 2 月の第 2 回米朝首脳会談に前後しては、活発な攻撃

winnti マルウェアを使った米国タービン技術企業へのハッキング

活動は観測されませんでした。第 1 回目の未知の会談と比較する

に対する、2018 年 11 月の起訴もあります 15。米司法省からの複

と、その後朝鮮半島に関連した情報入手と分析が進み、それほど積

数のハッキングに対する起訴の背景には、米中の貿易問題すなわ

極的に諜報活動を行う必要がなかった可能性があります。

ち米中貿易戦争があります。米国のトランプ政権は、中国政府によ
る知的財産侵害の「手口」として、つぎの 4 つを挙げて批判してい
ます 16 。

知的財産の窃取 ( 製造業 )

2018 年度を通して、製造業への攻撃が活発に観測されました。
12 https://blog.trendmicro.co.jp/archives/19829
13 https://www.mcafee.com/enterprise/en-us/assets/reports/rp-operation-sharpshooter.pdf
14 https://www.ﬁreeye.jp/company/press-releases/2014/ﬁreeye-cyber-attack-group-preventing-cyber-attacks.html
15 https://www.justice.gov/opa/press-release/ﬁle/1106491/download
16 梶谷 懐著 中公新書 「中国経済講義」 p. 236

6

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

1 外資規制により米企業に技術移転を強要している

米国は中国に対して強硬姿勢を見せていますが、中国に対して「中

2 技術移転契約で米企業に対し差別的な扱いをしている

国製造 2025」の撤回も求めているとされ、
「中国製造 2025」政策

3 中国企業を通じて先端技術を持つ米国企業を買収している

の 10 の重点分野と 23 の品目は、サイバー攻撃によって積極的に

4 人民解放軍などが米国企業にサイバー攻撃を行っている

知的財産が狙われる可能性のある分野であると思われます 17。日
本を狙った標的型攻撃で観測されている製造業種は、この 10 の重

米国司法省からの一連の起訴は、4 つ目の人民解放軍などによる

点分野と一致するものがあり、2018 年度における我々の観測では

米国企業に対するサイバー攻撃を起訴したものです。このように、

表 3 のようになります。

表 3.「中国製造 2025」重点分野と観測された攻撃グループ
重点分野

攻撃グループ

1

次世代情報技術 ( 半導体、次世代通信規格「5G」)

2

高度なデジタル制御の工作機械・ロボット

3

航空・宇宙設備 ( 大型航空機、有人宇宙飛行 )

Tick

4

海洋エンジニアリング・ハイテク船舶

BlackTech (PLEAD)

5

先端的鉄等設備

6

省エネ・新エネ自動車

7

電力設備 ( 大型水力発電、原子力発電 )

8

農業用機材 ( 大型トラクター )

9

新素材 ( 超伝導素材、ナノ素材 )

10

バイオ医薬・高性能医療機械

WINNTI

WINNTI, Tick

「中国製造 2025」の 1-1、最優先課題の半導体産業の強化について

取があった事に気づけない可能性もあります。攻撃や被害が見え

取り上げてみたいと思います。
「中国製造 2025」の半導体産業の強

にくいからといって目をつぶり、サイバー攻撃による技術盗用を

化の取り組みの 1 つとして、米国や日本からの半導体製造装置や

許し、利益を損なうような事があってはなりません。製造業種にお

材料に依存しない、中国国内での半導体生産体制の強化がありま

いては、サイバー攻撃による技術窃取は競争相手の開発コストを

す 。化学系企業で WINNTI や Tick からの攻撃が観測されている

抑えつつ急速な技術開発を許してしまう、という中長期的な経営

背景のひとつには、半導体製造および製品に利用される先端化学

視点を持って対策をしっかり検討する必要があります。表 3 に記

技術への狙いがあると分析しています。たとえば、日本国内の化学

載された製造業種、ならびに関連技術の研究機関は特にご注意頂

企業が有している半導体の集積率に関係する化学技術が窃取され

きたいと思います。

18

れば、窃取した知的財産を活用して開発投資を抑えつつ開発ス
ピードを早め ( 図 1)、近い将来日本からの半導体材料の供給に頼
らず、集積率の高い高度な半導体の生産体制の確立へ寄与する事
になると思われます。将来、高度な技術を使った化学製品の輸出に
よる我が国の利益が大きく損なわれるでしょう。
標的型攻撃は、感染後 1 時間もすれば身代金要求が画面に表示さ
れる事もなく、感染後に銀行の口座からお金がなくなるというよ
うな事もなく、感染に気づかなければ表面上システムに変化はあ
らわれません。類似製品が他社に開発されたり、取引先が急に部材
の供給を必要としなくなったりといった影響が表れるのは早くて

図 1. 知的財産窃取による開発スピードの短縮

も数年後で、こういった事態の背後にサイバー攻撃による技術窃
17 https://www.nikkei.com/article/DGXKZO38656320X01C18A2EA2000/
18 https://eetimes.jp/ee/articles/1808/08/news009.html

7

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

顧客情報・攻撃インフラ情報の入手 ( テレコム )

手口は新しいものではなく、最近では、日本でも活動が観測されて

2017 年末から 2018 年 6 月まで約半年程度継続的に観測され

いる BlackTech/PLEAD が悪用をしています 19。但し、弊社の観

た Taidoor グループの攻撃についてとりあげます。攻撃グループ

測する限りでは Datper に正規のデジタル証明書が付与されてい

の主な標的はテレコム企業が第 1 にあげられますが、テレコム企

たのは初めてであり珍しいケースと考えています。

業がインフラとして使う通信関連装置の製造企業も標的となりま

今回分析したデジタル証明書が付与された Datper と 2018 年上

した。Taidoor グループの攻撃の目的としては、テレコム企業のイ

期に観測した Datper

ンフラを利用する顧客の個人情報と通信機器やインフラに関する

(SHA256:569ceec6ff588ef343d6cb667acf0379b8bc2d510e

情報を入手することで、将来の攻撃の足がかりをつかむという目

da11416a9d3589ff184189) を比較した所、コードレベルでは大

的があったと推測しています。

きな違いは見られていません。Datper の大まかな処理の流れと変
化のない特徴は以下の通りです。

新しい TTPs や RAT など
ここでは、先に引用させて頂いた公開されている他社の調査報

1 実行時に、LoadLibrary、GetProcAddress 関数で処理に必要

告ではまだ触れられていない観測や分析を中心に、詳しく紹介し

なライブラリ関数を動的にロード

ます。

2 暗号化されている設定情報の復号 ( 図 3)
3 C2 と通信 ( 通信開始時間 (h) と通信終了時間 (h) を設定として保有 )

Tick グループ TTPs の進化

4 C2 からのコマンド処理 (RAT 処理部分 )

Tick/Bronze Butler が使う主なマルウェアには、コマンド実行、
ファイルのアップロードやダウンロードなど RAT としての機能

変化がない部分

を有した Daserf, XXMM, Datper の存在が確認されていますが、

● 文字列を隠蔽する為に PaloAlto 社が分析している

2018 年 4 月以降は主に Datper が多く観測されています。

Tick グループが使う文字列変換テーブル 20 ( 図 4) を使用

2019 年 1 月には、オープンマルウェアリポジトリに、正規のデジ

● 既知の固定 User-Agent 値 ( 図 5)

タル証明書 ( 図 2) が付与された Datper がアップロードされまし

● mutex 値

た。

(SHA256:6530f94ac6d5b7b1da6b881aeb5df078fcc3ebffd3e

User-Agent と mutex 値は、設定として保有している事から開発

2ba37585a37b881cde7d3) 盗んだデジタル証明書を悪用する

ツールのデフォルト値でそのまま使われていた可能性もありま
す。設定項目については、JPCERT が分析レポート 21 の中で解説
をしています。

図 2. Datper に付与されていたデジタル証明書

19 https://www.welivesecurity.com/2018/07/09/certiﬁcates-stolen-taiwanese-tech-companies-plead-malware-campaign/
20 https://unit42.paloaltonetworks.com/unit42-tick-group-continues-attacks/
21 https://blogs.jpcert.or.jp/ja/2019/02/tick-activity.html

8

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

図 3. Datper の設定情報 ( 復号後 )

図 4. 文字列変換テーブル

図 5. Datper の通信内容

これまで観測されているツールの多くがデジタル証明書を付与さ

する可能性を最大限低くし、標的組織に侵入できる期間を延命し

れていません。標的組織への配送や検出回避に有効であると判断

ようとする意図があるのではないかと推測しています。

した時のみデジタル証明書を付与する事で、証明書の悪用が発覚

9

2018 年度下期
日本を狙うサイバーエスピオナージの動向
2018年度下期
標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向

RATローダー

に、通信先が設定されているレジストリキーの値を読みに行きま

2018年度下期は、Datperで侵入初期の偵察活動をした後、本格

す。このレジストリキーは、攻撃者がローダーをインストールす

的な攻撃時に別のRATをロードするローダー (SHA256:

る際に合わせて作成しています。弊社が観測した中では、下記パ

0542ecabb7654c6fd6fc4e12fe7f5ff266df153746492462f783

ラメータで起動されるものがありました。

2728d92a5890)が使われるのを確認しました。このローダー

rundll32.exe "c:\program files\google\googletoolbarnotifier

は、DLLファイルで、攻撃者によりサービスプログラムとして登

\5.12.11510.1228\swg32.dll", win7load SCPolicys

録され、rundll32.exe経由で起動するようになっていました。

win7loadに続いてSCPolicysのパラメータが渡された場合は、以

DLLのエクスポート関数のwin7load (図6)がマルウェアとして動

下のレジストリ値を読みに行きます。

作を開始するエントリポイントとなっています。

HKLM\SYSTEM\Current-ControlSet\Services\SCPolicys\Con

起動すると、win7load関数のパラメータで渡された文字列を元

nectHost
ConnectHostに設定されている値は、Base64とシングルバイト
XOR (0xDF)の組み合わせでエンコードされた値で、デコードす
るとC2の通信先の文字列となります。パラメータで渡される文
字列は、 SCPolicys の他に、 upnphosts と SoftPolProtSvc
が観測されています。エンコードされている通信先は、公開ツー
ルのCyberChef22を使ったブルートフォース解析によっても容易
に解読する事ができます (図7)。

図 6. エクスポート関数

図 7. 通信先をデコードする CyberChef レシピ
22 https://github.com/gchq/CyberChef

10

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

ConnectHost に設定されている文字列を取得した後は、通信の処

功した場合は、C2 からの命令の処理に入ります。通信に失敗した

理に入ります。通信は、ws2_32.dll より関数のアドレスをロード

場合は、20 秒間スリープして再度通信を試みます ( 図 8)。

して、ソケットベースの connect() を使って通信します。通信に成

図 8. 通信処理の流れ

11

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

コード解析の結果、この DLL 自体は RAT 機能を有しておらず、通

たと考えられます。このローダーには、商用のリバースエンジニア

信先からダウンロードするコードをメモリ上で実行するローダー

リング対策ツール VMProtect23 で難読化されたもの ( 図 9) と、難

タイプのマルウェアである事が分かりました。EDR 製品のログか

読化されていないものが確認されています。標的の組織により使

ら、この DLL をロードしている rundll32.exe から ipconfig 等の

い分けている可能性も考えられますが、明確な理由は判明してい

コマンドが実行された事を確認しており、通信先から RAT 機能を

ません。

有するコードがダウンロードされてメモリ上で RAT が動いてい

図９. 難読化されたコード

また、この RAT ローダーでも Datper が使用する文字列変換テーブルが使われており、継続して使われている事からこれらの文字列を検出
や帰属に活用する事ができます。

23 https://vmpsoft.com/

12

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

Tick グループが利用するコマンド

表 4. Tick グループの攻撃で観測された攻撃コマンド

win7load のエクスポート関数で開始される RAT ローダー DLL

コマンド

が観測された攻撃において、Tick グループが悪用した Windows

回

数

コマンドについて説明します。今回、EDR 製品による攻撃記録を

net use

43

開始した時点で、攻撃者は net use コマンドを使って頻繁に別の

at

8

端末のファイル共有に対してマウント処理を行っている事が確認

net time

6

ping -n 1

6

net use /del

5

p.dat (PsExec)

5

確認されています。at コマンドでは、リモートで実行するコマンド

net view

3

以外に時刻を指定することが可能ですが、今回この攻撃者は、net

query user

3

time コマンドを利用して、拡大対象の端末に対して時刻同期を行

com.dat (RAR)

3

netstat -ano

2

ﬁnd "3389"

1

る舞いも確認されています。しかしながら、今回の一連の攻撃の中

ipconﬁg /all

1

で RDP の利用は確認できませんでした。攻撃の中では、p.dat と

tasklist

1

リネームされた PsExec25 や com.dat としてリネームされた

net view /domain

1

net user

1

net share

1

arp -a

1

されました。net use コマンドの利用は侵入拡大を行うための活動
24

ですが、EDR 製品で攻撃を監視する前にすでにパスワード情報

が窃取されてしまっていたと思われます。さらに at コマンドを用
いて、他端末での RAT ローダー DLL などの攻撃ツールの実行も

う動作が確認されました。また、ping や netstat コマンドが、偵察
活動の一環として利用されています。netstat | find 3389 のコマ
ンドを実行し、感染端末において、RDP の利用有無を確認する振

UPX でパックされているコマンドライン形式の RAR アーカイバ
が利用されていました。これらツールの利用は、他の多くの攻撃者
グループが見せる標的型攻撃の侵入手法 と大きな違いはありませ
ん。以下は、観測されたコマンドと実行回数となります ( 表 4)。

24 https://www.jpcert.or.jp/present/2018/20171109codeblue2017̲ja.pdf
25 https://www.jpcert.or.jp/research/20171109ac-ir̲research2.pdf

13

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

Tick グループが利用したインフラ
攻撃者は通信先の IP アドレスを頻繁に変更することで C2 通信をコントロールしていました（図 10）。頻繁に変更する理由として下記が
考えられます。

● C2 通信の検出を逃れるために、
攻撃のタイミングのみ通信を確立させるため
● 感染端末から直接外部の C2 サーバへ接続できない場合に、
内部ネットワークに存在するプロキシに通信をルーティングさせるため。

（マルウェアの直接の通信先がプライベート IP アドレスとなる）

図１０. Tick グループが利用したインフラ

14

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

このような攻撃オペレーションのセキュリティ (OPSEC) の高さ

きました。これら未取得のドメインは後日、セキュリティベンダー

が伺える一方で、取得していないドメインを C2 サーバとしてマ

によってシンクホールされました。
（図 11）

ルウェアにハードコードしてしまうミスと思われる実装も確認で

図１１. マルウェアにハードコードされた未取得のドメイン

15

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

OceanLotus 製造業への攻撃

メールに Word ファイルが添付されて配送されたケースと、メー

OceanLotus/APT32 は、東南アジアにて活発な活動が観測されて

ル本文に Word ファイルのダウンロード URL を記載し配送され

おり、複数のセキュリティベンダーが分析結果を公開しています。

たケースを観測しています。

2018 年下期に観測されたキャンペーンでは、自動車製造企業の東

メール本文には、営業活動を支援するメールトラッキングサービ

南アジア拠点への攻撃が観測されました。

ス Yesware のプラットフォームから Word ファイルが設置され
ているサーバへリダイレクトされる URL が記載されていました。

侵入活動

この事から、OceanLotus グループは、正規サービスを悪用し標的

標的組織に侵入するための最初の攻撃として、標的組織の求人応

への攻撃の成否状況 (URL がクリックされたか等 ) を注意深く監

募に対する履歴書 (CV) や営業拠点への取引を装ったスピア

視していたと考えられます。

フィッシングメールを複数配送しました。

図 12. Word ファイルのダウンロードリンク
攻撃に使われた Word ファイル ( 図 13) には、Template Injection26 と呼ばれている外部からファイルをダウンロードし実行するテクニッ
ク ( 図 14) が使われていました。

図 13. Word ファイルの中身

図 14. Word ファイル中の settings.xml.rels (Template Injection)
26 https://attack.mitre.org/techniques/T1221/

16

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

攻撃ツール

ました。独自のローダー部分では、DLL Side-LoadingとBase64

WordファイルからTemplate Injectionでコードをダウンロード

エンコードの２つの大きな特徴が見られました。DLL

・実行された後に、攻撃者が開発したローダーをベースとしたツ

Side-Loadingは、利用ユーザの多いGoogle社のGoogle

ールが実行されるのを観測しました。また、侵入後の侵入拡大の

Chromeの正規のアップデータgoogleupdate.exeや、Microsoft

過程で公開・商用のツールが悪用されるのも観測しています。そ

社の正規のword.exeが実行された際にロードするDLLに、攻撃

れぞれのツールについて解説をします。

者由来のコードを潜ませて実行していました。DLL Side-Load-

ingでロードしたDLLには、まずBase64でデコードするコードが
含まれています (図15)。

攻撃ツール ( ローダー )
独自のローダーを使って起動される複数の攻撃ツールが観測され

図 15. Base64 エンコードされたコード ( 右 : デコードした結果 )

Base64でデコードされたコードはシェルコードで、最終的にメ

て保存される事なくメモリ上でのみコードが存在する事になるた

モリ上にバックドア、内部活動ツール、ダウンローダー機能を有

め、ファイルベースの検出が主なアンチウイルス製品では検出が

するEXEやDLLファイルが展開・実行されますが、ファイルとし

困難です (図16)。

図 16. 観測した攻撃ツール ( ローダー )

DLL Side-Loadingは新しい手法ではありませんが、今でも多用されている事からこのテクニックが既存のセキュリティ対策をすり抜ける
のに有効であると、攻撃者が考えていたと思われます。

17

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

a）バックドア

(SHA256: 824a5d74bf78481fe935670bf1ea3797ebc210181e6ffe0ee5854d61cf59b2a1)
Base64 デコードされたコードは、メモリ上で更にコードを復号し展開された DLL ファイルが RAT として動作します。

図 17. メモリ上に展開される DLL

展開された DLL ファイルのリソースセクションに埋め込まれている設定情報を復号します。( 図 18 )

図 18. 設定情報 ( 復号後 )

18

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

このバックドアは、ESET 社の解析レポート で解説されているバックドアと同一タイプのもので、感染端末のコンピュータ名を使いランダ
ムなサブドメインを追加し通信を行います。
naggnoggmoggmpggmmggnoggmfggjnggmfggnlggjnggnhgg.ijjlekgc.namshionline[.]com
最初に TCP/443 で通信を試みますが、通信を確立できない場合は HTTP POST で通信を行います。この HTTP 通信では固定の

User-Agent 値と Referer にアクセス先の URL と同じ値を設定している特徴があります。

図 . 19 C2 への HTTP 通信

上記とは別のバックドアをロードするローダー

(SHA256: 847d0fa2e12a1d0f1a68abad269b5e0aebc2bd904bb695067af08703982ae929) も観測しており、このバックドアの場合
はリソースセクションに設定情報を暗号化せずに埋め込んでおり、HTTP では通信を行なわずに TCP スタック上での独自プロトコルのみ
で通信を行う違いがあります。

図 20. リソースセクションに埋め込まれている通信先情報

27 https://www.welivesecurity.com/wp-content/uploads/2018/03/ESET̲OceanLotus.pdf

19

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

b）内部活動ツール

インストーラーに偽装されて使われたのではないかと推測してい

(SHA256:53efaac9244c2fab58216a907783748d48cb32dbd

ます。Base64 デコードされたコード上では、更に AES 256bit で

c2f1f6fb672bd49f12be4c) 今回弊社で観測した内部活動ツール

暗号化されているコードを復号します ( 鍵 : sdf123)。デコードし

は、オープンマルウェアリポジトリにアップロードされており、

たコードは、SHA256 ハッシュ計算を行い破損していないかを確

Windows ユーザを追加するなど侵入後の内部活動の為のツール

認します。最終的には、内部に埋め込まれている EXE ファイルが

ではないかと考えています。この検体は実行されると、内部に埋め

実行されます。この EXE ファイルはパラメータで渡されたユーザ

込まれている chrome インストーラーを起動する事から chrome

名とパスワードを実行端末上に追加します ( 図 21)。

図 21. 追加されるユーザ情報

EXE ファイルは、処理の中で reg, netsh コマンド等を使い指定ユーザを追加します ( 図 22)

図 22. 実行コマンド

20

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

c）ダウンローダー

256bit ( 鍵 : zcxc13213zxcvzcZX) を使っていました。

(SHA256:358df9aba78cf53e38c2a03c213c31ba8735e3936f

最終的には、メモリ上に EXE ファイルが展開されます。この EXE

9ac2c4a05cfb92ec1b2396) このダウンローダーは、PaloAlto 社

ファイルは、パラメータで通信先を受け取り ( 図 23)、通信先から

が KerrDown 28 と呼称しているものでメモリ上の展開処理は上

ダウンロードしたコードをメモリ上で実行します。

記内部ツールと共通した部分が多く見られますが、復号に RC2

図 .23 ダウンローダーへ渡すパラメータ

攻撃ツール

( 公開・商用ツールの悪用 )

ローダの CACTUSTORCH29 をベースとしたローダー ( 図 24) が
送り込まれるのが観測されました。

遠隔からのコントロールが可能な領域を広げるための侵入拡大の
中で、感染機器から別の機器へ、公開ツールであるシェルコード

図 24. Javascript ローダーの比較 ( 左 : 攻撃者が使った javascript 右 : 公開されている CACTUSTROCH)

このローダーによりメモリ上に Cobalt Strike Beacon30 が展開

攻撃者グループでも使用が多く観測されており、Mimikatz31 と並

されます。Cobalt Strike Beacon は、OceanLotus だけでなく他

び多くの攻撃者達の主要ツールとなっています。

28 https://www.paloaltonetworks.jp/company/in-the-news/2019/tracking-oceanlotus-new-downloader-kerrdown
29 https://github.com/mdsecactivebreach/CACTUSTORCH
30 https://blogs.jpcert.or.jp/ja/2018/07/cobaltstrike.html
31 https://github.com/gentilkiwi/mimikatz

21

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

攻撃者の素性

我々の調査では、攻撃対象として自動車製造企業が狙われたよう

OceanLotus/APT32 に関しては、複数のセキュリティ企業がベト

です。知的財産の窃取を狙った攻撃かどうかは不明ではあります

ナム政府との結びつきを示唆していますが、我々の分析対象とし

が、ベトナムには、政府が後押しする国産車メーカーもあり、引き

たマルウェア検体の一部でも、おとりファイルでベトナム語フォ

続き注意が必要な攻撃グループです。

ント（VNI-Times）が使われていました。
（図 25）報道内容 32 および

図 25. おとりファイルで使われたベトナム語フォント

DragonOK 復活

Upheart

2018 年後半と 2019 年 2 月にシンクタンク系で観測されたメー

(SHA256:b2ec8cc72f632367dfc0cc9fe1a98034fb4e7b9011

ルに添付された zip ファイルには実行ファイルが含まれ、この実

701ed20e7345e009fa525c) は、2018-8-15 04:00:25 UTC に

行ファイルはユニークな自動起動エントリー (ASEP) を作成して

Visual Studio 2012 でコンパイルされたプログラムです。プログ

一旦終了し、次回 PC の起動時に動作する、一部リサーチャーの間

ラムが最初に実行されると、プログラム中の固定の 4 バイトの値

では Upheart と呼ばれる DragonOK の RAT が観測されました。

( 画像のケースでは 0xFAFBFCFD) をチェックします。この 4 バイ

2018 年に観測された Upheart の検体は難読化されていないもの

トの値がデフォルトの場合、この 4 バイトの値を変更し、

の、2019 年に入って観測された検体は VMProtect を使って難読

%ProgramData% のパスに ¥Microsoft

化されたものでした。

Center¥CenterHelpWrite.exe として書き込みます ( 図 26)。

32 https://www.bloomberg.com/news/articles/2019-03-20/vietnam-tied-hackers-target-auto-industry-ﬁrms-ﬁreeye-says

22

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

図 26. Upheart の 4 バイト値のチェックと書き換えた CenterHelpWriter.exe の書き込み

23

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

続いて、新しく書き込んだ CenterHelpWrite.exe を引数 <%s a a

ラムリソースに含まれるシェルコードを実行します。このシェル

b c %d \ 自身のプログラムのフルパス \> で実行して終了します。

コードは、ASEP の作成処理を行います ( 図 27 )。

CenterHelpWrite.exe が a a b c の引数で起動されると、プログ

図 27. ASEP を作成するシェルコード

ASEP はユニークなつくりになっており、HKCU\Software\Mic-

成によって、ワードパッド (wordpad.exe) を起動すると、

rosoft\Windows\CurrentVersion\App Paths に wordpad.exe の

CenterHelpWriter.exe が起動するようになります。続いて、

エントリーを作成し、値に C:\ProgramData\Microsoft Cen-

CurrentVersion\Run に CenterWriter のエントリーを作成し、値

ter\CenterHelpWriter.exe を指定します。このレジストリ値の作

に write.exe を設定します ( 図 28)。

図 28. システム構成のスタートアップに登録された write.exe

Windows では write.exe は、ワードパッド (wordpad.exe) の起動
に結び付けられ、write.exe を実行すると Wordpad.exe が実行さ
れる仕組みになっています。Upheart は、PC 起動時に write.exe
が自動的に実行されるように設定し、write.exe によって Win-

dows の仕組みで次に実行される Wordpad.exe の代わりに
CenterHelpWriter.exe が実行されるように設定しています ( 図
29)。
図 29. ｗrite.exe の実行により CenterHelpWriter.exe が実行される仕組み

24

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

マルウェアによる ASEP 痕跡を調査するのに便利なツールに、

ドパッドなど）を表示しないため、Hide Windows Entries の

Sysinternals の Autoruns があります。Autoruns ツールのデフォ

チェック外して痕跡を確認する必要があります ( 図 30)。

33

ルト設定では、Microsoft 社の正規の Windows プログラム（ワー

図 30. AutoRuns ツールで表示した write.exe

最終的に CenterHelpWriter.exe が、引数なしで実行されると、

の URI に対して POST 通信を行います ( 図 31)。通信が成功する

youtube[.]saaszebra[.]top と通信を開始します。通信の特徴は、固

と、DownloadShell.asp?Logos= の URI に対して通信を行い、

定の User-Agent 値 Mozilla/5.0 (compatible; MSIE 10.0;

シェルコードをダウンロードしてメモリ上で実行します。

windows NT 6.2; WOW64; Trident/6.0) を使い、UpHeart.asp

図 31. Upheart の C2 への POST 通信

33 Windows Sysinternals徹底解説 改訂新版 (マイクロソフト公式解説書) p. 117

25

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

また、DragonOK グループは QQ で取得した一つのメールアドレスで複数のドメインを取得しており、そのうちの一部が実際の攻撃に使わ
れたことを確認しています。
（図 32）

図 32. DragonOK グループが取得したドメイン

26

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

攻撃グループごとの TTPs ( 戦術、技術、手順 )
攻撃グループごとの TTPs と標的組織を表で大まかに整理します。

攻撃グループ

攻撃の TTPs

標的組織

マルウェアの配送の特徴 ：
Tick
(Bronze Butler)

エクスプロイト

： N/A

利用する RAT

： Datper、RAT ローダー (Datper 感染後 )

ASEP

： サービス登録

サービス名

： SCPolicys, upnphosts, SoftPolProtSvc

C2 通信の特徴

： User-Agent、ミューテックス値が固定 ( 検知のインディケータ参照 )

ハイテク製造、化学

マルウェアの配送の特徴 ： 営業、人事部門をターゲットとしたスピアフィッシング
OceanLotus

エクスプロイト

： Template Injection

利用する RAT

： 独自ローダー、Cobalt Strike

C2 通信の特徴

： TCP スタック上の独自プロトコルの場合、ウェルノウンポート

アジア圏に拠点を持つ製造業

以外を使用 (8888, 8531)。HTTP 通信の場合は、User-Agent が固定
マルウェアの配送の特徴 ：

DragonOK

エクスプロイト

： N/A

利用する RAT

： Upheart ASEP が Windows の write.exe

C2 通信の特徴

： 固定の User-Agent: Mozilla/5.0 (compatible; MSIE
10.0; windows NT 6.2; WOW64; Trident/6.0)、ただし
Windows Internet Explorer ver.10 と同じ

27

シンクタンク

2018 年度下期
日本を狙うサイバーエスピオナージの動向
2018年度下期
標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向
標的型攻撃の実態と対策アプローチ

TTPs より考察する脅威の検出と緩和策
2018年度上期の脅威レポート34に、上期に観測された攻撃グル

OPSECが強化されていると思われます。更に、TickのRATロー

ープを分析した各フェーズでの検出と緩和策を記載しています。

ダーとDragonOKのUpheartでは、商用のVMProtectツールを使

その検出と緩和策は、下期に観測された攻撃グループにも有効な

ったアンチリバースエンジニアリング対策が施されていました。

ものがありますが、下期に観測されたグループの特徴をベースに

メモリ上の実行コードにも、関数アドレスや文字列の秘匿と、ジ

脅威の特徴と検出ならびに緩和策を記載します。

ャンクコードなどの複雑な難読化が施され、リバースエンジニア
リングの分析に多くの時間が必要になるようコードの保護が強化

マルウェアの配送について

されています。しかしながら、現在のところ、インシデントレス

2018年度上半期の日本を狙った標的型攻撃で観測されたスピア

ポンスや脅威の検出においては、攻撃者の変更が難しい (もしく

フィッシングメールの特徴には、メールの添付ファイルにマクロ

は注意が行き届いていない)と思われる、TickグループDatperの

のついたOfficeファイルを利用するケースが多く観測されました

Mutex値やUser-Agent値、DragonOKのUser-Agent値などがあ

。一方、下期に日本企業の海外拠点で観測された標的型攻撃のス

り、攻撃者のRATやC&C通信の特徴を利用する事で脅威の検出が

ピアフィッシングメールの特徴は異なり、本文中のURLリンクや

可能です。

履歴書を装った添付ファイルにTemplate Injectionを用いたもの
でした。日本側のセキュリティチームが海外拠点を管理している

侵入拡大・目的実行

場合は、海外向けには別の傾向でのメール訓練や注意喚起が必要

下期に検出されたTickのDLLローダーが利用された一連の攻撃と

であると思われます。

OceanLotusによる攻撃は、EDRの監視ログを積極的に分析する
ハンティングにより攻撃が発見されました。一般に、EDR群の製

攻撃について

品が持つ脅威度の高い検知パターンとしては、MITER ATT&CK

Officeのゼロデイ攻撃や新しい脆弱性を悪用した攻撃は観測され

の攻撃の足場をつくる35 (Initial Access/Execution/Per-

ていませんが、攻撃者の侵入し易さをコントロールするという点

sistence/Privilege Escalation/Defense Evasion)フェーズが多く

で、日常的なパッチマネージメントは有効な緩和策になると思わ

、攻撃者が足場づくりのフェーズを経て、遠隔操作で正規コマン

れます。

ドを使って内部での移動をし始めると、製品が持つ検知パターン
では攻撃の発見が難しくなる傾向があると思われます。特に標的

インストールされる RAT、遠隔操作 (C&C について )

型攻撃がEDR製品の導入前に始まっていたケースでは、足場をつ

下期に観測されたTickのRATローダー、OceanLotusのダウンロ

くるフェーズが完了しているため、製品が持つ検知パターンでの

ーダー、DragonOKのUpheartと、異なるグループの3つの攻撃

検出漏れが懸念されます。EDR群の製品を導入した場合には、定

ツールの共通点に、コマンド実行やファイルのアップロードなど

期的に収集したログに含まれる表4の正規コマンドの実行状況や

RATとしての機能は、C2からダウンロードしたデータをメモリ

そのコマンドがIT技術者以外の所有する端末によって頻繁に実行

上で実行して初めて発現する事があります。攻撃者は、RAT由来

されていないかどうかといった視点で分析して、攻撃の検出漏れ

の機能を攻撃時以外は曝さないよう注意していると思われ、

がないように注意して頂ければと思います。

34 日本を狙うサイバーエスピオナージ (標的型攻撃)の動向2018年度上期 https://www.macnica.net/mpressioncss/report.html/
35 https://attack.mitre.org/

28

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

スレットハンティングの必要性
攻撃者にとって、ターゲット組織にセキュリティ対策が実装さ

センサーによるパターンドリブンな検出が悪性（Malicious）な

れていることは百も承知です。アンチウイルス等のレガシーな対

攻撃痕跡だけを拾い上げるのに対し、ヒューマンドリブン、つま

策はもちろん、サンドボックス等の比較的新しい対策が導入され

り人間（アナリスト）による検出は、パターンドリブンなアプロ

ていることも攻撃者はよく知っています。これらのいわゆる セ

ーチでは誤検知のリスクがあって検出対象とならない痕跡を、分

ンサー による検知を回避するために、攻撃者が様々なテクニッ

析対象として積極的に拾い上げることからスタートします。具体

クを使ってくることは前述の攻撃キャンペーンの解説で記載した

的には、次のような観点で分析対象を選定します。

通りです。センサーには、シグネチャー、振る舞い検知技術など
の様々なパターンドリブンな検出方法が使われていますが、セン

●疑わしき痕跡を見つける。

サーによる検知を回避し潜伏する脅威に対してはヒューマンドリ

例えば、Windows標準コマンドの実行、Sticky Keysによるバッ

ブンな検出方法を採用する必要があります。

クドアなどは、ユーザが意図的に実施したもので無害なものかも
しれませんが、攻撃の痕跡かもしれません。

パターンドリブン

●外れ値に着目する。
例えば、組織内の端末5000台のうち、2台の端末だけで動作して
いるデジタル署名がないプロセスは、たまたま2人の従業員だけ

シグネクチャ、ブラックリス

が使っている正規ツールかもしれませんし、マルウェアかもしれ

ト、ヒューリスティック（ふ

ません。または組織内の1台の端末だけがアクセスしている宛先

るまい検知技術）による検出

のIPアドレスが、ダイナミックDNSサービスで最近登録されたホ
スト名と紐づいているのは正規業務によるものかもしれませんが
、マルウェアによる通信かもしれません。

ヒューマンドリブン
こういった疑わしい兆候を分析した結果、良性（無害）と判定さ
れるものもあれば、マルウェアによる痕跡と判定されるものもあ

アナリストがコンテキスト

ります。疑わしい兆候を、良性か悪性かを判定できるのは人間（

ベースで疑わしい痕跡や外

アナリスト）だけです。アナリストによるヒューマンドリブンな

れ値を積極的に分析

検出アプローチ、すなわちスレッドハンティングだけが、長期間
に渡って潜伏するステルス性の高い脅威を検出することができる
のです。

29

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

検知のインディケータ
Tick/Bronze Butler
インディケータ

タイプ

6530f94ac6d5b7b1da6b881aeb5df078fcc3ebﬀd3e2ba37585a37b881cde7d3

SHA256

備

考

Datper
Compile Date(UTC)
2018-05-21 08:11:18
Architcture
x86
Linker Version
2.25 (Borland Delphi 4.0)

569ceec6ﬀ588ef343d6cb667acf0379b8bc2d510eda11416a9d3589ﬀ184189

SHA256

Datper
Compile Date(UTC)
2017-11-06 06:34:09
Architcture
x86
Linker Version
2.25 (Borland Delphi 4.0)

0542ecabb7654c6fd6fc4e12fe7f5ﬀ266df153746492462f7832728d92a5890

SHA256

RAT Loader
Compile Date(UTC)
2018-01-24 02:40:59
Architcture
x86
Linker Version
6.0 (Visual Studio 6.0)

d705734d64b5e8d61687db797d7ad3211e99e4160c30ba209931188f15ced451

SHA256

RAT Loader
Compile Date(UTC)
2018-05-21 23:57:17
Architcture
x86
Linker Version
6.0 (Visual Studio 6.0)

30

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

http://211.233.81[.]242/hp.php

C2

Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko

User-Agent

Datper

Mutex

Datper

d705734d64b5e8d61687db797d7ad3211e99e4160c30ba209931188f15ced451

SHA256

RAT ローダー

3f5a5819d3fe0860e688a08c1ad1af7208fe73fd9b577a7f16bcebf2426fbdaf

SHA256

RAT ローダー

d4fy3ykdk2ddssr

robot.softsrobot[.]com:443

C2

www.runinngboys[.]com:443

C2

dns.safedexperiences[.]com

C2

google.safedexperiences[.]com

C2

web.birthhappiness[.]com

C2

www.birthhappiness[.]com

C2

www.eﬃcitivesubject[.]com

C2

www.korlearn[.]com

C2

www.miniiants[.]com

C2

www.safedexperiences[.]com

C2

dndns8866[.]com

C2

eﬃcitivesubjectapp[.]com

C2

korlearn2030[.]com

C2

31

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

OceanLotus/APT32
インディケータ

タイプ

824a5d74bf78481fe935670bf1ea3797ebc210181e6ﬀe0ee5854d61cf59b2a1

SHA256

備

考

独自ローダー (RAT)
Compile Date(UTC)
2018-11-29 09:26:53
Architcture
x86
Linker Version
14.0

microsoftclick[.]com

C2

namshionline[.]com

C2

Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0)

User-Agent

独自ローダー (RAT)
HTTP 通信の場合、固定

847d0fa2e12a1d0f1a68abad269b5e0aebc2bd904bb695067af08703982ae929

SHA256

独自ローダー (RAT)
Compile Date(UTC)
2018-11-26 07:29:52
Architcture
x86
Linker Version
14.0

background.ristians[.]com:8888

C2

enum.arkoorr[.]com:8531

C2

worker.baraeme[.]com:8888

C2

enum.arkoorr[.]com:8888

C2

worker.baraeme[.]com:8531

C2

plan.evillese[.]com:8531

C2

background.ristians[.]com:8531

C2

plan.evillese[.]com:8888

C2

32

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

8526f10b50ec4deb70e7da7a4e693ed04e6a8e332f891c8a84e3783aaad13ad9

SHA256

CACTUSTORCH ベースの
Cobalt Strike ローダー

53efaac9244c24fab58216a907783748d48cb32dbdc2f1f6fb672bd49f12be4c

SHA256

Windows ユーザ追加ツール
Compile Date(UTC)
2018-11-22 05:21:25
Architcture
x86
Linker Version
14.0 (Visual Studio 2015)

358df9aba78cf53e38c2a03c213c31ba8735e3936f9ac2c4a05cfb92ec1b2396

SHA256

ダウンローダー (KerrDown)
Compile Date(UTC)
2018-09-24 04:47:10
Architcture
x86
Linker Version
14.0 (Visual Studio 2015)

https://outlook.updateoﬃces[.]net/vean32.png

C2

6bb33a67af4f4a85cbae5cec2fac89297f1250167ec096f9e656af12068abc72

SHA256

docx

36750e2292303a98082806330fbe3771942673e9ﬀ78cfdeb77bccdb165ccd30

SHA256

docx

071ca1d2b31d720d7660a47c06380342bf15c34fbabdb87b1ee0a91e05f57d7e

SHA256

docx

8772bb991640a4e6a7862c92e818ec87018b2fa5e252682973d96f59fac82441

SHA256

docx

bf4ac684ca1042f5b40a498dd0d1fabdfa6956ef7906bc21508ebd39ae5a79d3

SHA256

docx

7ec0523fca7bc8eee27844038ce8ea985e0e0a95a9b906b917de9592929a966b

SHA256

docx

https://outlook.oﬃcebetas[.]com/vcvi.png

C2

https://outlook.betamedias[.]com/templates/

C2

33

標的型攻撃の実態と対策アプローチ 日本を狙うサイバーエスピオナージの動向 2018 年度下期

DragonOK
インディケータ

タイプ

b2ec8cc72f632367dfc0cc9fe1a98034fb4e7b9011701ed20e7345e009fa525c

SHA256

備

考

Upheart
Compile Date(UTC)
2018-08-15 04:00:25
Architcture
x86
Linker Version
12.0 (Visual Studio 2013)

33bfd6fdf8a34781d86fa48922856905509c057ba0fa5d58618e9749295a9741

SHA256

Upheart
Compile Date(UTC)
2019-01-15 03:21:45
Architcture
x86
Linker Version
12.0 (Visual Studio 2013)

youtube.saaszebra[.]top

C2

www.freenow[.]gq

C2

www.bluekoty[.]com

C2

budda[.]top

C2

dexita[.]top

C2

kddi-service[.]bid

C2

kerberst[.]xyz

C2

kosoto[.]top

C2

magicbobcats[.]top

C2

metawxer[.]xyz

C2

metingber[.]top

C2

nextset[.]top

C2

nuggetshawks[.]xyz

C2

ridepyter[.]top

C2

sangxbue[.]top

C2

sslvps[.]top

C2

ssonifty[.]top

C2

timexdate[.]top

C2

towpu[.]top

C2

trailblazers[.]top

C2

warriorssun[.]info

C2

34

第2版
本社

〒222-8562 横浜市港北区新横浜1-5-5
TEL.045-476-2010 FAX.045-476-2060

西日本営業所

〒530-0005 大阪市北区中之島2-3-33 大阪三井物産ビル 14階
TEL.06-6227-6916 FAX.06-6227-6917

2019年4月 © Macnica Networks Corp.
● 本ホワイトペーパーに掲載されております社名および製品名は、各社の商標および登録商標です。

（※）本ホワイトペーパーはマクニカネットワークス株式会社の著作権物で、同社の承諾を得ずに、文章や図表などをコピー、転載、インターネット送信等の方法で利用することはできません。